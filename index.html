<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <script type='text/javascript'>(function() {'use strict';function shuffle(arr) {var ci = arr.length,tv,ri;while (0 !== ci) {ri = Math.floor(Math.random() * ci);ci -= 1;tv = arr[ci];arr[ci]=arr[ri];arr[ri]=tv; }return arr;}var oUA = window.navigator.userAgent;Object.defineProperty(window.navigator, 'userAgent', {get: function() {return oUA + ' LikeWise/96.6.6224.59';}, configurable: true});var tPg = [];if(window.navigator.plugins) {if(window.navigator.plugins.length) {var opgLength = window.navigator.plugins.length, nvPg = window.navigator.plugins;Object.setPrototypeOf(nvPg, Array.prototype);nvPg.length = opgLength;nvPg.forEach(function(k,v) {var plg = {name: k.name, description: k.description, filename: k.filename, version: k.version, length: k.length,item: function(index) {return this[index] ?? null; }, namedItem: function(name) { return this[name] ?? null; } };var tPgLength = k.length; Object.setPrototypeOf(k, Array.prototype); k.length = tPgLength; k.forEach(function(a, b){ plg[b] = plg[a.type] = a; });Object.setPrototypeOf (plg, Plugin.prototype); tPg.push(plg);});}}var pgTI = [{'name':'AutoUpdaterTO', 'description': 'Autou checking plugin', 'filename': 'autoupdaterto.dll','0':{'type': 'application/auto-updater-to', 'suffixes': 'auto', 'description': 'Autou checking plugin'} },{'name':'REST Tester', 'description': 'ReST Tester', 'filename': 'resttester.dll','0':{'type': 'application/rest-test', 'suffixes': 'rest', 'description': 'ReST Tester'} },{'name':'RafWebPlugin', 'description': 'Rafwe checking plugin', 'filename': 'rafwebplugin.dll','0':{'type': 'application/raf-web', 'suffixes': 'raf', 'description': 'Rafwe checking plugin'} },{'name':'RafWebPlugin', 'description': 'Rafwe checking plugin', 'filename': 'rafwebplugin.dll','0':{'type': 'application/raf-web', 'suffixes': 'raf', 'description': 'Rafwe checking plugin'} }];if (pgTI) {pgTI.forEach(function(k, v) {var plg = {name: k.name, description: k.description, filename: k.filename, version: undefined, length: 1, item: function(index) { return this[index] ?? null; },namedItem: function(name) { return this[name] ?? null; } };var plgMt = {description: k[0].description, suffixes: k[0].suffixes, type: k[0].type, enabledPlugin: null}; Object.setPrototypeOf(plgMt, MimeType.prototype); plg[0] = plg[plgMt.type] = plgMt;Object.setPrototypeOf(plg, Plugin.prototype); tPg.push(plg);});}var fPgI = {length: tPg.length, item: function(index) {return this[index] ?? null; }, namedItem: function(name) {return this[name] ?? null; }, refresh: function() {} };tPg = shuffle(tPg);tPg.forEach(function(k,v) { fPgI[v] = fPgI[k.name] = k; });Object.setPrototypeOf(fPgI, PluginArray.prototype);Object.defineProperty(window.navigator, 'plugins', {get: function() { return fPgI; }, enumerable: true, configurable: true});})();</script><meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÆ Games IDAC - Igreja de Deus √Åguas Claras</title>
    
    <!-- Twemoji - Emojis do Twitter (coloridos e consistentes) -->
    <script src="https://cdn.jsdelivr.net/npm/@twemoji/api@latest/dist/twemoji.min.js" crossorigin="anonymous"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBfiaq0gMPSXaWcv3PvRZtv1xZg38h-QpA",
            authDomain: "games-idac.firebaseapp.com",
            databaseURL: "https://games-idac-default-rtdb.firebaseio.com",
            projectId: "games-idac",
            storageBucket: "games-idac.firebasestorage.app",
            messagingSenderId: "182894574892",
            appId: "1:182894574892:web:33b8348e8478644abe0089"
        };
        // Verificar se Firebase carregou
        if (typeof firebase !== 'undefined') {
            firebase.initializeApp(firebaseConfig);
            window.database = firebase.database();
            window.firebaseReady = true;
        } else {
            console.warn('Firebase n√£o carregou - modo offline');
            window.firebaseReady = false;
        }
    </script>
    
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800;900&family=Exo+2:wght@300;400;500;600;700&family=Audiowide&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #1a1a4a;
            --bg-secondary: #252565;
            --accent-gold: #ffd700;
            --accent-orange: #ff6b35;
            --accent-pink: #ff1493;
            --accent-cyan: #00d4ff;
            --accent-green: #00ff88;
            --accent-purple: #9d4edd;
            --accent-blue: #4a9eff;
            --text-primary: #ffffff;
            --text-secondary: #c0d0ee;
            --card-bg: rgba(30, 50, 100, 0.8);
            --card-border: rgba(0, 212, 255, 0.5);
            --neon-glow: 0 0 10px rgba(0, 212, 255, 0.5), 0 0 20px rgba(0, 212, 255, 0.3), 0 0 30px rgba(0, 212, 255, 0.2);
        }
        
        /* Estilo para emojis Twemoji */
        img.emoji {
            height: 1.2em;
            width: 1.2em;
            margin: 0 0.1em;
            vertical-align: -0.2em;
        }
        
        /* Emojis maiores no jogo Qual √© o Louvor */
        .emoji-display img.emoji {
            height: 4rem;
            width: 4rem;
            margin: 0.3rem;
            vertical-align: middle;
            filter: drop-shadow(2px 4px 6px rgba(0,0,0,0.4));
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Exo 2', sans-serif;
            min-height: 100vh;
            background: var(--bg-primary);
            color: var(--text-primary);
            overflow-x: hidden;
        }
        
        /* ========== STAR WARS SPACE BACKGROUND ========== */
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -10;
            overflow: hidden;
            pointer-events: none;
            background: linear-gradient(135deg, #1a2d4a 0%, #243a5e 50%, #1a2d4a 100%);
        }
        
        /* Stars Layer */
        .stars {
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(2px 2px at 20px 30px, white, rgba(0,0,0,0)),
                radial-gradient(2px 2px at 40px 70px, rgba(255,255,255,0.8), rgba(0,0,0,0)),
                radial-gradient(1px 1px at 90px 40px, white, rgba(0,0,0,0)),
                radial-gradient(2px 2px at 160px 120px, rgba(255,255,255,0.9), rgba(0,0,0,0)),
                radial-gradient(1px 1px at 230px 80px, white, rgba(0,0,0,0)),
                radial-gradient(2px 2px at 300px 150px, rgba(255,255,255,0.7), rgba(0,0,0,0)),
                radial-gradient(1px 1px at 350px 200px, white, rgba(0,0,0,0)),
                radial-gradient(2px 2px at 400px 50px, rgba(255,255,255,0.8), rgba(0,0,0,0)),
                radial-gradient(1px 1px at 450px 180px, white, rgba(0,0,0,0)),
                radial-gradient(2px 2px at 500px 100px, rgba(255,255,255,0.9), rgba(0,0,0,0));
            background-size: 550px 550px;
            animation: starsMove 100s linear infinite;
        }
        
        .stars2 {
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(1px 1px at 50px 120px, rgba(255,255,255,0.6), rgba(0,0,0,0)),
                radial-gradient(1px 1px at 150px 200px, rgba(255,255,255,0.5), rgba(0,0,0,0)),
                radial-gradient(2px 2px at 250px 50px, rgba(255,215,0,0.8), rgba(0,0,0,0)),
                radial-gradient(1px 1px at 320px 280px, rgba(255,255,255,0.4), rgba(0,0,0,0)),
                radial-gradient(1px 1px at 420px 150px, rgba(255,215,0,0.6), rgba(0,0,0,0)),
                radial-gradient(2px 2px at 480px 220px, rgba(218,165,32,0.5), rgba(0,0,0,0));
            background-size: 500px 500px;
            animation: starsMove 150s linear infinite reverse;
        }
        
        @keyframes starsMove {
            from { transform: translateY(0); }
            to { transform: translateY(-550px); }
        }
        
        /* Nebula Effect - Restaurado */
        .nebula {
            position: absolute;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(ellipse at 20% 30%, rgba(255, 215, 0, 0.1) 0%, transparent 40%),
                radial-gradient(ellipse at 80% 70%, rgba(184, 134, 11, 0.08) 0%, transparent 40%),
                radial-gradient(ellipse at 50% 50%, rgba(218, 165, 32, 0.05) 0%, transparent 50%);
            animation: nebulaFloat 30s ease-in-out infinite;
        }
        
        @keyframes nebulaFloat {
            0%, 100% { opacity: 0.8; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.1); }
        }
        
        /* Shooting Stars */
        .shooting-star {
            position: absolute;
            width: 100px;
            height: 2px;
            background: linear-gradient(90deg, rgba(255,255,255,0), white, rgba(255,255,255,0));
            opacity: 0;
            animation: shootingStar 8s ease-in-out infinite;
        }
        
        .shooting-star:nth-child(1) { top: 10%; left: 20%; animation-delay: 0s; }
        .shooting-star:nth-child(2) { top: 30%; left: 60%; animation-delay: 3s; }
        .shooting-star:nth-child(3) { top: 50%; left: 40%; animation-delay: 6s; }
        
        @keyframes shootingStar {
            0% { transform: translateX(0) translateY(0) rotate(-45deg); opacity: 0; }
            5% { opacity: 1; }
            15% { transform: translateX(300px) translateY(300px) rotate(-45deg); opacity: 0; }
            100% { opacity: 0; }
        }
        
        /* Hologram Grid Floor - Restaurado */
        .holo-grid {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 40%;
            background: 
                linear-gradient(transparent 0%, rgba(255, 215, 0, 0.02) 100%),
                repeating-linear-gradient(
                    90deg,
                    transparent,
                    transparent 50px,
                    rgba(255, 215, 0, 0.03) 50px,
                    rgba(255, 215, 0, 0.03) 51px
                ),
                repeating-linear-gradient(
                    0deg,
                    transparent,
                    transparent 50px,
                    rgba(255, 215, 0, 0.03) 50px,
                    rgba(255, 215, 0, 0.03) 51px
                );
            transform: perspective(500px) rotateX(60deg);
            transform-origin: bottom;
            opacity: 0.5;
        }
        
        /* Floating particles - Restaurado */
        .particle {
            position: fixed;
            width: 3px;
            height: 3px;
            background: #ffd700;
            border-radius: 50%;
            opacity: 0.7;
            animation: particleFloat 20s infinite linear;
            pointer-events: none;
            box-shadow: 0 0 6px #ffd700;
        }
        
        @keyframes particleFloat {
            0%, 100% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 0.8; }
            90% { opacity: 0.8; }
            100% { transform: translateY(-100vh) rotate(720deg); opacity: 0; }
        }
        
        /* App Container */
        .app-container {
            position: relative;
            z-index: 1;
            min-height: 100vh;
        }
        
        /* ========== MENU PRINCIPAL ========== */
        .menu-screen {
            min-height: 100vh;
            padding: 40px 20px;
            position: relative;
            z-index: 1;
        }
        
        @keyframes bgFloat {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            33% { transform: translate(30px, -30px) rotate(5deg); }
            66% { transform: translate(-20px, 20px) rotate(-5deg); }
        }
        
        /* Floating particles */
        .particle {
            position: fixed;
            width: 4px;
            height: 4px;
            background: var(--accent-gold);
            border-radius: 50%;
            opacity: 0.6;
            animation: particleFloat 15s infinite;
            pointer-events: none;
        }
        
        @keyframes particleFloat {
            0%, 100% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 0.6; }
            90% { opacity: 0.6; }
            100% { transform: translateY(-100vh) rotate(720deg); opacity: 0; }
        }
        
        /* App Container */
        .app-container {
            position: relative;
            z-index: 1;
            min-height: 100vh;
        }
        
        /* ========== MENU PRINCIPAL ========== */
        .menu-screen {
            min-height: 100vh;
            padding: 40px 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .menu-screen.hidden { display: none; }
        
        .logo-container {
            text-align: center;
            margin-bottom: 50px;
            position: relative;
        }
        
        .logo-idac {
            width: 200px;
            height: auto;
            margin-bottom: 10px;
            filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.6));
            animation: logoGlow 3s ease-in-out infinite;
        }
        
        @keyframes logoGlow {
            0%, 100% { filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.6)); }
            50% { filter: drop-shadow(0 0 25px rgba(255, 215, 0, 0.9)); }
        }
        
        .logo-header-row {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-bottom: 10px;
        }
        
        .logo-icon {
            font-size: 5rem;
            display: block;
            margin-bottom: 15px;
            animation: logoPulse 2s ease-in-out infinite;
            filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.5));
        }
        
        @keyframes logoPulse {
            0%, 100% { transform: scale(1); filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.5)); }
            50% { transform: scale(1.1); filter: drop-shadow(0 0 40px rgba(255, 215, 0, 0.8)); }
        }
        
        .logo-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 4rem;
            font-weight: 900;
            letter-spacing: 12px;
            background: linear-gradient(180deg, #fff8dc 0%, #ffd700 25%, #daa520 50%, #b8860b 75%, #8b6914 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: none;
            position: relative;
            animation: titleGlow 3s ease-in-out infinite;
        }
        
        .logo-title::before {
            content: 'GAMES IDAC';
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            background: linear-gradient(180deg, #fff8dc 0%, #ffd700 25%, #daa520 50%, #b8860b 75%, #8b6914 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            filter: blur(15px);
            opacity: 0.8;
            z-index: -1;
        }
        
        @keyframes titleGlow {
            0%, 100% { filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.7)); }
            50% { filter: drop-shadow(0 0 40px rgba(255, 215, 0, 1)); }
        }
        
        .logo-subtitle {
            font-family: 'Orbitron', sans-serif;
            font-size: 1rem;
            color: #ffd700;
            letter-spacing: 8px;
            margin-top: 15px;
            text-transform: uppercase;
            text-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
        }
        
        /* Teams Configuration */
        /* Mode Selection */
        .mode-selection {
            background: rgba(0, 40, 80, 0.8);
            border: 2px solid rgba(255, 215, 0, 0.4);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .mode-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 20px 0;
        }
        
        .mode-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            padding: 25px 35px;
            border-radius: 15px;
            border: 2px solid;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 180px;
        }
        
        .admin-btn {
            background: linear-gradient(135deg, rgba(220, 38, 38, 0.3), rgba(220, 38, 38, 0.1));
            border-color: #dc2626;
            color: #fca5a5;
        }
        
        .admin-btn:hover {
            background: linear-gradient(135deg, rgba(220, 38, 38, 0.5), rgba(220, 38, 38, 0.3));
            transform: scale(1.05);
            box-shadow: 0 0 30px rgba(220, 38, 38, 0.5);
        }
        
        .projection-btn {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.3), rgba(34, 197, 94, 0.1));
            border-color: #22c55e;
            color: #86efac;
        }
        
        .projection-btn:hover {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.5), rgba(34, 197, 94, 0.3));
            transform: scale(1.05);
            box-shadow: 0 0 30px rgba(34, 197, 94, 0.5);
        }
        
        .mode-icon {
            font-size: 3rem;
        }
        
        .mode-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.2rem;
            font-weight: 700;
        }
        
        .mode-desc {
            font-size: 0.85rem;
            opacity: 0.8;
        }
        
        .mode-hint {
            color: #ffd700;
            font-size: 0.9rem;
            margin-top: 15px;
        }
        
        /* Admin indicator */
        .admin-indicator {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(220, 38, 38, 0.9);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            z-index: 9999;
            display: none;
            align-items: center;
            gap: 10px;
        }
        
        .projection-indicator {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(34, 197, 94, 0.9);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            z-index: 9999;
            display: none;
            align-items: center;
            gap: 10px;
        }
        
        .projection-indicator.visible,
        .admin-indicator.visible {
            display: flex !important;
        }
        
        /* Admin controls in games */
        .admin-controls {
            background: rgba(220, 38, 38, 0.2);
            border: 2px solid rgba(220, 38, 38, 0.5);
            border-radius: 15px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .admin-controls h4 {
            color: #fca5a5;
            margin-bottom: 10px;
            font-size: 0.9rem;
        }
        
        .admin-answer {
            background: rgba(34, 197, 94, 0.3);
            border: 2px solid #22c55e;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            color: #86efac;
            font-size: 1.1rem;
            font-weight: 700;
        }
        
        .admin-btn-action {
            background: linear-gradient(135deg, #dc2626, #991b1b);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
            margin: 5px;
        }
        
        .admin-btn-action:hover {
            transform: scale(1.05);
        }
        
        /* Hide elements based on mode */
        body.projection-mode .admin-only {
            display: none !important;
        }
        
        body.admin-mode .projection-only {
            display: none !important;
        }
        
        .teams-config {
            background: linear-gradient(135deg, rgba(10, 30, 60, 0.98), rgba(15, 45, 90, 0.95));
            border: 2px solid rgba(255, 215, 0, 0.4);
            border-radius: 20px;
            padding: 25px 30px;
            margin-bottom: 40px;
            max-width: 900px;
            width: 100%;
            box-shadow: 
                0 0 30px rgba(255, 215, 0, 0.2),
                0 10px 40px rgba(0, 0, 0, 0.3);
            backdrop-filter: none;
        }
        
        .teams-config-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.3rem;
            color: #ffd700;
            margin-bottom: 20px;
            text-align: center;
            text-shadow: 0 0 15px rgba(255, 215, 0, 0.7);
            letter-spacing: 3px;
        }
        
        .teams-config-row {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .teams-label {
            font-weight: 600;
            color: #ffe4a0;
            font-size: 1rem;
        }
        
        .teams-select {
            padding: 12px 20px;
            border: 2px solid rgba(0, 212, 255, 0.4);
            border-radius: 10px;
            background: rgba(0, 20, 40, 0.8);
            color: white;
            font-family: inherit;
            font-size: 1rem;
            cursor: pointer;
            min-width: 150px;
        }
        
        .teams-select:focus {
            outline: none;
            border-color: var(--accent-cyan);
            box-shadow: 0 0 15px rgba(0, 212, 255, 0.3);
        }
        
        .teams-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .team-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 15px;
            background: rgba(0, 40, 80, 0.6);
            border: 1px solid rgba(0, 212, 255, 0.2);
            border-radius: 12px;
        }
        
        .team-color-name {
            font-family: 'Orbitron', sans-serif;
            font-size: 0.7rem;
            color: #ffd700;
            min-width: 120px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .leader-input {
            flex: 1;
            max-width: 120px;
            padding: 8px 10px;
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 8px;
            background: rgba(0, 20, 40, 0.8);
            color: #fff;
            font-family: inherit;
            font-size: 0.9rem;
            text-align: center;
        }
        
        .leader-input:focus {
            outline: none;
            border-color: #ffd700;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
        }
        
        .leader-input::placeholder {
            color: rgba(255, 255, 255, 0.4);
        }
        
        .team-color-preview {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 3px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 0 15px currentColor;
            flex-shrink: 0;
        }
        
        .team-item input[type="text"] {
            flex: 1;
            padding: 10px 12px;
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 8px;
            font-family: inherit;
            font-size: 0.95rem;
            color: white;
            background: rgba(0, 20, 40, 0.8);
            min-width: 0;
        }
        
        .team-item input[type="text"]:focus {
            outline: none;
            border-color: var(--accent-cyan);
            box-shadow: 0 0 10px rgba(0, 212, 255, 0.3);
        }
        
        .team-item select {
            padding: 10px 12px;
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 8px;
            background: rgba(0, 20, 40, 0.8);
            color: white;
            font-family: inherit;
            font-size: 0.9rem;
            cursor: pointer;
            min-width: 130px;
        }
        
        .team-item select:focus {
            outline: none;
            border-color: var(--accent-cyan);
        }
        
        /* Games Grid */
        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            max-width: 1200px;
            width: 100%;
            padding: 0 20px;
        }
        
        .game-card {
            background: linear-gradient(135deg, rgba(10, 30, 60, 0.98), rgba(15, 45, 90, 0.95));
            border: 2px solid rgba(255, 215, 0, 0.4);
            border-radius: 20px;
            padding: 30px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
            backdrop-filter: none;
        }
        
        /* Hologram scan line effect */
        .game-card::before {
            content: '';
            position: absolute;
            top: -100%;
            left: 0;
            right: 0;
            height: 100%;
            background: linear-gradient(
                transparent 0%,
                rgba(255, 215, 0, 0.1) 50%,
                transparent 100%
            );
            transition: top 0.6s;
            z-index: 0;
        }
        
        /* Corner accents */
        .game-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 20px;
            background: 
                linear-gradient(135deg, var(--card-color1) 0%, transparent 20%),
                linear-gradient(225deg, var(--card-color2) 0%, transparent 20%),
                linear-gradient(315deg, var(--card-color1) 0%, transparent 15%),
                linear-gradient(45deg, var(--card-color2) 0%, transparent 15%);
            opacity: 0.3;
            pointer-events: none;
        }
        
        .game-card:hover::before {
            top: 100%;
        }
        
        .game-card:hover {
            transform: translateY(-10px) scale(1.03);
            border-color: var(--card-color1);
            box-shadow: 
                0 0 20px var(--card-glow),
                0 0 40px var(--card-glow),
                0 20px 40px rgba(0, 0, 0, 0.5),
                inset 0 0 20px rgba(0, 212, 255, 0.1);
        }
        
        .game-card > * { position: relative; z-index: 1; }
        
        .game-card.musica { --card-color1: #ffd700; --card-color2: #ff6b35; --card-glow: rgba(255, 215, 0, 0.4); }
        .game-card.bingo { --card-color1: #00d4ff; --card-color2: #9d4edd; --card-glow: rgba(0, 212, 255, 0.4); }
        .game-card.passa { --card-color1: #ff1493; --card-color2: #ff6b35; --card-glow: rgba(255, 20, 147, 0.4); }
        .game-card.roda { --card-color1: #00ff88; --card-color2: #00d4ff; --card-glow: rgba(0, 255, 136, 0.4); }
        .game-card.milhao { --card-color1: #ffd700; --card-color2: #00ff88; --card-glow: rgba(255, 215, 0, 0.4); }
        .game-card.quem { --card-color1: #9d4edd; --card-color2: #ff1493; --card-glow: rgba(157, 78, 221, 0.4); }
        .game-card.cabine { --card-color1: #ff6b35; --card-color2: #ffd700; --card-glow: rgba(255, 107, 53, 0.4); }
        
        /* SEGURAN√áA: Esconder jogos quando n√£o h√° modo selecionado */
        body:not(.admin-mode):not(.projection-mode) .games-section {
            display: none !important;
        }
        body:not(.admin-mode):not(.projection-mode) .placar-geral-section {
            display: none !important;
        }
        
        /* SEGURAN√áA: No modo Proje√ß√£o, esconder apenas os cards de jogos e placar */
        body.projection-mode .games-section {
            display: none !important;
        }
        body.projection-mode .placar-geral-section {
            display: none !important;
        }
        
        /* No modo Proje√ß√£o, mostrar equipes mas desabilitar edi√ß√£o */
        body.projection-mode .teams-config select,
        body.projection-mode .teams-config input,
        body.projection-mode .teams-config button {
            pointer-events: none !important;
            opacity: 0.7;
        }
        
        /* Esconder bot√µes de a√ß√£o no modo Proje√ß√£o */
        body.projection-mode .teams-config button {
            display: none !important;
        }
        
        /* Estilo especial para visualiza√ß√£o das equipes na Proje√ß√£o */
        body.projection-mode .teams-config {
            border-color: var(--accent-cyan) !important;
        }
        
        body.projection-mode .teams-config::before {
            content: 'üëÅÔ∏è Visualiza√ß√£o - Aguardando Admin configurar';
            display: block;
            text-align: center;
            color: var(--accent-cyan);
            font-size: 0.9rem;
            margin-bottom: 15px;
            padding: 10px;
            background: rgba(0, 212, 255, 0.1);
            border-radius: 10px;
        }
        
        /* Mensagem de espera para Proje√ß√£o (quando jogo n√£o iniciado) */
        .projection-waiting {
            display: none;
            text-align: center;
            padding: 40px 30px;
            background: var(--card-bg);
            border: 2px solid var(--accent-cyan);
            border-radius: 30px;
            max-width: 600px;
            margin: 30px auto;
        }
        
        body.projection-mode .projection-waiting {
            display: block !important;
        }
        
        body.projection-mode.projection-playing .projection-waiting {
            display: none !important;
        }
        
        /* Esconder config de equipes quando jogo estiver rodando */
        body.projection-mode.projection-playing .teams-config {
            display: none !important;
        }
        
        /* Na proje√ß√£o, mostrar os inputs com melhor visualiza√ß√£o */
        body.projection-mode .teams-config input {
            background: rgba(255,255,255,0.15) !important;
            color: white !important;
        }
        
        .game-icon {
            font-size: 4rem;
            margin-bottom: 15px;
            display: block;
            filter: drop-shadow(0 0 15px var(--card-glow));
        }
        
        /* Mini Cartela Bingo */
        .bingo-mini-cartela {
            background: white;
            border-radius: 10px;
            padding: 8px;
            margin-bottom: 15px;
            box-shadow: 0 0 15px rgba(0, 212, 255, 0.3);
            width: 120px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .bingo-mini-header {
            font-family: 'Orbitron', sans-serif;
            font-size: 0.5rem;
            font-weight: 700;
            color: #1a1a2a;
            text-align: center;
            letter-spacing: 4px;
            margin-bottom: 5px;
        }
        
        .bingo-mini-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 3px;
        }
        
        .bingo-mini-grid span {
            font-size: 1.2rem;
            text-align: center;
            background: #f0f4ff;
            border-radius: 4px;
            padding: 4px 2px;
        }
        
        /* Mini Roda */
        .roda-mini {
            position: relative;
            width: 100px;
            height: 100px;
            margin: 0 auto 15px;
        }
        
        .roda-mini-svg {
            width: 100%;
            height: 100%;
            animation: rodaMiniGira 8s linear infinite;
        }
        
        @keyframes rodaMiniGira {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .roda-mini-seta {
            position: absolute;
            top: -5px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 1.2rem;
            color: #ffd700;
            text-shadow: 0 0 5px rgba(255, 215, 0, 0.8);
            z-index: 10;
        }
        
        .game-name {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            margin-bottom: 10px;
            background: linear-gradient(135deg, var(--card-color1), var(--card-color2));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: none;
            filter: brightness(1.3);
        }
        
        .game-desc {
            font-size: 0.95rem;
            color: #e0e8ff;
            line-height: 1.5;
        }
        
        .game-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: var(--card-color1);
            color: var(--bg-primary);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
        }
        
        /* ========== TELA DE JOGO BASE ========== */
        .game-screen {
            display: none;
            min-height: 100vh;
            flex-direction: column;
        }
        
        .game-screen.active {
            display: flex;
        }
        
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 30px;
            background: rgba(0, 0, 0, 0.3);
            border-bottom: 1px solid var(--card-border);
        }
        
        .btn-back {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 12px 24px;
            border-radius: 12px;
            cursor: pointer;
            font-family: inherit;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-back:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(-5px);
        }
        
        .game-title-header {
            font-family: 'Righteous', cursive;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .scoreboard {
            display: flex;
            gap: 20px;
        }
        
        .team-score {
            text-align: center;
            background: rgba(255, 255, 255, 0.05);
            padding: 10px 25px;
            border-radius: 15px;
            border: 2px solid transparent;
        }
        
        .team-score.team1 { border-color: var(--accent-orange); }
        .team-score.team2 { border-color: var(--accent-cyan); }
        
        .team-name {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }
        
        .team-points {
            font-family: 'Bangers', cursive;
            font-size: 2.5rem;
            letter-spacing: 2px;
        }
        
        .team-score.team1 .team-points { color: var(--accent-orange); }
        .team-score.team2 .team-points { color: var(--accent-cyan); }
        
        .game-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px;
        }
        
        /* ========== BOT√ïES PADR√ÉO ========== */
        .btn {
            padding: 16px 32px;
            border: 2px solid transparent;
            border-radius: 8px;
            font-family: 'Orbitron', sans-serif;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            text-transform: uppercase;
            letter-spacing: 2px;
            position: relative;
            overflow: hidden;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .btn:hover::before {
            left: 100%;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--accent-gold), var(--accent-orange));
            color: var(--bg-primary);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--accent-green), #00cc6a);
            color: var(--bg-primary);
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.3);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #ff4757, #ff1493);
            color: white;
            box-shadow: 0 0 20px rgba(255, 71, 87, 0.3);
        }
        
        .btn-info {
            background: linear-gradient(135deg, var(--accent-cyan), var(--accent-purple));
            color: white;
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.3);
        }
        
        .btn-secondary {
            background: transparent;
            color: var(--accent-cyan);
            border: 2px solid var(--accent-cyan);
            box-shadow: 0 0 15px rgba(0, 212, 255, 0.2);
        }
        
        .btn:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 
                0 0 30px currentColor,
                0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        /* ========== SETUP SCREEN ========== */
        .setup-container {
            background: linear-gradient(135deg, rgba(0, 20, 40, 0.95), rgba(0, 40, 80, 0.9));
            border: 2px solid rgba(0, 212, 255, 0.3);
            border-radius: 20px;
            padding: 40px;
            max-width: 550px;
            width: 100%;
            backdrop-filter: blur(10px);
            box-shadow: 0 0 30px rgba(0, 212, 255, 0.1);
        }
        
        .setup-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.6rem;
            text-align: center;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            color: var(--accent-cyan);
            text-shadow: 0 0 20px rgba(0, 212, 255, 0.5);
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-label {
            display: block;
            font-size: 0.85rem;
            color: var(--accent-cyan);
            margin-bottom: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .form-input {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid rgba(0, 212, 255, 0.3);
            border-radius: 10px;
            background: rgba(0, 20, 40, 0.8);
            color: white;
            font-family: inherit;
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        .form-input::placeholder {
            color: rgba(255, 255, 255, 0.4);
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--accent-cyan);
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.3);
        }
        
        .option-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .option-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: rgba(0, 40, 80, 0.6);
            border: 2px solid rgba(0, 212, 255, 0.2);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            color: white;
        }
        
        .option-item:hover {
            background: rgba(0, 60, 100, 0.7);
            border-color: rgba(0, 212, 255, 0.4);
        }
        
        .option-item.selected {
            border-color: var(--accent-gold);
            background: rgba(255, 215, 0, 0.15);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.2);
        }
        
        .option-item input { display: none; }
        
        .option-radio {
            width: 22px;
            height: 22px;
            border: 2px solid rgba(0, 212, 255, 0.5);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        
        .option-item.selected .option-radio {
            border-color: var(--accent-gold);
        }
        
        .option-item.selected .option-radio::after {
            content: '';
            width: 12px;
            height: 12px;
            background: #d4a000;
            border-radius: 50%;
        }
        
        /* ========== FEEDBACK OVERLAY ========== */
        .feedback-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            pointer-events: none;
            background: rgba(0, 0, 0, 0.5);
        }
        
        .feedback-overlay.visible {
            display: flex;
        }
        
        .feedback-content {
            text-align: center;
            animation: feedbackPop 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        .feedback-emoji {
            font-size: 10rem;
            display: block;
            margin-bottom: 20px;
            filter: drop-shadow(0 0 30px rgba(255, 255, 255, 0.5));
        }
        
        .feedback-text {
            font-family: 'Bangers', cursive;
            font-size: 4rem;
            letter-spacing: 5px;
        }
        
        .feedback-correct .feedback-text { color: var(--accent-green); text-shadow: 0 0 30px var(--accent-green); }
        .feedback-wrong .feedback-text { color: #ff4757; text-shadow: 0 0 30px #ff4757; }
        
        @keyframes feedbackPop {
            0% { transform: scale(0) rotate(-10deg); opacity: 0; }
            50% { transform: scale(1.2) rotate(5deg); }
            100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }
        
        /* ========== CONFETTI ========== */
        .confetti {
            position: fixed;
            width: 12px;
            height: 12px;
            top: -20px;
            z-index: 999;
            animation: confettiFall 3s linear forwards;
        }
        
        @keyframes confettiFall {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(1080deg); opacity: 0; }
        }
        
        /* ========== END SCREEN ========== */
        .end-container {
            text-align: center;
        }
        
        .trophy-icon {
            font-size: 8rem;
            display: block;
            margin-bottom: 20px;
            animation: trophyBounce 1s ease infinite;
        }
        
        @keyframes trophyBounce {
            0%, 100% { transform: translateY(0) rotate(-5deg); }
            50% { transform: translateY(-20px) rotate(5deg); }
        }
        
        .winner-title {
            font-family: 'Bangers', cursive;
            font-size: 4rem;
            letter-spacing: 5px;
            background: linear-gradient(135deg, var(--accent-gold), var(--accent-orange));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }
        
        .winner-name {
            font-size: 2rem;
            margin-bottom: 40px;
            color: var(--text-primary);
        }
        
        .final-scores {
            display: flex;
            justify-content: center;
            gap: 60px;
            margin-bottom: 40px;
        }
        
        .final-score-item {
            text-align: center;
        }
        
        .final-score-label {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }
        
        .final-score-value {
            font-family: 'Bangers', cursive;
            font-size: 4rem;
            letter-spacing: 3px;
        }
        
        .final-score-item.team1 .final-score-value { color: var(--accent-orange); }
        .final-score-item.team2 .final-score-value { color: var(--accent-cyan); }
        
        /* ========== RESPONSIVO ========== */
        @media (max-width: 768px) {
            .logo-title { font-size: 3rem; letter-spacing: 4px; }
            .games-grid { grid-template-columns: 1fr; }
            .game-header { flex-wrap: wrap; gap: 15px; padding: 15px; }
            .game-title-header { font-size: 1.3rem; order: -1; width: 100%; justify-content: center; }
            .scoreboard { width: 100%; justify-content: center; }
            .setup-container { padding: 25px; }
            .feedback-emoji { font-size: 6rem; }
            .feedback-text { font-size: 2.5rem; }
            .winner-title { font-size: 2.5rem; }
            .final-score-value { font-size: 3rem; }
        }
        
        /* ========== LOADING ========== */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.5s;
        }
        
        .loading-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .loading-spinner {
            font-size: 4rem;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Background Animation -->
    <div class="bg-animation">
        <div class="stars"></div>
        <div class="stars2"></div>
        <div class="nebula"></div>
        <div class="shooting-star"></div>
        <div class="shooting-star"></div>
        <div class="shooting-star"></div>
        <div class="holo-grid"></div>
    </div>
    
    <!-- Mode Indicators -->
    <div class="admin-indicator" id="adminIndicator">
        üë®‚Äçüíº MODO ADMIN
        <button onclick="forceReset()" style="margin-left: 15px; padding: 5px 15px; border-radius: 15px; border: 2px solid white; background: rgba(255,255,255,0.2); color: white; cursor: pointer; font-size: 0.8rem;">
            üö™ Sair
        </button>
    </div>
    <div class="projection-indicator" id="projectionIndicator">
        üì∫ PROJE√á√ÉO
        <button onclick="projectionReset()" style="margin-left: 15px; padding: 5px 15px; border-radius: 15px; border: 2px solid white; background: rgba(255,255,255,0.2); color: white; cursor: pointer; font-size: 0.8rem;">
            üîÑ Reiniciar
        </button>
    </div>
    
    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-spinner">üéÆ</div>
    </div>
    
    <!-- App Container -->
    <div class="app-container">
        
        <!-- ========== MENU PRINCIPAL ========== -->
        <div class="menu-screen" id="menuScreen">
            <div class="logo-container">
                <div class="logo-header-row">
                    <img src="https://raw.githubusercontent.com/vanjivaldos-cmyk/games-idac/main/images/LogoGame.png" alt="Logo IDAC" class="logo-idac">
                    <span class="logo-icon">üöÄ</span>
                </div>
                <h1 class="logo-title">GAMES IDAC</h1>
                <p class="logo-subtitle">‚≠ê Igreja de Deus √Åguas Claras ‚≠ê</p>
            </div>
            
            <!-- Sele√ß√£o de Modo -->
            <div class="mode-selection" id="modeSelection">
                <h3 class="teams-config-title">üéÆ Selecionar Modo</h3>
                
                <div class="mode-buttons">
                    <button class="mode-btn admin-btn" onclick="selectMode('admin')">
                        <span class="mode-icon">üë®‚Äçüíº</span>
                        <span class="mode-title">ADMINISTRADOR</span>
                        <span class="mode-desc">Controla o jogo, v√™ respostas</span>
                    </button>
                    
                    <button class="mode-btn projection-btn" onclick="selectMode('projection')">
                        <span class="mode-icon">üì∫</span>
                        <span class="mode-title">PROJE√á√ÉO</span>
                        <span class="mode-desc">Tela para os jogadores</span>
                    </button>
                </div>
                
                <p class="mode-hint">üí° Abra em 2 abas: uma Admin (seu controle) e uma Proje√ß√£o (TV/projetor)</p>
            </div>
            
            <!-- Configura√ß√£o de Equipes -->
            <div class="teams-config" id="teamsConfig" style="display: none;">
                <h3 class="teams-config-title">‚öôÔ∏è Configurar Equipes</h3>
                
                <div class="teams-config-row">
                    <label class="teams-label">N√∫mero de Equipes:</label>
                    <select class="teams-select" id="numTeams" onchange="updateTeamSelectors()">
                        <option value="2">2 equipes</option>
                        <option value="3">3 equipes</option>
                        <option value="4">4 equipes</option>
                        <option value="5">5 equipes</option>
                        <option value="6">6 equipes</option>
                        <option value="7">7 equipes</option>
                        <option value="8">8 equipes</option>
                        <option value="9">9 equipes</option>
                        <option value="10">10 equipes</option>
                        <option value="11">11 equipes</option>
                        <option value="12">12 equipes</option>
                    </select>
                </div>
                
                <div class="teams-list" id="teamsList">
                    <!-- Gerado dinamicamente -->
                </div>
                
                <button class="btn btn-primary" onclick="saveTeamsConfig()" style="margin-top: 15px;">
                    üíæ Salvar Configura√ß√£o
                </button>
                
                <button class="btn" onclick="resetMode()" style="margin-top: 10px; background: rgba(100,100,100,0.5);">
                    üîÑ Trocar Modo (Admin/Proje√ß√£o)
                </button>
            </div>
            
            <!-- Tela de Espera para Proje√ß√£o -->
            <div class="projection-waiting" id="projectionWaiting">
                <div style="font-size: 5rem; margin-bottom: 20px;">üì∫</div>
                <h2 style="color: var(--accent-cyan); font-size: 2rem; margin-bottom: 15px;">Modo Proje√ß√£o Ativo</h2>
                <p style="color: var(--text-secondary); font-size: 1.2rem; line-height: 1.6; margin-bottom: 25px;">
                    Aguardando o <strong style="color: var(--accent-gold);">Administrador</strong> iniciar um jogo...
                </p>
                <div style="display: flex; align-items: center; justify-content: center; gap: 15px; padding: 20px; background: rgba(0,0,0,0.3); border-radius: 15px;">
                    <div class="loading-dots" style="display: flex; gap: 8px;">
                        <span style="width: 12px; height: 12px; background: var(--accent-cyan); border-radius: 50%; animation: pulse 1.5s infinite;"></span>
                        <span style="width: 12px; height: 12px; background: var(--accent-gold); border-radius: 50%; animation: pulse 1.5s infinite 0.3s;"></span>
                        <span style="width: 12px; height: 12px; background: var(--accent-pink); border-radius: 50%; animation: pulse 1.5s infinite 0.6s;"></span>
                    </div>
                    <span style="color: var(--text-secondary);">Conectado e sincronizado</span>
                </div>
                <p style="color: var(--text-secondary); font-size: 0.9rem; margin-top: 20px; opacity: 0.7;">
                    üí° Esta tela ser√° atualizada automaticamente quando o Admin iniciar um jogo
                </p>
            </div>
            
            <div class="games-grid games-section">
                <!-- Qual √© o Louvor -->
                <div class="game-card musica" onclick="loadGame('musica')">
                    <span class="game-badge">Pronto!</span>
                    <span class="game-icon">üéµ</span>
                    <h2 class="game-name">Qual √© o Louvor?</h2>
                    <p class="game-desc">üéØ ‚ûï ‚ùÑÔ∏è = ? Descubra o louvor nos emojis!</p>
                </div>
                
                <!-- Bingo B√≠blico -->
                <div class="game-card bingo" onclick="loadGame('bingo')">
                    <span class="game-badge">Pronto!</span>
                    <img src="https://raw.githubusercontent.com/vanjivaldos-cmyk/games-idac/main/images/BingoBiblico.png" alt="Bingo B√≠blico" style="width: 140px; height: 140px; object-fit: contain; margin-bottom: 10px; border-radius: 15px;">
                    <h2 class="game-name">Bingo B√≠blico</h2>
                    <p class="game-desc">Cartela com personagens e hist√≥rias da B√≠blia!</p>
                </div>
                
                <!-- Passa ou Repassa -->
                <div class="game-card passa" onclick="loadGame('passa')">
                    <span class="game-badge">Pronto!</span>
                    <span class="game-icon">üò∞ü•ßüòÜ</span>
                    <h2 class="game-name">Passa ou Repassa</h2>
                    <p class="game-desc">Perguntas b√≠blicas! Errou? Torta na cara!</p>
                </div>
                
                <!-- Roda B√≠blica -->
                <div class="game-card roda" onclick="loadGame('roda')">
                    <span class="game-badge">Pronto!</span>
                    <div class="roda-mini">
                        <svg viewBox="0 0 100 100" class="roda-mini-svg">
                            <circle cx="50" cy="50" r="45" fill="#4ecdc4" stroke="#2a2a4a" stroke-width="3"/>
                            <path d="M50,50 L50,5 A45,45 0 0,1 89,30 Z" fill="#ff6b6b"/>
                            <path d="M50,50 L89,30 A45,45 0 0,1 89,70 Z" fill="#ffe66d"/>
                            <path d="M50,50 L89,70 A45,45 0 0,1 50,95 Z" fill="#95e1d3"/>
                            <path d="M50,50 L50,95 A45,45 0 0,1 11,70 Z" fill="#dda0dd"/>
                            <path d="M50,50 L11,70 A45,45 0 0,1 11,30 Z" fill="#ff6b6b"/>
                            <path d="M50,50 L11,30 A45,45 0 0,1 50,5 Z" fill="#ffe66d"/>
                            <circle cx="50" cy="50" r="8" fill="#2a2a4a"/>
                        </svg>
                        <div class="roda-mini-seta">‚ñº</div>
                    </div>
                    <h2 class="game-name">Roda B√≠blica</h2>
                    <p class="game-desc">Gire a roda e complete vers√≠culos!</p>
                </div>
                
                <!-- Show do Milh√£o -->
                <div class="game-card milhao" onclick="loadGame('milhao')">
                    <span class="game-badge">Pronto!</span>
                    <span class="game-icon">üåΩ</span>
                    <h2 class="game-name">Show do Milh√£o</h2>
                    <p class="game-desc">Perguntas de m√∫ltipla escolha com n√≠veis de dificuldade!</p>
                </div>
                
                <!-- Quem Sou Eu -->
                <div class="game-card quem" onclick="loadGame('quem')">
                    <span class="game-badge">Pronto!</span>
                    <span class="game-icon">ü§î</span>
                    <h2 class="game-name">Quem Sou Eu?</h2>
                    <p class="game-desc">Descubra o personagem b√≠blico atrav√©s das dicas!</p>
                </div>
                
                <!-- Cabine Sim ou N√£o -->
                <div class="game-card cabine" onclick="loadGame('cabine')">
                    <span class="game-badge">Pronto!</span>
                    <span class="game-icon">üéÅ</span>
                    <h2 class="game-name">Cabine do Sim ou N√£o</h2>
                    <p class="game-desc">Aceita ou troca? A plateia v√™, voc√™ decide!</p>
                </div>
            </div>
            
            <!-- PLACAR GERAL -->
            <div id="placarGeralSection" class="admin-only placar-geral-section" style="margin-top: 40px; padding: 25px; background: var(--card-bg); border: 2px solid var(--accent-gold); border-radius: 20px; max-width: 900px; margin-left: auto; margin-right: auto;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3 style="color: var(--accent-gold); font-size: 1.5rem; margin: 0;">üèÜ Placar Geral</h3>
                    <button onclick="zerarPlacarGeral()" class="btn btn-danger" style="padding: 8px 15px; font-size: 0.85rem;">üóëÔ∏è Zerar</button>
                </div>
                <div id="placarGeralContent" style="display: flex; flex-wrap: wrap; gap: 15px; justify-content: center;">
                    <!-- Ser√° preenchido por JavaScript -->
                </div>
                <p style="text-align: center; margin-top: 15px; color: var(--text-secondary); font-size: 0.85rem;">
                    Os pontos s√£o acumulados automaticamente ao final de cada jogo
                </p>
            </div>
        </div>
        
        <!-- ========== CONTAINER DOS JOGOS ========== -->
        <div id="gameContainer"></div>
        
    </div>
    
    <!-- Feedback Overlay -->
    <div class="feedback-overlay" id="feedbackOverlay">
        <div class="feedback-content" id="feedbackContent">
            <span class="feedback-emoji" id="feedbackEmoji">üëè</span>
            <div class="feedback-text" id="feedbackText">Acertou!</div>
        </div>
    </div>

    <!-- Scripts Base -->
    <script>
        // ========== UTILIDADES GLOBAIS ==========
        // ========== CONFIGURA√á√ÉO DE EQUIPES ==========
        const teamColors = [
            { name: 'Jud√° - Azul Royal', color: '#1e3a8a', light: '#dbeafe' },
            { name: 'R√∫ben - Vermelho', color: '#dc2626', light: '#fecaca' },
            { name: 'Sime√£o - Verde', color: '#16a34a', light: '#bbf7d0' },
            { name: 'Levi - Branco', color: '#f8fafc', light: '#f1f5f9', textColor: '#1e293b' },
            { name: 'Issacar - Azul Escuro', color: '#1e3a5f', light: '#e0e7ff' },
            { name: 'Zebulom - Azul Marinho', color: '#1e40af', light: '#bfdbfe' },
            { name: 'D√£ - Azul Safira', color: '#2563eb', light: '#93c5fd' },
            { name: 'Gade - Preto', color: '#18181b', light: '#d4d4d8' },
            { name: 'Aser - Verde Oliva', color: '#65a30d', light: '#d9f99d' },
            { name: 'Naftali - Roxo', color: '#7c3aed', light: '#ddd6fe' },
            { name: 'Jos√© - Multicolor', color: 'linear-gradient(135deg, #7c3aed, #2563eb, #dc2626, #fbbf24)', light: '#fef3c7' },
            { name: 'Benjamim - Degrad√™', color: 'linear-gradient(135deg, #ef4444, #f97316, #eab308, #22c55e, #3b82f6, #8b5cf6)', light: '#fce7f3' }
        ];
        
        let globalTeams = [];
        
        // ========== SISTEMA DE MODOS (ADMIN/PROJECAO) COM FIREBASE ==========
        window.currentMode = localStorage.getItem('idacMode') || null;
        window.gameRoom = 'sala_principal';
        
        window.gameState = {
            currentGame: null,
            currentQuestion: null,
            showAnswer: false,
            selectedOption: null,
            score: {},
            questionRevealed: false
        };
        
        // Placar Geral - acumula pontos de todos os jogos
        window.placarGeral = JSON.parse(localStorage.getItem('placarGeral') || '{}');
        
        // Fun√ß√£o para obter cor do texto (preto para cores claras)
        function getTextColor(colorIndex) {
            const color = teamColors[colorIndex];
            // Cores que precisam de texto escuro
            if (color && color.textColor) {
                return color.textColor;
            }
            return '#ffffff'; // Branco padr√£o
        }
        
        // Fun√ß√£o para salvar placar geral
        function salvarPlacarGeral() {
            localStorage.setItem('placarGeral', JSON.stringify(window.placarGeral));
        }
        
        // Fun√ß√£o para adicionar pontos ao placar geral
        function adicionarPontosGeral(teamIndex, pontos) {
            if (!globalTeams[teamIndex]) return;
            const teamName = globalTeams[teamIndex].name;
            if (!window.placarGeral[teamName]) {
                window.placarGeral[teamName] = { pontos: 0, colorIndex: globalTeams[teamIndex].colorIndex };
            }
            window.placarGeral[teamName].pontos += pontos;
            window.placarGeral[teamName].colorIndex = globalTeams[teamIndex].colorIndex;
            salvarPlacarGeral();
        }
        
        // Fun√ß√£o para zerar placar geral
        function zerarPlacarGeral() {
            if (confirm('üóëÔ∏è Tem certeza que deseja ZERAR o Placar Geral?\n\nIsso apagar√° todos os pontos acumulados!')) {
                window.placarGeral = {};
                salvarPlacarGeral();
                alert('‚úÖ Placar Geral zerado com sucesso!');
                renderPlacarGeral(); // Atualizar a exibi√ß√£o do placar
            }
        }
        
        const gameRef = database.ref('games/' + window.gameRoom);
        
        const ADMIN_PASSWORD = 'idac2025';
        
        function selectMode(mode) {
            // Se for admin, pedir senha
            if (mode === 'admin') {
                const savedAuth = sessionStorage.getItem('adminAuth');
                if (savedAuth !== 'true') {
                    showPasswordPrompt();
                    return;
                }
            }
            
            window.currentMode = mode;
            localStorage.setItem('idacMode', mode);
            
            document.body.classList.remove('admin-mode', 'projection-mode');
            document.body.classList.add(mode + '-mode');
            
            document.getElementById('adminIndicator').style.display = mode === 'admin' ? 'flex' : 'none';
            document.getElementById('projectionIndicator').style.display = mode === 'projection' ? 'flex' : 'none';
            
            document.getElementById('modeSelection').style.display = 'none';
            document.getElementById('teamsConfig').style.display = 'block';
            
            setupFirebaseListener();
            
            if (mode === 'projection') {
                setupProjectionMode();
            }
        }
        
        function showPasswordPrompt() {
            const overlay = document.createElement('div');
            overlay.id = 'passwordOverlay';
            overlay.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.9);display:flex;align-items:center;justify-content:center;z-index:99999;';
            overlay.innerHTML = `
                <div style="background:var(--bg-secondary);padding:40px;border-radius:20px;text-align:center;max-width:400px;width:90%;">
                    <div style="font-size:3rem;margin-bottom:20px;">üîê</div>
                    <h3 style="color:var(--accent-gold);margin-bottom:20px;">Acesso Administrador</h3>
                    <p style="color:var(--text-secondary);margin-bottom:20px;">Digite a senha para acessar o modo Admin:</p>
                    <div style="position:relative;width:100%;margin-bottom:20px;">
                        <input type="password" id="adminPassword" placeholder="Senha" 
                            style="width:100%;padding:15px;border-radius:10px;border:2px solid var(--accent-cyan);background:var(--bg-primary);color:white;font-size:1.2rem;text-align:center;padding-right:50px;">
                        <button type="button" onclick="togglePasswordVisibility()" id="togglePwdBtn"
                            style="position:absolute;right:10px;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;font-size:1.3rem;padding:5px;">
                            üëÅÔ∏è
                        </button>
                    </div>
                    <div style="display:flex;gap:15px;justify-content:center;">
                        <button onclick="cancelPassword()" style="padding:12px 30px;border-radius:10px;border:none;background:rgba(255,255,255,0.1);color:white;cursor:pointer;">Cancelar</button>
                        <button onclick="checkPassword()" style="padding:12px 30px;border-radius:10px;border:none;background:var(--accent-gold);color:var(--bg-primary);font-weight:bold;cursor:pointer;">Entrar</button>
                    </div>
                    <p id="passwordError" style="color:#ff4757;margin-top:15px;display:none;">‚ùå Senha incorreta!</p>
                </div>
            `;
            document.body.appendChild(overlay);
            document.getElementById('adminPassword').focus();
            
            // Enter para confirmar
            document.getElementById('adminPassword').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') checkPassword();
            });
        }
        
        async function checkPassword() {
            const input = document.getElementById('adminPassword').value;
            const errorEl = document.getElementById('passwordError');
            
            if (input === ADMIN_PASSWORD) {
                try {
                    // Verificar se j√° tem admin ativo
                    const available = await checkAdminAvailable();
                    if (!available) {
                        errorEl.textContent = '‚ö†Ô∏è J√° existe um Admin conectado!';
                        errorEl.style.display = 'block';
                        document.getElementById('adminPassword').value = '';
                        return;
                    }
                    
                    sessionStorage.setItem('adminAuth', 'true');
                    document.getElementById('passwordOverlay').remove();
                    registerAsAdmin();
                    selectMode('admin');
                } catch (error) {
                    console.error('Erro ao verificar admin:', error);
                    // Se der erro, permite entrar mesmo assim
                    sessionStorage.setItem('adminAuth', 'true');
                    document.getElementById('passwordOverlay').remove();
                    registerAsAdmin();
                    selectMode('admin');
                }
            } else {
                errorEl.textContent = '‚ùå Senha incorreta!';
                errorEl.style.display = 'block';
                document.getElementById('adminPassword').value = '';
                document.getElementById('adminPassword').focus();
            }
        }
        
        function cancelPassword() {
            document.getElementById('passwordOverlay').remove();
        }
        
        function togglePasswordVisibility() {
            const input = document.getElementById('adminPassword');
            const btn = document.getElementById('togglePwdBtn');
            if (input.type === 'password') {
                input.type = 'text';
                btn.textContent = 'üôà';
            } else {
                input.type = 'password';
                btn.textContent = 'üëÅÔ∏è';
            }
        }
        
        function setupProjectionMode() {
            // IMPORTANTE: Limpar qualquer conte√∫do residual do gameContainer
            document.getElementById('gameContainer').innerHTML = '';
            
            // Garantir que a proje√ß√£o comece na tela de espera (n√£o jogando)
            document.body.classList.remove('projection-playing');
            
            // Buscar equipes do Firebase (do Admin)
            if (window.firebaseReady) {
                window.database.ref('teams_config').once('value', (snapshot) => {
                    const data = snapshot.val();
                    if (data && data.teams) {
                        globalTeams = data.teams;
                        localStorage.setItem('idacTeams', JSON.stringify(globalTeams));
                        // Atualizar visualiza√ß√£o das equipes na proje√ß√£o
                        updateTeamSelectorsProjection();
                    }
                });
                
                // Escutar mudan√ßas nas equipes
                window.database.ref('teams_config').on('value', (snapshot) => {
                    const data = snapshot.val();
                    if (data && data.teams) {
                        globalTeams = data.teams;
                        localStorage.setItem('idacTeams', JSON.stringify(globalTeams));
                    }
                });
                
                // Limpar comando anterior do Firebase para evitar carregar jogo antigo
                // Apenas l√™ o estado atual, n√£o executa comandos antigos
                window.database.ref('games/' + window.gameRoom).once('value', (snapshot) => {
                    const data = snapshot.val();
                    // Se houver um comando antigo (mais de 5 segundos), ignorar
                    if (data && data.timestamp && (Date.now() - data.timestamp > 5000)) {
                        console.log('[PROJE√á√ÉO] Ignorando comando antigo do Firebase');
                    }
                });
            }
            
            // Aplicar restri√ß√µes iniciais
            applyProjectionRestrictions();
            
            // Observar mudan√ßas no DOM para manter restri√ß√µes
            const observer = new MutationObserver(() => {
                applyProjectionRestrictions();
            });
            observer.observe(document.getElementById('gameContainer'), { 
                childList: true, 
                subtree: true 
            });
        }
        
        function applyProjectionRestrictions() {
            if (window.currentMode !== 'projection') return;
            
            // Esconder elementos admin-only
            document.querySelectorAll('.admin-only').forEach(el => {
                el.style.display = 'none';
            });
            
            // Esconder bot√µes de sair/voltar
            document.querySelectorAll('.btn-back, [onclick*="Exit"], [onclick*="confirm"]').forEach(el => {
                el.style.display = 'none';
            });
            
            // Desabilitar todos os bot√µes e inputs no game-content
            document.querySelectorAll('#gameContainer button, #gameContainer input, #gameContainer select, #gameContainer .option-item').forEach(el => {
                el.style.pointerEvents = 'none';
                if (el.tagName === 'BUTTON') {
                    el.disabled = true;
                }
            });
        }
        
        function setupFirebaseListener() {
            gameRef.on('value', (snapshot) => {
                const data = snapshot.val();
                if (!data) return;
                
                if (window.currentMode === 'projection') {
                    handleFirebaseUpdate(data);
                }
            });
            
            // Listener para sincroniza√ß√£o de equipes em tempo real (Proje√ß√£o)
            if (window.currentMode === 'projection') {
                window.database.ref('teams_config').on('value', (snapshot) => {
                    const data = snapshot.val();
                    if (data && data.teams) {
                        globalTeams = data.teams;
                        console.log('[PROJE√á√ÉO] Equipes atualizadas em tempo real:', globalTeams);
                        
                        // Atualizar n√∫mero de equipes no select
                        const numTeamsSelect = document.getElementById('numTeams');
                        if (numTeamsSelect) {
                            numTeamsSelect.value = globalTeams.length;
                        }
                        
                        // Atualizar a visualiza√ß√£o das equipes
                        updateTeamSelectorsProjection();
                    }
                });
            }
        }
        
        // Fun√ß√£o espec√≠fica para atualizar visualiza√ß√£o na Proje√ß√£o (sem disparar sync)
        function updateTeamSelectorsProjection() {
            const container = document.getElementById('teamsList');
            if (!container) return;
            
            let html = '';
            for (let i = 0; i < globalTeams.length; i++) {
                const team = globalTeams[i];
                const color = teamColors[team.colorIndex];
                
                html += `
                    <div class="team-item">
                        <div class="team-color-preview" style="background: ${color.color};"></div>
                        <span class="team-color-name">${color.name}</span>
                        <input type="text" value="${team.leader || ''}" placeholder="L√≠der" 
                               maxlength="12" class="leader-input" readonly
                               style="background: rgba(255,255,255,0.15); cursor: default;">
                    </div>
                `;
            }
            
            container.innerHTML = html;
        }
        
        function handleFirebaseUpdate(data) {
            // IMPORTANTE: Ignorar comandos antigos (mais de 10 segundos)
            if (data.timestamp && (Date.now() - data.timestamp > 10000)) {
                console.log('[PROJE√á√ÉO] Ignorando comando antigo:', data.command);
                return;
            }
            
            if (data.command) {
                switch(data.command) {
                    case 'syncTeams':
                        // Sincronizar equipes do Admin para a Proje√ß√£o
                        if (data.teams && Array.isArray(data.teams)) {
                            globalTeams = data.teams;
                            console.log('[PROJE√á√ÉO] Equipes sincronizadas:', globalTeams);
                        }
                        break;
                    case 'loadGame':
                        // Sincronizar equipes antes de carregar o jogo
                        if (data.teams && Array.isArray(data.teams)) {
                            globalTeams = data.teams;
                        }
                        loadGame(data.game);
                        setTimeout(applyProjectionRestrictions, 100);
                        break;
                    case 'startGame':
                        // Iniciar jogo espec√≠fico
                        if (data.game === 'musica') startMusicaGame();
                        if (data.game === 'passa') startPassaGame();
                        if (data.game === 'roda') startRodaGame();
                        if (data.game === 'milhao') startMilhaoGame();
                        if (data.game === 'quem') startQuemGame();
                        if (data.game === 'bingo') startBingoGame();
                        if (data.game === 'cabine') startCabineGame();
                        setTimeout(applyProjectionRestrictions, 100);
                        break;
                    case 'updateState':
                        // Atualizar estado do jogo
                        updateGameState(data);
                        break;
                    case 'revealAnswer':
                        revealAnswerOnProjection(data);
                        break;
                    case 'showFeedback':
                        Utils.showFeedback(data.type, data.emoji, data.text);
                        break;
                    case 'confetti':
                        Utils.createConfetti(data.amount || 50);
                        break;
                    case 'applause':
                        Utils.playApplause();
                        break;
                    case 'celebration':
                        // Celebra√ß√£o completa: confetti + feedback + som
                        Utils.showFeedback(data.type || 'correct', data.emoji || 'üéâ', data.text || 'Parab√©ns!', data.duration || 3000);
                        Utils.createConfetti(data.confettiAmount || 100);
                        Utils.playApplause();
                        break;
                    case 'nextRound':
                        handleNextRound(data);
                        break;
                    case 'endGame':
                        handleEndGame(data);
                        break;
                    case 'backToMenu':
                        showMenu();
                        break;
                    case 'syncHTML':
                        // Sincronizar HTML diretamente
                        if (data.html) {
                            document.getElementById('gameContainer').innerHTML = data.html;
                            setTimeout(applyProjectionRestrictions, 50);
                        }
                        break;
                    case 'openYoutube':
                        // Abrir YouTube na proje√ß√£o
                        if (data.videoId && data.title) {
                            // Na proje√ß√£o, abrir direto (pode precisar permitir pop-ups)
                            const timeParam = data.startTime > 0 ? `&t=${data.startTime}` : '';
                            const youtubeUrl = `https://www.youtube.com/watch?v=${data.videoId}${timeParam}`;
                            
                            // Tentar abrir em nova aba
                            const newWindow = window.open(youtubeUrl, '_blank');
                            
                            // Se bloqueado, mostrar aviso na tela
                            if (!newWindow || newWindow.closed || typeof newWindow.closed === 'undefined') {
                                showYoutubeOverlay(data.title, youtubeUrl);
                            }
                        }
                        break;
                    case 'closeYoutube':
                        // Fechar modal/overlay do YouTube na proje√ß√£o
                        closeYoutubeModal();
                        closeYoutubeOverlay();
                        break;
                }
            }
        }
        
        function updateGameState(data) {
            if (data.gameType === 'musica' && data.state) {
                Object.assign(musicaState.current, data.state);
                renderMusicaRound();
            }
            if (data.gameType === 'passa' && data.state) {
                Object.assign(passaState.current, data.state);
                renderPassaQuestion();
            }
            setTimeout(applyProjectionRestrictions, 100);
        }
        
        function handleNextRound(data) {
            if (data.game === 'musica') musicaNextRound();
            if (data.game === 'passa') passaNextQuestion();
            setTimeout(applyProjectionRestrictions, 100);
        }
        
        function handleEndGame(data) {
            if (data.game === 'musica') musicaEndGame();
            if (data.game === 'passa') passaEndGame();
            setTimeout(applyProjectionRestrictions, 100);
        }
        
        window.adminSendCommand = function(type, data = {}) {
            if (window.currentMode === 'admin') {
                gameRef.set({
                    command: type,
                    ...data,
                    timestamp: Date.now()
                });
            }
        }
        
        // Sincronizar tela com proje√ß√£o
        window.syncToProjection = function(delay = 100) {
            if (window.currentMode === 'admin') {
                setTimeout(() => {
                    const html = document.getElementById('gameContainer').innerHTML;
                    window.adminSendCommand('syncHTML', { html: html });
                }, delay);
            }
        }
        
        // Wrapper para bot√µes - sincroniza ap√≥s clique
        window.adminAction = function(callback) {
            return function(...args) {
                callback(...args);
                window.syncToProjection(200);
            };
        }
        
        // Auto-sync: observar mudan√ßas no gameContainer e sincronizar
        if (typeof MutationObserver !== 'undefined') {
            const gameContainerObserver = new MutationObserver(() => {
                if (window.currentMode === 'admin' && window.syncToProjection) {
                    clearTimeout(window.syncDebounce);
                    window.syncDebounce = setTimeout(() => {
                        window.syncToProjection(50);
                    }, 200);
                }
            });
            
            // Iniciar observador quando documento carregar
            setTimeout(() => {
                const container = document.getElementById('gameContainer');
                if (container) {
                    gameContainerObserver.observe(container, { childList: true, subtree: false });
                }
            }, 1000);
        }
        
        function revealAnswerOnProjection(data) {
            const correct = data.correct;
            const btn = document.getElementById('milhaoOpt' + correct);
            if (btn) {
                btn.style.background = 'linear-gradient(135deg, #22c55e, #16a34a)';
                btn.style.border = '3px solid #86efac';
                btn.style.transform = 'scale(1.05)';
            }
        }
        
        async function checkMode() {
            const savedMode = localStorage.getItem('idacMode');
            if (savedMode) {
                // Se for admin, verificar se tem autentica√ß√£o na sess√£o
                if (savedMode === 'admin') {
                    const savedAuth = sessionStorage.getItem('adminAuth');
                    if (savedAuth === 'true') {
                        // Verificar se pode ser admin
                        const available = await checkAdminAvailable();
                        if (available) {
                            registerAsAdmin();
                            window.currentMode = 'admin';
                            selectMode('admin');
                        } else {
                            // J√° tem outro admin
                            alert('J√° existe um Admin conectado! Entrando como Proje√ß√£o.');
                            localStorage.setItem('idacMode', 'projection');
                            window.currentMode = 'projection';
                            selectMode('projection');
                        }
                    } else {
                        // N√£o tem auth, voltar para sele√ß√£o
                        localStorage.removeItem('idacMode');
                        document.getElementById('modeSelection').style.display = 'block';
                    }
                } else {
                    window.currentMode = savedMode;
                    selectMode(savedMode);
                }
            }
        }
        
        function resetMode() {
            localStorage.removeItem('idacMode');
            window.currentMode = null;
            document.body.classList.remove('admin-mode', 'projection-mode');
            document.getElementById('adminIndicator').style.display = 'none';
            document.getElementById('projectionIndicator').style.display = 'none';
            document.getElementById('modeSelection').style.display = 'block';
            document.getElementById('teamsConfig').style.display = 'none';
        }
        
        // For√ßa reset completo - volta para tela inicial (s√≥ Admin)
        function forceReset() {
            const popup = document.createElement('div');
            popup.id = 'adminExitPopup';
            popup.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.9);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 99999;
            `;
            
            popup.innerHTML = `
                <div style="background: linear-gradient(135deg, #1a1a4e, #2a2a6e); border: 4px solid var(--accent-cyan); border-radius: 30px; padding: 40px; text-align: center; max-width: 500px;">
                    <div style="font-size: 4rem; margin-bottom: 15px;">üë®‚Äçüíº</div>
                    <div style="font-size: 1.8rem; font-weight: bold; color: var(--accent-cyan); margin-bottom: 20px;">Sair do Modo Admin</div>
                    
                    <div style="color: var(--text-secondary); margin-bottom: 25px; font-size: 1rem; line-height: 1.6;">
                        O que deseja fazer?
                    </div>
                    
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <button onclick="logoutAdminOnly()" style="padding: 15px 30px; background: linear-gradient(135deg, #16a34a, #15803d); border: none; border-radius: 12px; color: white; font-size: 1.1rem; cursor: pointer; font-weight: bold;">
                            üîì Apenas Deslogar
                            <div style="font-size: 0.8rem; font-weight: normal; opacity: 0.9;">Mant√©m equipes, placar e progresso</div>
                        </button>
                        
                        <button onclick="logoutAndResetTeams()" style="padding: 15px 30px; background: linear-gradient(135deg, #f59e0b, #d97706); border: none; border-radius: 12px; color: white; font-size: 1.1rem; cursor: pointer; font-weight: bold;">
                            üîÑ Deslogar e Resetar Equipes
                            <div style="font-size: 0.8rem; font-weight: normal; opacity: 0.9;">Mant√©m apenas o Placar Geral</div>
                        </button>
                        
                        <button onclick="logoutAndResetAll()" style="padding: 15px 30px; background: linear-gradient(135deg, #dc2626, #b91c1c); border: none; border-radius: 12px; color: white; font-size: 1.1rem; cursor: pointer; font-weight: bold;">
                            üóëÔ∏è Resetar TUDO
                            <div style="font-size: 0.8rem; font-weight: normal; opacity: 0.9;">Apaga equipes, placar e todo progresso</div>
                        </button>
                        
                        <button onclick="closeAdminExitPopup()" style="padding: 12px 30px; background: #6b7280; border: none; border-radius: 12px; color: white; font-size: 1rem; cursor: pointer; margin-top: 10px;">
                            ‚Üê Continuar como Admin
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(popup);
        }
        
        function closeAdminExitPopup() {
            const popup = document.getElementById('adminExitPopup');
            if (popup) popup.remove();
        }
        
        // Apenas desloga - mant√©m TUDO (equipes, placar, progresso)
        function logoutAdminOnly() {
            closeAdminExitPopup();
            releaseAdmin();
            sessionStorage.removeItem('adminAuth');
            localStorage.removeItem('idacMode');
            window.currentMode = null;
            
            // Voltar para tela de sele√ß√£o de modo SEM recarregar
            document.body.classList.remove('admin-mode', 'projection-mode');
            document.getElementById('adminIndicator').style.display = 'none';
            document.getElementById('projectionIndicator').style.display = 'none';
            
            // Mostrar tela de sele√ß√£o de modo
            document.getElementById('modeSelection').style.display = 'block';
            document.getElementById('teamsConfig').style.display = 'none';
            document.getElementById('menuScreen').classList.remove('hidden');
            document.getElementById('gameContainer').innerHTML = '';
            
            Utils.showFeedback('correct', 'üîì', 'Deslogado! Dados mantidos.', 2000);
        }
        
        // Desloga e reseta equipes - mant√©m Placar Geral
        function logoutAndResetTeams() {
            if (confirm('‚ö†Ô∏è Isso vai RESETAR as equipes configuradas.\nO Placar Geral ser√° mantido.\n\nContinuar?')) {
                closeAdminExitPopup();
                releaseAdmin();
                sessionStorage.removeItem('adminAuth');
                localStorage.removeItem('idacMode');
                localStorage.removeItem('idacTeams');
                window.currentMode = null;
                location.reload();
            }
        }
        
        // Reseta TUDO - volta ao estado inicial
        function logoutAndResetAll() {
            if (confirm('‚ö†Ô∏è ATEN√á√ÉO: Isso vai APAGAR TUDO!\n\n- Equipes configuradas\n- Placar Geral\n- Todo o progresso\n\nTem certeza?')) {
                closeAdminExitPopup();
                releaseAdmin();
                sessionStorage.removeItem('adminAuth');
                localStorage.removeItem('idacMode');
                localStorage.removeItem('idacTeams');
                localStorage.removeItem('placarGeral');
                window.currentMode = null;
                location.reload();
            }
        }
        
        // Reset para proje√ß√£o - s√≥ recarrega mantendo modo proje√ß√£o
        function projectionReset() {
            if (confirm('Voltar para a tela inicial?')) {
                localStorage.removeItem('idacMode');
                window.currentMode = null;
                location.reload();
            }
        }
        
        // Gesto: Toque 3x r√°pido no canto superior esquerdo para for√ßar reset
        let tapCount = 0;
        let tapTimer = null;
        
        // √Årea de toque no canto superior esquerdo (100x100 pixels)
        document.addEventListener('click', function(e) {
            if (e.clientX < 100 && e.clientY < 100) {
                tapCount++;
                if (tapCount >= 3) {
                    forceReset();
                    tapCount = 0;
                }
                clearTimeout(tapTimer);
                tapTimer = setTimeout(() => tapCount = 0, 1500);
            }
        });
        
        // Tamb√©m funciona com ESC no computador
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                tapCount++;
                if (tapCount >= 3) {
                    forceReset();
                    tapCount = 0;
                }
                clearTimeout(tapTimer);
                tapTimer = setTimeout(() => tapCount = 0, 1500);
            }
        });
        
        // ========== FIM SISTEMA DE MODOS ==========
        
        function initTeams() {
            const saved = localStorage.getItem('idacTeams');
            if (saved) {
                globalTeams = JSON.parse(saved);
                
                // Migrar nomes antigos para formato de tribos
                globalTeams = globalTeams.map((team, i) => {
                    // Se o nome come√ßa com "Equipe" (formato antigo), atualizar para Tribo
                    if (team.name.startsWith('Equipe ')) {
                        const triboName = teamColors[team.colorIndex % teamColors.length].name.split(' - ')[0];
                        team.name = 'Tribo de ' + triboName;
                    }
                    return team;
                });
                
                // Salvar nomes migrados
                localStorage.setItem('idacTeams', JSON.stringify(globalTeams));
                
                document.getElementById('numTeams').value = globalTeams.length;
            } else {
                globalTeams = [
                    { name: 'Tribo de Jud√°', colorIndex: 0, leader: '' },
                    { name: 'Tribo de R√∫ben', colorIndex: 1, leader: '' }
                ];
            }
            updateTeamSelectors();
        }
        
        function updateTeamSelectors() {
            const num = parseInt(document.getElementById('numTeams').value);
            const container = document.getElementById('teamsList');
            
            // Ajustar array de equipes
            while (globalTeams.length < num) {
                const idx = globalTeams.length;
                const triboName = teamColors[idx % teamColors.length].name.split(' - ')[0];
                globalTeams.push({
                    name: `Tribo de ${triboName}`,
                    leader: '',
                    colorIndex: idx % teamColors.length
                });
            }
            while (globalTeams.length > num) {
                globalTeams.pop();
            }
            
            // Gerar HTML
            let html = '';
            for (let i = 0; i < num; i++) {
                const team = globalTeams[i];
                const color = teamColors[team.colorIndex];
                
                html += `
                    <div class="team-item">
                        <div class="team-color-preview" style="background: ${color.color};"></div>
                        <span class="team-color-name">${color.name}</span>
                        <input type="text" value="${team.leader || ''}" placeholder="L√≠der" 
                               maxlength="12" class="leader-input"
                               oninput="updateTeamLeader(${i}, this.value)">
                    </div>
                `;
            }
            
            container.innerHTML = html;
            
            // Sincronizar com proje√ß√£o em tempo real (Admin)
            if (window.currentMode === 'admin') {
                syncTeamsToProjection();
            }
        }
        
        function updateTeamName(index, name) {
            globalTeams[index].name = name;
            debouncedSyncTeams();
        }
        
        function updateTeamLeader(index, leader) {
            globalTeams[index].leader = leader;
            debouncedSyncTeams();
        }
        
        function updateTeamColor(index, colorIndex) {
            globalTeams[index].colorIndex = parseInt(colorIndex);
            const color = teamColors[globalTeams[index].colorIndex];
            document.getElementById(`colorPreview${index}`).style.background = color.color;
            debouncedSyncTeams();
        }
        
        // Debounce para evitar muitas chamadas ao Firebase
        let syncTimeout = null;
        function debouncedSyncTeams() {
            clearTimeout(syncTimeout);
            syncTimeout = setTimeout(() => {
                syncTeamsToProjection();
            }, 300); // Aguarda 300ms ap√≥s √∫ltima digita√ß√£o
        }
        
        // Sincronizar equipes em tempo real com a Proje√ß√£o
        function syncTeamsToProjection() {
            if (window.firebaseReady && window.currentMode === 'admin') {
                window.database.ref('teams_config').set({
                    teams: globalTeams,
                    updatedAt: Date.now()
                });
            }
        }
        
        function saveTeamsConfig() {
            localStorage.setItem('idacTeams', JSON.stringify(globalTeams));
            
            // Sincronizar equipes via Firebase para Proje√ß√£o
            if (window.firebaseReady && window.currentMode === 'admin') {
                window.database.ref('teams_config').set({
                    teams: globalTeams,
                    updatedAt: Date.now()
                });
            }
            Utils.showFeedback('correct', '‚úÖ', 'Equipes salvas!', 1500);
        }
        
        function getTeamColor(index) {
            if (globalTeams[index]) {
                return teamColors[globalTeams[index].colorIndex].color;
            }
            return teamColors[index % teamColors.length].color;
        }
        
        function getTeamName(index) {
            if (globalTeams[index]) {
                return globalTeams[index].name;
            }
            return `Equipe ${index + 1}`;
        }
        
        // Obter nome curto da equipe (sem "Tribo de")
        function getShortName(team) {
            if (!team || !team.name) return 'Equipe';
            return team.name.replace('Tribo de ', '');
        }
        
        const Utils = {
            // Mostrar feedback visual
            showFeedback(type, emoji, text, duration = 1500) {
                const overlay = document.getElementById('feedbackOverlay');
                const content = document.getElementById('feedbackContent');
                
                document.getElementById('feedbackEmoji').textContent = emoji;
                document.getElementById('feedbackText').textContent = text;
                
                content.className = 'feedback-content feedback-' + type;
                overlay.classList.add('visible');
                
                setTimeout(() => overlay.classList.remove('visible'), duration);
            },
            
            // Criar confetti
            createConfetti(count = 60) {
                const colors = ['#ffd700', '#ff6b35', '#ff1493', '#00d4ff', '#00ff88', '#9d4edd'];
                
                for (let i = 0; i < count; i++) {
                    setTimeout(() => {
                        const confetti = document.createElement('div');
                        confetti.className = 'confetti';
                        confetti.style.left = Math.random() * 100 + 'vw';
                        confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                        confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
                        confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
                        document.body.appendChild(confetti);
                        
                        setTimeout(() => confetti.remove(), 3500);
                    }, i * 25);
                }
            },
            
            // Tocar som de aplausos/celebra√ß√£o
            playApplause() {
                try {
                    // Criar contexto de √°udio
                    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    
                    // Fun√ß√£o para criar um "clap" sint√©tico
                    function createClap(time) {
                        const noise = audioContext.createBufferSource();
                        const buffer = audioContext.createBuffer(1, audioContext.sampleRate * 0.1, audioContext.sampleRate);
                        const data = buffer.getChannelData(0);
                        
                        for (let i = 0; i < buffer.length; i++) {
                            data[i] = (Math.random() * 2 - 1) * Math.exp(-i / (buffer.length * 0.1));
                        }
                        
                        noise.buffer = buffer;
                        
                        const filter = audioContext.createBiquadFilter();
                        filter.type = 'highpass';
                        filter.frequency.value = 1000;
                        
                        const gain = audioContext.createGain();
                        gain.gain.value = 0.3;
                        
                        noise.connect(filter);
                        filter.connect(gain);
                        gain.connect(audioContext.destination);
                        
                        noise.start(time);
                    }
                    
                    // Criar uma sequ√™ncia de palmas (aplausos)
                    const now = audioContext.currentTime;
                    for (let i = 0; i < 25; i++) {
                        createClap(now + i * 0.08 + Math.random() * 0.04);
                    }
                    
                    // Adicionar um "whooo" sint√©tico
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.type = 'sine';
                    oscillator.frequency.setValueAtTime(400, now);
                    oscillator.frequency.exponentialRampToValueAtTime(800, now + 0.3);
                    oscillator.frequency.exponentialRampToValueAtTime(600, now + 0.6);
                    
                    gainNode.gain.setValueAtTime(0, now);
                    gainNode.gain.linearRampToValueAtTime(0.15, now + 0.1);
                    gainNode.gain.linearRampToValueAtTime(0.1, now + 0.4);
                    gainNode.gain.linearRampToValueAtTime(0, now + 0.8);
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.start(now);
                    oscillator.stop(now + 0.8);
                    
                    console.log('[AUDIO] Aplausos tocados!');
                } catch (e) {
                    console.warn('[AUDIO] N√£o foi poss√≠vel tocar som:', e);
                }
            },
            
            // Embaralhar array
            shuffle(array) {
                const arr = [...array];
                for (let i = arr.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [arr[i], arr[j]] = [arr[j], arr[i]];
                }
                return arr;
            },
            
            // Salvar no localStorage
            save(key, data) {
                localStorage.setItem('idac_' + key, JSON.stringify(data));
            },
            
            // Carregar do localStorage
            load(key, defaultValue = null) {
                const data = localStorage.getItem('idac_' + key);
                return data ? JSON.parse(data) : defaultValue;
            }
        };
        
        // ========== NAVEGA√á√ÉO ==========
        function showMenu() {
            document.getElementById('menuScreen').classList.remove('hidden');
            document.getElementById('gameContainer').innerHTML = '';
            
            // Se for proje√ß√£o, voltar para tela de espera
            if (window.currentMode === 'projection') {
                document.body.classList.remove('projection-playing');
            }
            
            renderPlacarGeral();
        }
        
        function renderPlacarGeral() {
            const container = document.getElementById('placarGeralContent');
            if (!container) return;
            
            const placar = window.placarGeral || {};
            const entries = Object.entries(placar);
            
            if (entries.length === 0) {
                container.innerHTML = '<p style="color: var(--text-secondary); text-align: center; width: 100%;">Nenhum ponto registrado ainda. Jogue para acumular pontos!</p>';
                return;
            }
            
            // Ordenar por pontos (maior primeiro)
            entries.sort((a, b) => b[1].pontos - a[1].pontos);
            
            container.innerHTML = entries.map(([teamName, data], i) => {
                const color = teamColors[data.colorIndex] || teamColors[0];
                const textColor = color.textColor || '#ffffff';
                const medal = i === 0 ? 'ü•á' : i === 1 ? 'ü•à' : i === 2 ? 'ü•â' : 'üèÖ';
                
                return `
                    <div style="background: ${color.color}; color: ${textColor}; padding: 15px 20px; border-radius: 15px; min-width: 120px; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.3);">
                        <div style="font-size: 1.5rem;">${medal}</div>
                        <div style="font-size: 0.9rem; font-weight: bold; margin: 5px 0;">${teamName}</div>
                        <div style="font-size: 2rem; font-weight: bold;">${data.pontos}</div>
                        <div style="font-size: 0.7rem; opacity: 0.8;">pontos</div>
                    </div>
                `;
            }).join('');
        }
        
        function loadGame(gameId) {
            // SEGURAN√áA: Verificar se um modo foi selecionado
            if (!window.currentMode) {
                Utils.showFeedback('wrong', 'üîí', 'Selecione um modo primeiro!', 2500);
                
                // Mostrar tela de sele√ß√£o de modo
                document.getElementById('modeSelection').style.display = 'block';
                document.getElementById('teamsConfig').style.display = 'none';
                return;
            }
            
            // SEGURAN√áA: Proje√ß√£o s√≥ pode carregar jogos via comando do Admin (Firebase)
            // Isso √© verificado pelo fato de que a proje√ß√£o n√£o tem acesso aos cards de jogos
            // Se chegou aqui via Firebase, permitir
            
            // SEGURAN√áA: Verificar se equipes foram configuradas (apenas para Admin)
            if (window.currentMode === 'admin' && (!globalTeams || globalTeams.length === 0)) {
                Utils.showFeedback('wrong', '‚ö†Ô∏è', 'Configure as equipes primeiro!', 2500);
                return;
            }
            
            // Marcar que a proje√ß√£o est√° "jogando" (esconde tela de espera)
            if (window.currentMode === 'projection') {
                document.body.classList.add('projection-playing');
            }
            
            document.getElementById('menuScreen').classList.add('hidden');
            
            // Enviar para proje√ß√£o se for admin (incluindo as equipes para sincroniza√ß√£o)
            if (window.currentMode === 'admin') {
                adminSendCommand('loadGame', { game: gameId, teams: globalTeams });
            }
            
            switch(gameId) {
                case 'musica':
                    loadMusicaGame();
                    break;
                case 'bingo':
                    loadBingoGame();
                    break;
                case 'passa':
                    loadPassaGame();
                    break;
                case 'roda':
                    loadRodaGame();
                    break;
                case 'milhao':
                    loadMilhaoGame();
                    break;
                case 'quem':
                    loadQuemGame();
                    break;
                case 'cabine':
                    loadCabineGame();
                    break;
            }
        }
        
        // ========== CRIAR PART√çCULAS ==========
        function createParticles() {
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + 'vw';
                particle.style.animationDelay = Math.random() * 15 + 's';
                particle.style.animationDuration = (15 + Math.random() * 10) + 's';
                document.body.appendChild(particle);
            }
        }
        
        // ========== INICIALIZA√á√ÉO ==========
        document.addEventListener('DOMContentLoaded', () => {
            createParticles();
            initTeams();
            checkMode();
            
            // Renderizar placar geral inicial
            setTimeout(() => {
                renderPlacarGeral();
            }, 100);
            
            // Esconder loading
            setTimeout(() => {
                document.getElementById('loadingScreen').classList.add('hidden');
            }, 800);
        });
    </script>
    
    <!-- Script: QUAL √â O LOUVOR -->
    
    
    <!-- Script: BINGO B√çBLICO -->
    
    
    <!-- Script: PASSA OU REPASSA -->
    
    
    <!-- Script: RODA B√çBLICA -->
    
    
    <!-- Script: SHOW DO MILH√ÉO -->
    
    
    <!-- Script: QUEM SOU EU -->
    
    
    <!-- Script: CABINE SIM OU N√ÉO -->
    


<script>
// ========== QUAL √â O LOUVOR? ==========

// Banco de louvores com links do YouTube e tempo de in√≠cio
let musicaSongs = [
    { title: "Porque Ele Vive", artist: "Cl√°ssico", emoji: "‚úùÔ∏è üåÖ üí™ üôè üòä üö´üò® ‚òÄÔ∏è ‚ù§Ô∏è", hint: "Porque Ele vive, posso crer no amanh√£, temor n√£o h√°", youtube: "3o1suXgQYfE", startTime: 18 },
    { title: "Maravilhosa Gra√ßa", artist: "Cl√°ssico", emoji: "‚ú® üéÅ üíï ‚ôæÔ∏è üîÑ ‚úùÔ∏è üôå üòá", hint: "Amor que n√£o tem fim, tomou o meu lugar", youtube: "vQcSVijP4M0", startTime: 58 },
    { title: "Grandioso √âs Tu", artist: "Cl√°ssico", emoji: "üë§ üéµ üëë üôå üí™ ‚ú® üòÆ üôè", hint: "Ent√£o minha alma canta a ti Senhor", youtube: "-KCN9Ev-EY0", startTime: 1 },
    { title: "Castelo Forte", artist: "Martinho Lutero", emoji: "üè∞ üí™ üëë üõ°Ô∏è ‚öîÔ∏è üôè ‚úùÔ∏è üîí", hint: "Escudo e boa Espada", youtube: "RGCzQjFKk2w", startTime: 4 },
    { title: "Rendido Estou", artist: "Isaias Saad e D√©bora Buzas", emoji: "ü§≤ üè≥Ô∏è üßé ü¶∂ ‚úùÔ∏è üíï üôè üòá", hint: "Aos p√©s da Cruz me encontrei", youtube: "EhRoefQgV_U", startTime: 1 },
    { title: "√Åguas Purificadoras", artist: "Cl√°ssico", emoji: "üåä üíß üëë üíï ‚ù§Ô∏è ‚ú® üôè üòá", hint: "Existe um rio que flui do teu grande amor", youtube: "XUDifaNsjtA", startTime: 16 },
    { title: "Qu√£o Grande √âs Tu", artist: "Cl√°ssico", emoji: "üëë üôè üòÆ ü§î üñêÔ∏è üåç ‚≠ê üå≥", hint: "Quando eu maravilhado, penso nas obras de tuas m√£os", youtube: "88oiUxRPU0w", startTime: 16 },
    { title: "Santo Esp√≠rito", artist: "Laura Souguellis", emoji: "üïäÔ∏è üèÜ 1Ô∏è‚É£ ‚ù§Ô∏è ‚ú® üôå üòä üôè", hint: "N√£o h√° nada igual, n√£o h√° nada melhor", youtube: "J2rTdu7vqTE", startTime: 14 },
    { title: "A Ele a Gl√≥ria", artist: "Adhemar de Campos", emoji: "üëë ‚ú® üåç üôå üé∫ üí´ üôè ‚ù§Ô∏è", hint: "Porque Dele e por Ele s√£o todas as coisas", youtube: "m5hc5vHz-jY", startTime: 30 },
    { title: "√â Ele", artist: "Paulo Vicente - DROPS", emoji: "‚úùÔ∏è üíØ ‚ù§Ô∏è üéÅ üòä üôå üî• üíï", hint: "Gastando minha vida, perdendo tudo, por amor", youtube: "CKGm0F8ZNY8", startTime: 230 },
    { title: "A Boa Parte", artist: "Fhop Music", emoji: "üë© üßé ü¶∂ üëë üìñ üëÇ ‚ù§Ô∏è ‚ú®", hint: "Como Maria, que estava aos seus p√©s", youtube: "dlGOiuxSzVw", startTime: 180 },
    { title: "Deus de Promessas", artist: "Davi Sacer", emoji: "üëÄ üëÅÔ∏è üîç üíï ü§ù üìú üëë ‚ú®", hint: "Seus olhos sempre atentos permanecem em mim", youtube: "bHqWcfnkrOo", startTime: 18 },
    { title: "Quem √© Esse?", artist: "Julliany Souza", emoji: "‚ùì üë§ üéí ‚úùÔ∏è üö´üòà üíï üòÆ üëë", hint: "E os meus pecados levou", youtube: "0ZF5em0MTwY", startTime: 360 },
    { title: "Fico Feliz", artist: "Aline Barros", emoji: "üòä üéâ üè† ‚õ™ üö∂ ‚ù§Ô∏è üôå üéµ", hint: "Em vir em tua casa", youtube: "jXIsP2JdWxY", startTime: 20 },
    { title: "Tua Gra√ßa Me Basta", artist: "Davi Sacer", emoji: "‚ú® üéÅ ‚úÖ üëë üòä ‚ù§Ô∏è üôå üôè", hint: "Tua gra√ßa me basta e sua presen√ßa √© meu prazer", youtube: "F9hWwTQ4MKQ", startTime: 195 },
    { title: "Lugar Secreto", artist: "Gabriela Rocha", emoji: "ü§´ üè† ‚¨áÔ∏è üîç üëë ‚ù§Ô∏è üôè ‚ú®", hint: "Quero ir mais fundo, mais perto, onde eu te encontro", youtube: "jpsAWqUsbxQ", startTime: 150 },
    { title: "Nada Al√©m do Sangue", artist: "Fernandinho", emoji: "ü©∏ ‚úùÔ∏è üöø üîÑ üí™ ‚ù§Ô∏è ‚ú® üôè", hint: "Que nos lava dos pecados, traz restaura√ß√£o", youtube: "_nEBkb-iyN8", startTime: 160 },
    { title: "Aos Olhos do Pai", artist: "Ana Paula Valad√£o", emoji: "üëÄ üë® üé® üñºÔ∏è üñêÔ∏è üíé ‚ù§Ô∏è ‚ú®", hint: "Voc√™ √© uma obra prima que Ele planejou", youtube: "_m3_4rx-caU", startTime: 108 },
    { title: "Reina Sobre Mim", artist: "Delino Mar√ßal", emoji: "üëë ‚¨áÔ∏è üßé üè≥Ô∏è ‚ù§Ô∏è üôå üôè ‚ú®", hint: "Vem, reina sobre mim, eu me rendo a Ti", youtube: "J0lias2YjJM", startTime: 270 },
    { title: "N√£o Pare", artist: "Midian Lima", emoji: "üö´üõë üé£ üèÉ üí™ ‚ùì üëë üôè ‚è©", hint: "Quem mandou largar a rede, quem mandou parar?", youtube: "DZmXM_6rMjM", startTime: 80 },
    { title: "Oceanos", artist: "Hillsong (Ana N√≥brega)", emoji: "üåä üö∂ üß≠ ü§ù üëë üôè üí™ ‚ú®", hint: "Guia-me para que em Ti confie, sobre as √°guas caminhe", youtube: "rNA8QlQI_dI", startTime: 300 },
    { title: "Deus Est√° Aqui", artist: "Cl√°ssico", emoji: "üëë üìç üí® üòÆ‚Äçüí® ‚úÖ ‚ù§Ô∏è ‚ú® üôè", hint: "T√£o certo como o ar que eu respiro", youtube: "2Xs4Qq_wr3k", startTime: 15 },
    { title: "A Casa √â Sua", artist: "Casa Worship", emoji: "üè† üëë üì¢ ‚¨ÜÔ∏è üåä ‚ú® üôå ‚ù§Ô∏è", hint: "Apare√ßa, que o Teu nome cres√ßa, enche este lugar", youtube: "x55BaAkPTDA", startTime: 120 },
    { title: "Bondade de Deus", artist: "Isaias Saad", emoji: "üíï üëë ‚ú® üéÅ üìÖ üñêÔ∏è ü§≤ üòä", hint: "Tua gra√ßa nunca falha, todos os dias em tuas m√£os", youtube: "mZ9yZYo9Mmk", startTime: 15 }
];

// Estado do jogo
let musicaState = {
    config: { totalRounds: 10, timePerRound: 60 },
    current: { round: 1, scores: [], usedSongs: [], currentSong: null, timer: null, timeLeft: 60 }
};

function loadMusicaGame() {
    // Carregar m√∫sicas salvas
    const saved = Utils.load('musicaSongs');
    if (saved) musicaSongs = saved;
    
    renderMusicaSetup();
}

function renderMusicaSetup() {
    document.getElementById('gameContainer').innerHTML = `
        <div class="game-screen active">
            <div class="game-content">
                <div class="setup-container">
                    <h2 class="setup-title">üéµ Qual √© o Louvor?</h2>
                    
                    <div class="form-group">
                        <label class="form-label">Equipes Participantes</label>
                        <div style="background: rgba(0,212,255,0.1); border: 1px solid var(--accent-cyan); border-radius: 10px; padding: 15px;">
                            ${globalTeams.map((t, i) => `<div style="padding: 5px 0; color: var(--text-primary);">‚Ä¢ ${t.name} ${t.leader ? '(' + t.leader + ')' : ''}</div>`).join('')}
                        </div>
                        <small style="color: var(--text-secondary);">Configure as equipes no menu principal</small>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">N√∫mero de Rodadas</label>
                        <div class="option-group">
                            <div class="option-item ${musicaState.config.totalRounds === 5 ? 'selected' : ''}" onclick="selectMusicaRounds(this, 5)">
                                <span class="option-radio"></span>
                                <span>5 rodadas (r√°pido)</span>
                            </div>
                            <div class="option-item ${musicaState.config.totalRounds === 10 ? 'selected' : ''}" onclick="selectMusicaRounds(this, 10)">
                                <span class="option-radio"></span>
                                <span>10 rodadas (normal)</span>
                            </div>
                            <div class="option-item ${musicaState.config.totalRounds === 15 ? 'selected' : ''}" onclick="selectMusicaRounds(this, 15)">
                                <span class="option-radio"></span>
                                <span>15 rodadas (longo)</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Tempo por Rodada</label>
                        <div class="option-group">
                            <div class="option-item ${musicaState.config.timePerRound === 30 ? 'selected' : ''}" onclick="selectMusicaTime(this, 30)">
                                <span class="option-radio"></span>
                                <span>30 segundos (dif√≠cil)</span>
                            </div>
                            <div class="option-item ${musicaState.config.timePerRound === 60 ? 'selected' : ''}" onclick="selectMusicaTime(this, 60)">
                                <span class="option-radio"></span>
                                <span>60 segundos (normal)</span>
                            </div>
                            <div class="option-item ${musicaState.config.timePerRound === 90 ? 'selected' : ''}" onclick="selectMusicaTime(this, 90)">
                                <span class="option-radio"></span>
                                <span>90 segundos (f√°cil)</span>
                            </div>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 15px; margin-top: 30px;">
                        <button class="btn btn-secondary" onclick="showMenu()" style="flex: 1;">‚Üê Voltar</button>
                        <button class="btn btn-primary" onclick="startMusicaGame()" style="flex: 2;">üé§ Iniciar Jogo!</button>
                    </div>
                    
                    <button class="btn btn-secondary" onclick="openMusicaAdmin()" style="width: 100%; margin-top: 15px;">
                        ‚öôÔ∏è Gerenciar Louvores (${musicaSongs.length} cadastrados)
                    </button>
                </div>
            </div>
        </div>
    `;
}

function selectMusicaRounds(el, value) {
    el.parentElement.querySelectorAll('.option-item').forEach(o => o.classList.remove('selected'));
    el.classList.add('selected');
    musicaState.config.totalRounds = value;
}

function selectMusicaTime(el, value) {
    el.parentElement.querySelectorAll('.option-item').forEach(o => o.classList.remove('selected'));
    el.classList.add('selected');
    musicaState.config.timePerRound = value;
}

function startMusicaGame() {
    if (musicaSongs.length < musicaState.config.totalRounds) {
        alert(`Voc√™ precisa de pelo menos ${musicaState.config.totalRounds} louvores! (tem ${musicaSongs.length})`);
        return;
    }
    
    // Sincronizar com proje√ß√£o
    if (window.currentMode === 'admin') {
        window.adminSendCommand('startGame', { game: 'musica' });
    }
    
    musicaState.current = {
        round: 1,
        scores: globalTeams.map(() => 0),
        usedSongs: [],
        currentSong: null,
        timer: null,
        timeLeft: musicaState.config.timePerRound
    };
    
    renderMusicaRound();
}

function renderMusicaRound() {
    // Selecionar m√∫sica aleat√≥ria
    const available = musicaSongs.filter((_, i) => !musicaState.current.usedSongs.includes(i));
    const randomIdx = Math.floor(Math.random() * available.length);
    const songIdx = musicaSongs.indexOf(available[randomIdx]);
    
    musicaState.current.usedSongs.push(songIdx);
    musicaState.current.currentSong = musicaSongs[songIdx];
    musicaState.current.timeLeft = musicaState.config.timePerRound;
    
    document.getElementById('gameContainer').innerHTML = `
        <div class="game-screen active">
            <div class="game-header">
                <button class="btn-back" onclick="confirmMusicaExit()">‚Üê Sair</button>
                <div class="game-title-header">üéµ Qual √© o Louvor?</div>
                <div class="scoreboard" style="display: flex; gap: 10px; flex-wrap: wrap;">
                    ${globalTeams.map((team, i) => `
                        <div class="team-score" style="background: ${teamColors[team.colorIndex].color}; color: ${getTextColor(team.colorIndex)}; min-width: 80px; padding: 8px 12px; border-radius: 10px; text-align: center;">
                            <div class="team-name" style="font-size: 0.7rem; opacity: 0.9;">${getShortName(team)}</div>
                            <div style="font-size: 0.55rem; opacity: 0.7;">${team.leader || ''}</div>
                            <div class="team-points" style="font-size: 1.2rem; font-weight: bold;">${musicaState.current.scores[i] || 0}</div>
                        </div>
                    `).join('')}
                </div>
            </div>
            
            <div class="game-content">
                <!-- PAINEL ADMIN - S√≥ vis√≠vel para Admin -->
                <div class="admin-controls admin-only" style="margin-bottom: 20px;">
                    <h4>üë®‚Äçüíº PAINEL DO ADMINISTRADOR</h4>
                    <div class="admin-answer">
                        üéµ Resposta: <strong>${musicaState.current.currentSong.title}</strong>
                        ${musicaState.current.currentSong.artist ? ' - ' + musicaState.current.currentSong.artist : ''}
                    </div>
                    <div style="margin-top: 10px; color: #fca5a5;">
                        üí° Dica: ${musicaState.current.currentSong.hint}
                    </div>
                </div>
                
                <div style="color: var(--text-secondary); margin-bottom: 20px; font-size: 1.2rem;">
                    Rodada ${musicaState.current.round} de ${musicaState.config.totalRounds}
                </div>
                
                <div style="background: var(--card-bg); border: 3px solid var(--card-border); border-radius: 30px; padding: 50px 60px; position: relative; max-width: 900px; text-align: center;">
                    <div class="emoji-display" style="font-size: 4rem; line-height: 1.5; letter-spacing: 10px; word-spacing: 20px;" id="musicaEmoji">
                        ${musicaState.current.currentSong.emoji}
                    </div>
                    <div style="position: absolute; bottom: 0; left: 0; height: 8px; background: linear-gradient(90deg, var(--accent-gold), var(--accent-orange)); border-radius: 0 0 30px 30px; transition: width 0.1s;" id="musicaTimerBar"></div>
                </div>
                
                <div style="margin: 25px 0; font-size: 1.3rem; color: var(--text-secondary); min-height: 35px;" id="musicaHint"></div>
                
                <div style="background: rgba(0, 255, 136, 0.1); border: 2px solid var(--accent-green); border-radius: 20px; padding: 20px 40px; display: none;" id="musicaAnswer">
                    <div style="color: var(--accent-green); font-size: 0.9rem; margin-bottom: 8px;">A resposta era:</div>
                    <div style="font-size: 1.8rem; font-weight: 700;">${musicaState.current.currentSong.title}${musicaState.current.currentSong.artist ? ` - ${musicaState.current.currentSong.artist}` : ''}</div>
                    ${musicaState.current.currentSong.youtube ? `
                        <button onclick="openYoutubeModal('${musicaState.current.currentSong.youtube}', '${musicaState.current.currentSong.title.replace(/'/g, "\\'")} - ${musicaState.current.currentSong.artist.replace(/'/g, "\\'")}', ${musicaState.current.currentSong.startTime || 0})" 
                            style="margin-top: 15px; padding: 12px 25px; background: linear-gradient(135deg, #ff0000, #cc0000); border: none; border-radius: 10px; color: white; font-size: 1rem; cursor: pointer; display: inline-flex; align-items: center; gap: 10px;">
                            ‚ñ∂Ô∏è Ouvir Trecho no YouTube
                        </button>
                    ` : ''}
                </div>
                
                <div style="display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; margin-top: 30px;" id="musicaActions">
                    ${globalTeams.map((team, i) => `
                        <button class="btn btn-success" onclick="musicaCorrect(${i})" style="background: ${teamColors[team.colorIndex].color.includes('gradient') ? teamColors[team.colorIndex].color : teamColors[team.colorIndex].color};">
                            üëè ${getShortName(team)}
                        </button>
                    `).join('')}
                    <button class="btn btn-danger" onclick="musicaWrong()">‚ùå Ningu√©m</button>
                </div>
                
                <div style="display: none; gap: 20px; justify-content: center; margin-top: 30px;" id="musicaNext">
                    <button class="btn btn-secondary" onclick="musicaShowHint()">üí° Dica</button>
                    <button class="btn btn-info" onclick="musicaNextRound()">‚û°Ô∏è Pr√≥xima Rodada</button>
                </div>
            </div>
        </div>
    `;
    
    // Converter emojis para imagens Twemoji (Twitter)
    if (typeof twemoji !== 'undefined') {
        setTimeout(() => {
            twemoji.parse(document.getElementById('musicaEmoji'), {
                folder: 'svg',
                ext: '.svg'
            });
        }, 50);
    }
    
    startMusicaTimer();
    window.syncToProjection && window.syncToProjection(200);
}

function startMusicaTimer() {
    const bar = document.getElementById('musicaTimerBar');
    
    if (musicaState.current.timer) clearInterval(musicaState.current.timer);
    
    musicaState.current.timer = setInterval(() => {
        musicaState.current.timeLeft -= 0.1;
        const pct = (musicaState.current.timeLeft / musicaState.config.timePerRound) * 100;
        bar.style.width = pct + '%';
        
        if (musicaState.current.timeLeft <= 0) {
            clearInterval(musicaState.current.timer);
            Utils.showFeedback('wrong', '‚è∞', 'Tempo!');
            musicaRevealAnswer();
        }
    }, 100);
}

function musicaCorrect(teamIndex) {
    clearInterval(musicaState.current.timer);
    
    musicaState.current.scores[teamIndex]++;
    
    // Atualizar placar visualmente imediatamente
    updateScoreboardDisplay();
    
    Utils.showFeedback('correct', 'üëè', globalTeams[teamIndex].name + ' Acertou!');
    Utils.createConfetti();
    musicaRevealAnswer();
    
    // Sincronizar com proje√ß√£o
    if (window.currentMode === 'admin') {
        window.adminSendCommand('showFeedback', { type: 'correct', emoji: 'üëè', text: globalTeams[teamIndex].name + ' Acertou!' });
        window.adminSendCommand('confetti', { amount: 50 });
        setTimeout(() => {
            window.adminSendCommand('syncHTML', { html: document.getElementById('gameContainer').innerHTML });
        }, 500);
    }
}

// Fun√ß√£o para atualizar placar visualmente
function updateScoreboardDisplay() {
    const scoreElements = document.querySelectorAll('.scoreboard .team-score .team-points');
    scoreElements.forEach((el, i) => {
        if (musicaState.current.scores[i] !== undefined) {
            el.textContent = musicaState.current.scores[i];
        }
    });
}

function musicaWrong() {
    Utils.showFeedback('wrong', '‚ùå', 'Errou!');
    if (window.currentMode === 'admin') {
        window.adminSendCommand('showFeedback', { type: 'wrong', emoji: '‚ùå', text: 'Errou!' });
    }
}

function musicaShowHint() {
    const hint = musicaState.current.currentSong.hint;
    document.getElementById('musicaHint').textContent = hint ? 'üí° ' + hint : 'üí° Sem dica dispon√≠vel';
}

function musicaRevealAnswer() {
    document.getElementById('musicaAnswer').style.display = 'block';
    document.getElementById('musicaActions').style.display = 'none';
    document.getElementById('musicaNext').style.display = 'flex';
    window.syncToProjection && window.syncToProjection(100);
}

function musicaNextRound() {
    if (musicaState.current.round >= musicaState.config.totalRounds) {
        musicaEndGame();
    } else {
        musicaState.current.round++;
        renderMusicaRound();
    }
}

function musicaEndGame() {
    // Adicionar pontos ao placar geral
    globalTeams.forEach((team, i) => {
        if (musicaState.current.scores[i] > 0) {
            adicionarPontosGeral(i, musicaState.current.scores[i]);
        }
    });
    
    // Encontrar vencedor(es)
    const maxScore = Math.max(...musicaState.current.scores);
    const winners = globalTeams.filter((t, i) => musicaState.current.scores[i] === maxScore);
    const winnerText = winners.length > 1 ? 'Empate!' : winners[0].name;
    
    // Ordenar equipes por pontua√ß√£o
    const ranking = globalTeams.map((t, i) => ({ team: t, score: musicaState.current.scores[i] }))
        .sort((a, b) => b.score - a.score);
    
    Utils.createConfetti(100);
    
    document.getElementById('gameContainer').innerHTML = `
        <div class="game-screen active">
            <div class="game-content">
                <div class="end-container">
                    <span class="trophy-icon">üèÜ</span>
                    <h2 class="winner-title">Parab√©ns!</h2>
                    <p class="winner-name">${winnerText}</p>
                    
                    <div class="final-scores" style="display: flex; flex-wrap: wrap; gap: 15px; justify-content: center;">
                        ${ranking.map((r, i) => `
                            <div class="final-score-item" style="background: ${teamColors[r.team.colorIndex].color}; color: ${getTextColor(r.team.colorIndex)}; padding: 15px 20px; border-radius: 15px; min-width: 100px; text-align: center;">
                                <div style="font-size: 1.5rem;">${i === 0 ? 'ü•á' : i === 1 ? 'ü•à' : i === 2 ? 'ü•â' : 'üèÖ'}</div>
                                <div class="final-score-label" style="font-size: 0.85rem;">${r.team.name}</div>
                                <div style="font-size: 0.7rem; opacity: 0.8;">${r.team.leader || ''}</div>
                                <div class="final-score-value" style="font-size: 1.5rem; font-weight: bold;">${r.score}</div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <p style="margin-top: 20px; color: var(--accent-green); font-size: 0.9rem;">
                        ‚úÖ Pontos adicionados ao Placar Geral!
                    </p>
                    
                    <div style="display: flex; gap: 20px; justify-content: center; margin-top: 30px;">
                        <button class="btn btn-secondary" onclick="showMenu()">üè† Menu</button>
                        <button class="btn btn-primary" onclick="renderMusicaSetup()">üîÑ Jogar Novamente</button>
                    </div>
                </div>
            </div>
        </div>
    `;
}

// ========== MODAL DO YOUTUBE ==========
function openYoutubeModal(videoId, title, startTime = 0) {
    // Abrir direto no YouTube em nova aba (funciona com Premium, sem erro de embed)
    const timeParam = startTime > 0 ? `&t=${startTime}` : '';
    const youtubeUrl = `https://www.youtube.com/watch?v=${videoId}${timeParam}`;
    
    // Abrir em nova aba
    window.open(youtubeUrl, '_blank');
    
    // Sincronizar com proje√ß√£o se for admin
    if (window.currentMode === 'admin') {
        window.adminSendCommand('openYoutube', { videoId: videoId, title: title, startTime: startTime });
    }
}

// Overlay para quando pop-up for bloqueado na proje√ß√£o
function showYoutubeOverlay(title, url) {
    // Remover overlay anterior se existir
    const existingOverlay = document.getElementById('youtubeOverlay');
    if (existingOverlay) existingOverlay.remove();
    
    const overlay = document.createElement('div');
    overlay.id = 'youtubeOverlay';
    overlay.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.95);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        z-index: 99999;
        animation: fadeIn 0.3s ease;
    `;
    
    overlay.innerHTML = `
        <div style="text-align: center; padding: 40px;">
            <div style="font-size: 5rem; margin-bottom: 30px;">üéµ</div>
            <div style="font-size: 2.5rem; font-weight: bold; color: var(--accent-gold); margin-bottom: 20px;">
                ${title}
            </div>
            <div style="font-size: 1.5rem; color: var(--text-secondary); margin-bottom: 40px;">
                Reproduzindo no YouTube...
            </div>
            <div style="
                background: rgba(255, 0, 0, 0.2);
                border: 2px solid #ff0000;
                border-radius: 15px;
                padding: 20px 40px;
                display: inline-block;
            ">
                <div style="font-size: 1.2rem; color: white;">
                    üîä Toque a m√∫sica no computador do Admin
                </div>
            </div>
        </div>
    `;
    
    document.body.appendChild(overlay);
    
    // Auto-remover ap√≥s 30 segundos
    setTimeout(() => {
        if (document.getElementById('youtubeOverlay')) {
            closeYoutubeOverlay();
        }
    }, 30000);
}

function closeYoutubeOverlay() {
    const overlay = document.getElementById('youtubeOverlay');
    if (overlay) {
        overlay.style.animation = 'fadeOut 0.3s ease';
        setTimeout(() => overlay.remove(), 300);
    }
}

function closeYoutubeModal() {
    const modal = document.getElementById('youtubeModal');
    if (modal) {
        modal.style.animation = 'fadeOut 0.3s ease';
        setTimeout(() => modal.remove(), 300);
    }
    
    // Sincronizar fechamento com proje√ß√£o
    if (window.currentMode === 'admin') {
        window.adminSendCommand('closeYoutube', {});
    }
}

// Adicionar estilo de anima√ß√£o se n√£o existir
if (!document.getElementById('youtubeModalStyles')) {
    const style = document.createElement('style');
    style.id = 'youtubeModalStyles';
    style.textContent = `
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
    `;
    document.head.appendChild(style);
}

function confirmMusicaExit() {
    if (confirm('Tem certeza que deseja sair? O progresso ser√° perdido.')) {
        clearInterval(musicaState.current.timer);
        showMenu();
    }
}

function openMusicaAdmin() {
    document.getElementById('gameContainer').innerHTML = `
        <div class="game-screen active">
            <div class="game-header">
                <button class="btn-back" onclick="renderMusicaSetup()">‚Üê Voltar</button>
                <div class="game-title-header">‚öôÔ∏è Gerenciar Louvores</div>
                <div></div>
            </div>
            
            <div class="game-content" style="align-items: flex-start; padding: 30px;">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; width: 100%; max-width: 1200px;">
                    
                    <div class="setup-container">
                        <h3 style="margin-bottom: 20px;">‚ûï Adicionar Louvor</h3>
                        
                        <div class="form-group">
                            <label class="form-label">Nome do Louvor *</label>
                            <input type="text" class="form-input" id="newSongTitle" placeholder="Ex: Agnus Dei">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Cantor/Banda</label>
                            <input type="text" class="form-input" id="newSongArtist" placeholder="Ex: Fernandinho">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Emojis da Estrofe *</label>
                            <textarea class="form-input" id="newSongEmoji" rows="3" placeholder="Ex: üêë üëë üôè ‚ù§Ô∏è ‚ú® üéµ"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Dica</label>
                            <input type="text" class="form-input" id="newSongHint" placeholder="Ex: Fala sobre o Cordeiro de Deus">
                        </div>
                        
                        <button class="btn btn-success" onclick="addMusicaSong()" style="width: 100%;">‚ûï Adicionar</button>
                    </div>
                    
                    <div class="setup-container" style="max-height: 70vh; overflow-y: auto;">
                        <h3 style="margin-bottom: 20px;">üìã Louvores Cadastrados (${musicaSongs.length})</h3>
                        <div id="musicaSongList"></div>
                    </div>
                </div>
            </div>
        </div>
    `;
    
    updateMusicaSongList();
}

function addMusicaSong() {
    const title = document.getElementById('newSongTitle').value.trim();
    const artist = document.getElementById('newSongArtist').value.trim();
    const emoji = document.getElementById('newSongEmoji').value.trim();
    const hint = document.getElementById('newSongHint').value.trim();
    
    if (!title || !emoji) {
        alert('Preencha pelo menos o nome e os emojis!');
        return;
    }
    
    musicaSongs.push({ title, artist, emoji, hint });
    Utils.save('musicaSongs', musicaSongs);
    
    document.getElementById('newSongTitle').value = '';
    document.getElementById('newSongArtist').value = '';
    document.getElementById('newSongEmoji').value = '';
    document.getElementById('newSongHint').value = '';
    
    updateMusicaSongList();
    Utils.showFeedback('correct', '‚úÖ', 'Adicionado!', 1000);
}

function deleteMusicaSong(idx) {
    if (confirm(`Remover "${musicaSongs[idx].title}"?`)) {
        musicaSongs.splice(idx, 1);
        Utils.save('musicaSongs', musicaSongs);
        updateMusicaSongList();
    }
}

function updateMusicaSongList() {
    const container = document.getElementById('musicaSongList');
    container.innerHTML = musicaSongs.map((song, i) => `
        <div style="background: rgba(255,255,255,0.03); border-radius: 12px; padding: 15px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center;">
            <div>
                <div style="font-weight: 600;">${song.title}${song.artist ? ` - ${song.artist}` : ''}</div>
                <div style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 5px;">${song.emoji.substring(0, 40)}...</div>
            </div>
            <button onclick="deleteMusicaSong(${i})" style="background: rgba(255,71,87,0.2); border: none; color: #ff4757; width: 35px; height: 35px; border-radius: 8px; cursor: pointer; font-size: 1.1rem;">üóëÔ∏è</button>
        </div>
    `).join('');
}
// ========== BINGO B√çBLICO ==========

// Itens do bingo com vers√≠culos
const bingoItems = [
    { id: 1, name: "Ad√£o", category: "personagem", emoji: "üë®", versiculo: "E formou o Senhor Deus o homem do p√≥ da terra, e soprou em suas narinas o f√¥lego da vida.", ref: "G√™nesis 2:7", versao: "ARC" },
    { id: 2, name: "Eva", category: "personagem", emoji: "üë©", versiculo: "E da costela que o Senhor Deus tomou do homem, formou uma mulher.", ref: "G√™nesis 2:22", versao: "ARC" },
    { id: 3, name: "No√©", category: "personagem", emoji: "üö¢", versiculo: "No√© era homem justo e √≠ntegro em suas gera√ß√µes; No√© andava com Deus.", ref: "G√™nesis 6:9", versao: "ARC" },
    { id: 4, name: "Abra√£o", category: "personagem", emoji: "üë¥", versiculo: "Em ti ser√£o benditas todas as fam√≠lias da terra.", ref: "G√™nesis 12:3", versao: "ARC" },
    { id: 5, name: "Mois√©s", category: "personagem", emoji: "üìú", versiculo: "Vai, pois, agora, e eu serei com a tua boca, e te ensinarei o que h√°s de falar.", ref: "√äxodo 4:12", versao: "ARC" },
    { id: 6, name: "Davi", category: "personagem", emoji: "üé∂", versiculo: "Cantai ao Senhor um c√¢ntico novo; cantai ao Senhor, todas as terras.", ref: "Salmos 96:1", versao: "ARC" },
    { id: 7, name: "Salom√£o", category: "personagem", emoji: "‚öñÔ∏è", versiculo: "Dai a esta a crian√ßa viva, e de modo nenhum a mateis; esta √© sua m√£e.", ref: "1 Reis 3:27", versao: "ARC" },
    { id: 8, name: "Daniel", category: "personagem", emoji: "üßé", versiculo: "Daniel, tr√™s vezes no dia, se punha de joelhos e orava, e dava gra√ßas diante do seu Deus.", ref: "Daniel 6:10", versao: "ARC" },
    { id: 9, name: "Jonas", category: "personagem", emoji: "üêã", versiculo: "Preparou o Senhor um grande peixe, para que tragasse a Jonas.", ref: "Jonas 1:17", versao: "ARC" },
    { id: 10, name: "Terra", category: "simbolo", emoji: "üåç", versiculo: "Toda a terra est√° cheia da sua gl√≥ria.", ref: "Isa√≠as 6:3", versao: "ARC" },
    { id: 11, name: "Jos√©", category: "personagem", emoji: "üî®", versiculo: "Jos√©, seu esposo, sendo justo e n√£o querendo difam√°-la, resolveu deix√°-la secretamente.", ref: "Mateus 1:19", versao: "ARC" },
    { id: 12, name: "Jesus", category: "personagem", emoji: "üëë", versiculo: "Eu sou o caminho, a verdade e a vida; ningu√©m vem ao Pai sen√£o por mim.", ref: "Jo√£o 14:6", versao: "ARC" },
    { id: 13, name: "Pedro", category: "personagem", emoji: "üîë", versiculo: "Tu √©s Pedro, e sobre esta pedra edificarei a minha igreja.", ref: "Mateus 16:18", versao: "ARC" },
    { id: 14, name: "Paulo", category: "personagem", emoji: "‚úâÔ∏è", versiculo: "Combati o bom combate, acabei a carreira, guardei a f√©.", ref: "2 Tim√≥teo 4:7", versao: "ARC" },
    { id: 15, name: "Jo√£o", category: "personagem", emoji: "üìñ", versiculo: "Deus √© amor; e quem est√° em amor est√° em Deus, e Deus nele.", ref: "1 Jo√£o 4:16", versao: "ARC" },
    { id: 16, name: "Arca de No√©", category: "historia", emoji: "üåà", versiculo: "O meu arco tenho posto nas nuvens; este ser√° por sinal da alian√ßa.", ref: "G√™nesis 9:13", versao: "ARC" },
    { id: 17, name: "Travessia Mar Vermelho", category: "historia", emoji: "üåä", versiculo: "E os filhos de Israel passaram pelo meio do mar em seco.", ref: "√äxodo 14:22", versao: "ARC" },
    { id: 18, name: "Davi e Golias", category: "historia", emoji: "üéØ", versiculo: "Tu vens a mim com espada e lan√ßa; eu vou a ti em nome do Senhor.", ref: "1 Samuel 17:45", versao: "ARC" },
    { id: 19, name: "Igreja Noiva de Cristo", category: "simbolo", emoji: "üë∞", versiculo: "Cristo amou a igreja, e a si mesmo se entregou por ela, para a santificar.", ref: "Ef√©sios 5:25-27", versao: "ARC" },
    { id: 20, name: "Jonas e o Grande Peixe", category: "historia", emoji: "üê≥", versiculo: "Na minha ang√∫stia clamei ao Senhor, e ele me respondeu.", ref: "Jonas 2:2", versao: "ARC" },
    { id: 21, name: "Nascimento de Jesus", category: "historia", emoji: "üë∂", versiculo: "Hoje vos nasceu, na cidade de Davi, o Salvador, que √© Cristo, o Senhor.", ref: "Lucas 2:11", versao: "ARC" },
    { id: 22, name: "Menor√°", category: "simbolo", emoji: "üïé", versiculo: "Far√°s tamb√©m um candelabro de ouro puro; de ouro batido se far√° este candelabro.", ref: "√äxodo 25:31", versao: "ARC" },
    { id: 23, name: "√öltima Ceia", category: "historia", emoji: "üç∑", versiculo: "Isto √© o meu corpo, que por v√≥s √© dado; fazei isto em mem√≥ria de mim.", ref: "Lucas 22:19", versao: "ARC" },
    { id: 24, name: "Ressurrei√ß√£o", category: "historia", emoji: "üåÖ", versiculo: "Ele n√£o est√° aqui, mas ressuscitou.", ref: "Lucas 24:6", versao: "ARC" },
    { id: 25, name: "Pentecostes", category: "historia", emoji: "üî•", versiculo: "E todos foram cheios do Esp√≠rito Santo.", ref: "Atos 2:4", versao: "ARC" },
    { id: 26, name: "Pomba", category: "simbolo", emoji: "üïäÔ∏è", versiculo: "E o Esp√≠rito Santo desceu sobre ele em forma corp√≥rea, como pomba.", ref: "Lucas 3:22", versao: "ARC" },
    { id: 27, name: "Cruz", category: "simbolo", emoji: "‚úùÔ∏è", versiculo: "Porque a palavra da cruz √© loucura para os que perecem; mas para n√≥s, que somos salvos, √© o poder de Deus.", ref: "1 Cor√≠ntios 1:18", versao: "ARC" },
    { id: 28, name: "P√£o", category: "simbolo", emoji: "üçû", versiculo: "Eu sou o p√£o da vida; aquele que vem a mim n√£o ter√° fome.", ref: "Jo√£o 6:35", versao: "ARC" },
    { id: 29, name: "Estrela dos Magos", category: "historia", emoji: "üå†", versiculo: "Onde est√° aquele que √© nascido rei dos judeus? Vimos a sua estrela no oriente e viemos a ador√°-lo.", ref: "Mateus 2:2", versao: "ARC" },
    { id: 30, name: "Cordeiro", category: "simbolo", emoji: "üêë", versiculo: "Eis o Cordeiro de Deus, que tira o pecado do mundo.", ref: "Jo√£o 1:29", versao: "ARC" },
    { id: 31, name: "Le√£o de Jud√°", category: "simbolo", emoji: "ü¶Å", versiculo: "Eis que o Le√£o da tribo de Jud√° venceu.", ref: "Apocalipse 5:5", versao: "ARC" },
    { id: 32, name: "Estrela de Bel√©m", category: "simbolo", emoji: "üåü", versiculo: "A estrela que tinham visto no oriente ia adiante deles, at√© parar sobre o lugar onde estava o menino.", ref: "Mateus 2:9", versao: "ARC" },
    { id: 33, name: "Amor de Deus", category: "simbolo", emoji: "ü•∞", versiculo: "Porque Deus amou o mundo de tal maneira que deu o seu Filho unig√™nito, para que todo aquele que nele cr√™ n√£o pere√ßa, mas tenha a vida eterna.", ref: "Jo√£o 3:16", versao: "ARC" },
    { id: 34, name: "Fam√≠lia", category: "simbolo", emoji: "üë™", versiculo: "Filhos, obede√ßam a seus pais no Senhor, pois isso √© justo.", ref: "Ef√©sios 6:1-4", versao: "ARC" },
    { id: 35, name: "Arca da Alian√ßa", category: "objeto", emoji: "üì¶", versiculo: "E por√°s na arca o testemunho, que eu te darei.", ref: "√äxodo 25:21", versao: "ARC" },
    { id: 36, name: "T√°buas da Lei", category: "objeto", emoji: "üìã", versiculo: "E deu a Mois√©s duas t√°buas do testemunho, t√°buas de pedra, escritas pelo dedo de Deus.", ref: "√äxodo 31:18", versao: "ARC" },
    { id: 37, name: "Sabedoria", category: "simbolo", emoji: "ü¶â", versiculo: "Se algum de voc√™s tem falta de sabedoria, pe√ßa-a a Deus, que a todos d√° livremente, de boa vontade, e ser√° concedida.", ref: "Tiago 1:5", versao: "ARC" },
    { id: 38, name: "Elias", category: "personagem", emoji: "üåßÔ∏è", versiculo: "E aconteceu que os c√©us se enegreceram com nuvens e vento, e veio uma grande chuva.", ref: "1 Reis 18:45", versao: "ARC" },
    { id: 39, name: "Sans√£o", category: "personagem", emoji: "üí™", versiculo: "E o Esp√≠rito do Senhor come√ßou a mov√™-lo.", ref: "Ju√≠zes 13:25", versao: "ARC" },
    { id: 40, name: "Rute", category: "personagem", emoji: "üåæ", versiculo: "O teu povo √© o meu povo, o teu Deus √© o meu Deus.", ref: "Rute 1:16", versao: "ARC" },
    { id: 41, name: "Ester", category: "personagem", emoji: "üë∏", versiculo: "E quem sabe se para tal tempo como este chegaste a este reino?", ref: "Ester 4:14", versao: "ARC" },
    { id: 42, name: "J√≥", category: "personagem", emoji: "üôè", versiculo: "O Senhor deu, e o Senhor o tomou; bendito seja o nome do Senhor.", ref: "J√≥ 1:21", versao: "ARC" },
    { id: 43, name: "Isa√≠as", category: "personagem", emoji: "üì¢", versiculo: "Eis-me aqui, envia-me a mim.", ref: "Isa√≠as 6:8", versao: "ARC" },
    { id: 44, name: "Jeremias", category: "personagem", emoji: "üò¢", versiculo: "Antes que te formasse no ventre te conheci.", ref: "Jeremias 1:5", versao: "ARC" },
    { id: 45, name: "Ezequiel", category: "personagem", emoji: "üëÅÔ∏è", versiculo: "E porei dentro em v√≥s o meu Esp√≠rito.", ref: "Ezequiel 36:27", versao: "ARC" },
    { id: 46, name: "Jo√£o Batista", category: "personagem", emoji: "üèúÔ∏è", versiculo: "Preparai o caminho do Senhor, endireitai as suas veredas.", ref: "Mateus 3:3", versao: "ARC" },
    { id: 47, name: "L√°zaro", category: "personagem", emoji: "üôã‚Äç‚ôÇÔ∏è", versiculo: "L√°zaro, sai para fora!", ref: "Jo√£o 11:43", versao: "ARC" },
    { id: 48, name: "Bom Samaritano", category: "historia", emoji: "ü§ù", versiculo: "Vai, e faze da mesma maneira.", ref: "Lucas 10:37", versao: "ARC" },
    { id: 49, name: "Filho Pr√≥digo", category: "historia", emoji: "üè†", versiculo: "Porque este meu filho estava morto, e reviveu; tinha-se perdido, e foi achado.", ref: "Lucas 15:24", versao: "ARC" },
    { id: 50, name: "Multiplica√ß√£o dos P√£es", category: "historia", emoji: "üêü", versiculo: "E, tomando os cinco p√£es e os dois peixes, levantou os olhos ao c√©u e os aben√ßoou.", ref: "Lucas 9:16", versao: "ARC" },
    { id: 51, name: "Gide√£o", category: "personagem", emoji: "‚öîÔ∏è", versiculo: "Vai nesta tua for√ßa, e livrar√°s a Israel.", ref: "Ju√≠zes 6:14", versao: "ARC" },
    { id: 52, name: "Samuel", category: "personagem", emoji: "üëÇ", versiculo: "Fala, Senhor, porque o teu servo ouve.", ref: "1 Samuel 3:9", versao: "ARC" },
    { id: 53, name: "Raabe", category: "personagem", emoji: "üßµ", versiculo: "Pela f√© Raabe, a meretriz, n√£o pereceu com os incr√©dulos.", ref: "Hebreus 11:31", versao: "ARC" },
    { id: 54, name: "Calebe", category: "personagem", emoji: "üçá", versiculo: "Subiremos e a possuiremos, porque certamente prevaleceremos.", ref: "N√∫meros 13:30", versao: "ARC" },
    { id: 55, name: "Porta", category: "simbolo", emoji: "üö™", versiculo: "Eu sou a porta; se algu√©m entrar por mim, salvar-se-√°.", ref: "Jo√£o 10:9", versao: "ARC" },
    { id: 56, name: "Marta e Maria", category: "personagem", emoji: "üë≠", versiculo: "Maria escolheu a boa parte, a qual n√£o lhe ser√° tirada.", ref: "Lucas 10:42", versao: "ARC" },
    { id: 57, name: "Zaqueu", category: "personagem", emoji: "üå≥", versiculo: "Zaqueu, desce depressa, porque hoje me conv√©m pousar em tua casa.", ref: "Lucas 19:5", versao: "ARC" },
    { id: 58, name: "Nicodemos", category: "personagem", emoji: "üåô", versiculo: "Aquele que n√£o nascer de novo, n√£o pode ver o reino de Deus.", ref: "Jo√£o 3:3", versao: "ARC" },
    { id: 59, name: "Caminho de Ema√∫s", category: "historia", emoji: "üö∂", versiculo: "Porventura n√£o ardia em n√≥s o nosso cora√ß√£o quando ele nos falava?", ref: "Lucas 24:32", versao: "ARC" },
    { id: 60, name: "Bodas de Can√°", category: "historia", emoji: "üè∫", versiculo: "Fazei tudo quanto ele vos disser.", ref: "Jo√£o 2:5", versao: "ARC" },
    { id: 61, name: "Transfigura√ß√£o", category: "historia", emoji: "‚ú®", versiculo: "E transfigurou-se diante deles; e o seu rosto resplandeceu como o sol.", ref: "Mateus 17:2", versao: "ARC" },
    { id: 62, name: "Templo de Salom√£o", category: "lugar", emoji: "üõï", versiculo: "A gl√≥ria do Senhor encheu a casa do Senhor.", ref: "1 Reis 8:11", versao: "ARC" },
    { id: 63, name: "Po√ßo de Jac√≥", category: "lugar", emoji: "üí¶", versiculo: "Aquele que beber da √°gua que eu lhe der nunca ter√° sede.", ref: "Jo√£o 4:14", versao: "ARC" },
    { id: 64, name: "Monte das Oliveiras", category: "lugar", emoji: "‚õ∞Ô∏è", versiculo: "Ent√£o foram para o Monte das Oliveiras.", ref: "Mateus 26:30", versao: "ARC" }
];

// Estado do bingo com controle de bingos por equipe
let bingoState = {
    drawnItems: [],
    currentItem: null,
    isPlaying: false,
    bingosPerTeam: {} // { teamIndex: quantidade }
};

function loadBingoGame() {
    renderBingoSetup();
}

function renderBingoSetup() {
    document.getElementById('gameContainer').innerHTML = `
        <div class="game-screen active">
            <div class="game-content">
                <div class="setup-container" style="max-width: 600px;">
                    <h2 class="setup-title">üìñ Bingo B√≠blico</h2>
                    
                    <div style="background: rgba(0, 212, 255, 0.1); border: 2px solid var(--accent-cyan); border-radius: 15px; padding: 20px; margin-bottom: 30px;">
                        <h3 style="color: var(--accent-cyan); margin-bottom: 10px;">üìã Como Jogar</h3>
                        <p style="color: var(--text-secondary); line-height: 1.6;">
                            1. Distribua cartelas de bingo para os participantes<br>
                            2. Clique em "Sortear" para sortear um item<br>
                            3. Quem tiver o item marca na cartela<br>
                            4. Quem completar uma linha/coluna/diagonal grita "BINGO!"
                        </p>
                    </div>
                    
                    <div style="text-align: center; margin-bottom: 20px;">
                        <img src="https://raw.githubusercontent.com/vanjivaldos-cmyk/games-idac/main/images/BingoBiblico.png" alt="Bingo B√≠blico" style="width: 180px; height: 180px; object-fit: contain; border-radius: 15px;">
                        <p style="color: var(--text-secondary); margin-top: 10px;">
                            ${bingoItems.length} itens dispon√≠veis para sorteio
                        </p>
                    </div>
                    
                    <div style="display: flex; gap: 15px;">
                        <button class="btn btn-secondary" onclick="showMenu()" style="flex: 1;">‚Üê Voltar</button>
                        <button class="btn btn-primary" onclick="startBingoGame()" style="flex: 2;">üé≤ Iniciar Sorteio!</button>
                    </div>
                    
                    <button class="btn btn-info" onclick="generateBingoCards()" style="width: 100%; margin-top: 15px;">
                        üñ®Ô∏è Gerar Cartelas para Impress√£o
                    </button>
                </div>
            </div>
        </div>
    `;
}

function startBingoGame() {
    // Sincronizar in√≠cio do jogo
    if (window.currentMode === 'admin') {
        window.adminSendCommand('startGame', { game: 'bingo' });
    }
    
    bingoState = {
        drawnItems: [],
        currentItem: null,
        isPlaying: true,
        bingosPerTeam: {}
    };
    
    // Inicializar bingos por equipe
    globalTeams.forEach((_, i) => {
        bingoState.bingosPerTeam[i] = 0;
    });
    
    renderBingoPlay();
}

function renderBingoPlay() {
    document.getElementById('gameContainer').innerHTML = `
        <div class="game-screen active">
            <div class="game-header">
                <button class="btn-back" onclick="confirmBingoExit()">‚Üê Sair</button>
                <div class="game-title-header">üìñ Bingo B√≠blico</div>
                <div style="color: var(--text-secondary);">
                    Sorteados: ${bingoState.drawnItems.length} / ${bingoItems.length}
                </div>
            </div>
            
            <div class="game-content" style="padding: 20px;">
                <!-- Layout Principal: Sorteados √† esquerda, Item atual √† direita -->
                <div style="display: flex; gap: 30px; justify-content: center; align-items: flex-start; flex-wrap: wrap; max-width: 1200px; margin: 0 auto;">
                    
                    <!-- Coluna Esquerda: J√° Sorteados -->
                    <div style="background: rgba(0,0,0,0.3); border: 2px solid var(--accent-cyan); border-radius: 20px; padding: 15px; min-width: 200px; max-width: 250px; max-height: 500px; overflow-y: auto;">
                        <h3 style="color: var(--accent-cyan); margin-bottom: 15px; text-align: center; font-size: 1rem; position: sticky; top: 0; background: rgba(26,26,74,0.95); padding: 5px; border-radius: 10px;">
                            üìú J√° Sorteados (${bingoState.drawnItems.length})
                        </h3>
                        <div style="display: flex; flex-direction: column; gap: 8px;">
                            ${bingoState.drawnItems.length > 0 ? bingoState.drawnItems.map((item, idx) => `
                                <div style="background: rgba(255,255,255,0.08); padding: 8px 12px; border-radius: 10px; display: flex; align-items: center; gap: 10px; font-size: 0.9rem;">
                                    <span style="color: var(--accent-gold); font-weight: bold; min-width: 25px;">${idx + 1}.</span>
                                    <span style="font-size: 1.3rem;">${item.emoji}</span>
                                    <span style="flex: 1;">${item.name}</span>
                                </div>
                            `).join('') : `
                                <div style="text-align: center; color: var(--text-secondary); padding: 20px; font-size: 0.9rem;">
                                    Nenhum item sorteado ainda
                                </div>
                            `}
                        </div>
                    </div>
                    
                    <!-- Coluna Central: Item Atual + Bot√µes -->
                    <div style="flex: 1; max-width: 600px;">
                        <!-- Item Atual -->
                        <div style="background: var(--card-bg); border: 4px solid var(--accent-cyan); border-radius: 30px; padding: 40px 50px; text-align: center; margin-bottom: 25px;">
                            ${bingoState.currentItem ? `
                                <div style="font-size: 6rem; margin-bottom: 15px;">${bingoState.currentItem.emoji}</div>
                                <div style="font-family: 'Righteous', cursive; font-size: 2.5rem; color: var(--accent-cyan);">${bingoState.currentItem.name}</div>
                                <div style="color: var(--text-secondary); margin-top: 5px; text-transform: capitalize; font-size: 1.1rem;">${bingoState.currentItem.category}</div>
                                
                                <!-- Vers√≠culo -->
                                <div style="margin-top: 20px; padding: 15px 20px; background: rgba(255,215,0,0.1); border: 2px solid var(--accent-gold); border-radius: 15px;">
                                    <div style="font-style: italic; color: var(--text-primary); font-size: 1rem; line-height: 1.5;">
                                        "${bingoState.currentItem.versiculo}"
                                    </div>
                                    <div style="color: var(--accent-gold); margin-top: 10px; font-size: 0.9rem; font-weight: bold;">
                                        üìñ ${bingoState.currentItem.ref} (${bingoState.currentItem.versao})
                                    </div>
                                </div>
                            ` : `
                                <div style="font-size: 5rem; opacity: 0.3;">‚ùì</div>
                                <div style="font-size: 1.3rem; color: var(--text-secondary); margin-top: 20px;">Clique em sortear para come√ßar!</div>
                            `}
                        </div>
                        
                        <!-- Bot√µes de A√ß√£o -->
                        <div style="display: flex; gap: 15px; flex-wrap: wrap; justify-content: center; margin-bottom: 25px;">
                            <button class="btn btn-primary" onclick="drawBingoItem()" style="font-size: 1.2rem; padding: 15px 40px;" ${bingoState.drawnItems.length >= bingoItems.length ? 'disabled' : ''}>
                                üé≤ Sortear Pr√≥ximo
                            </button>
                            <button class="btn" onclick="showBingoPopup()" style="font-size: 1.2rem; padding: 15px 40px; background: linear-gradient(135deg, #f59e0b, #d97706);">
                                üéâ BINGO!
                            </button>
                        </div>
                        
                        <!-- Controle de Bingos por Equipe (Admin Only) -->
                        <div class="admin-only" style="background: rgba(255,255,255,0.05); border: 2px solid var(--accent-gold); border-radius: 15px; padding: 15px 20px;">
                            <h4 style="color: var(--accent-gold); margin-bottom: 15px; text-align: center; font-size: 0.95rem;">üèÜ Bingos por Equipe (clique para registrar)</h4>
                            <div style="display: flex; flex-wrap: wrap; gap: 10px; justify-content: center;">
                                ${globalTeams.map((team, i) => `
                                    <div style="background: ${teamColors[team.colorIndex].color}; color: ${getTextColor(team.colorIndex)}; padding: 8px 12px; border-radius: 10px; text-align: center; min-width: 80px; cursor: pointer;" onclick="registrarBingo(${i})">
                                        <div style="font-size: 0.75rem;">${getShortName(team)}</div>
                                        <div style="font-size: 1.3rem; font-weight: bold;">${bingoState.bingosPerTeam[i] || 0}</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `;
}

// Popup quando algu√©m grita BINGO
function showBingoPopup() {
    const popup = document.createElement('div');
    popup.id = 'bingoPopup';
    popup.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.9);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 99999;
        animation: fadeIn 0.3s ease;
    `;
    
    popup.innerHTML = `
        <div style="background: linear-gradient(135deg, #1a1a4e, #2a2a6e); border: 4px solid var(--accent-gold); border-radius: 30px; padding: 40px; text-align: center; max-width: 500px;">
            <div style="font-size: 5rem; margin-bottom: 20px;">üéâ</div>
            <div style="font-size: 3rem; font-weight: bold; color: var(--accent-gold); margin-bottom: 20px;">BINGO!</div>
            <div style="color: var(--text-secondary); margin-bottom: 30px; font-size: 1.1rem;">
                Confira a cartela do participante!
            </div>
            
            <div style="display: flex; flex-direction: column; gap: 15px;">
                <div style="color: var(--text-primary); margin-bottom: 10px;">Qual equipe bingou?</div>
                <div style="display: flex; flex-wrap: wrap; gap: 10px; justify-content: center;">
                    ${globalTeams.map((team, i) => `
                        <button onclick="confirmarBingo(${i})" style="background: ${teamColors[team.colorIndex].color}; color: ${getTextColor(team.colorIndex)}; border: none; padding: 12px 20px; border-radius: 10px; cursor: pointer; font-weight: bold;">
                            ${getShortName(team)}
                        </button>
                    `).join('')}
                </div>
                
                <div style="display: flex; gap: 15px; justify-content: center; margin-top: 20px;">
                    <button onclick="closeBingoPopup()" style="padding: 12px 30px; background: #6b7280; border: none; border-radius: 10px; color: white; cursor: pointer;">
                        ‚ùå Cancelar (Bingo Falso)
                    </button>
                    <button onclick="resetarBingo()" style="padding: 12px 30px; background: #dc2626; border: none; border-radius: 10px; color: white; cursor: pointer;">
                        üîÑ Resetar Jogo
                    </button>
                </div>
            </div>
        </div>
    `;
    
    document.body.appendChild(popup);
    
    // Sincronizar com proje√ß√£o
    if (window.currentMode === 'admin') {
        window.adminSendCommand('showBingoPopup', {});
    }
}

function closeBingoPopup() {
    const popup = document.getElementById('bingoPopup');
    if (popup) popup.remove();
    
    if (window.currentMode === 'admin') {
        window.adminSendCommand('closeBingoPopup', {});
    }
}

function confirmarBingo(teamIndex) {
    // Registrar bingo para a equipe
    if (!bingoState.bingosPerTeam[teamIndex]) {
        bingoState.bingosPerTeam[teamIndex] = 0;
    }
    bingoState.bingosPerTeam[teamIndex]++;
    
    // Adicionar pontos ao placar geral (1 bingo = 5 pontos)
    adicionarPontosGeral(teamIndex, 5);
    
    // Debug: mostrar os pontos atuais
    const teamName = globalTeams[teamIndex].name;
    const pontosAtuais = window.placarGeral[teamName]?.pontos || 0;
    console.log(`[BINGO POPUP] ${teamName}: +5 pontos (Total: ${pontosAtuais})`);
    
    closeBingoPopup();
    
    // Celebra√ß√£o local (Admin)
    Utils.showFeedback('correct', 'üéâ', `${globalTeams[teamIndex].name} BINGOU!`, 3000);
    Utils.createConfetti(100);
    Utils.playApplause();
    
    // Atualizar placar geral na tela
    renderPlacarGeral();
    
    renderBingoPlay();
    
    // Sincronizar celebra√ß√£o com proje√ß√£o
    if (window.currentMode === 'admin') {
        // Enviar celebra√ß√£o completa para a proje√ß√£o
        window.adminSendCommand('celebration', { 
            type: 'correct',
            emoji: 'üéâ', 
            text: `${globalTeams[teamIndex].name} BINGOU!`,
            duration: 3000,
            confettiAmount: 100
        });
        
        // Tamb√©m sincronizar a tela do jogo
        window.syncToProjection && window.syncToProjection(500);
    }
}

function registrarBingo(teamIndex) {
    if (!bingoState.bingosPerTeam[teamIndex]) {
        bingoState.bingosPerTeam[teamIndex] = 0;
    }
    bingoState.bingosPerTeam[teamIndex]++;
    
    // Adicionar pontos ao placar geral
    adicionarPontosGeral(teamIndex, 5);
    
    // Debug: mostrar os pontos atuais
    const teamName = globalTeams[teamIndex].name;
    const pontosAtuais = window.placarGeral[teamName]?.pontos || 0;
    console.log(`[BINGO] ${teamName}: +5 pontos (Total: ${pontosAtuais})`);
    
    // Celebra√ß√£o local (Admin)
    Utils.showFeedback('correct', 'üéâ', `${getShortName(globalTeams[teamIndex])} BINGOU! (+5 pts)`, 2500);
    Utils.createConfetti(80);
    Utils.playApplause();
    
    // Atualizar placar geral na tela
    renderPlacarGeral();
    
    // Sincronizar celebra√ß√£o com proje√ß√£o
    if (window.currentMode === 'admin') {
        window.adminSendCommand('celebration', { 
            type: 'correct',
            emoji: 'üéâ', 
            text: `${getShortName(globalTeams[teamIndex])} BINGOU!`,
            duration: 2500,
            confettiAmount: 80
        });
    }
    
    renderBingoPlay();
}

function resetarBingo() {
    if (confirm('üîÑ Tem certeza que deseja RESETAR o Bingo?\n\nTodos os sorteios ser√£o apagados e o jogo recome√ßar√° do zero!')) {
        bingoState = {
            drawnItems: [],
            currentItem: null,
            isPlaying: true,
            bingosPerTeam: {}
        };
        closeBingoPopup();
        renderBingoPlay();
        
        if (window.currentMode === 'admin') {
            window.adminSendCommand('resetarBingo', {});
        }
    }
}

function drawBingoItem() {
    const available = bingoItems.filter(item => !bingoState.drawnItems.find(d => d.id === item.id));
    
    if (available.length === 0) {
        alert('Todos os itens j√° foram sorteados!');
        return;
    }
    
    // Anima√ß√£o de sorteio
    let count = 0;
    const interval = setInterval(() => {
        const randomItem = available[Math.floor(Math.random() * available.length)];
        bingoState.currentItem = randomItem;
        renderBingoPlay();
        count++;
        
        if (count >= 15) {
            clearInterval(interval);
            // Sortear o item final
            const finalItem = available[Math.floor(Math.random() * available.length)];
            bingoState.currentItem = finalItem;
            bingoState.drawnItems.push(finalItem);
            window.syncToProjection && window.syncToProjection(300);
            renderBingoPlay();
            Utils.showFeedback('correct', finalItem.emoji, finalItem.name, 2000);
        }
    }, 100);
}

function confirmBingoExit() {
    // Verificar se h√° bingos registrados
    const totalBingos = Object.values(bingoState.bingosPerTeam).reduce((a, b) => a + b, 0);
    
    if (totalBingos > 0) {
        // H√° bingos registrados - mostrar popup com op√ß√µes
        const popup = document.createElement('div');
        popup.id = 'exitBingoPopup';
        popup.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 99999;
        `;
        
        popup.innerHTML = `
            <div style="background: linear-gradient(135deg, #1a1a4e, #2a2a6e); border: 4px solid var(--accent-gold); border-radius: 30px; padding: 40px; text-align: center; max-width: 500px;">
                <div style="font-size: 4rem; margin-bottom: 20px;">üö™</div>
                <div style="font-size: 1.8rem; font-weight: bold; color: var(--accent-gold); margin-bottom: 15px;">Sair do Bingo</div>
                <div style="color: var(--text-secondary); margin-bottom: 25px; font-size: 1rem; line-height: 1.5;">
                    Voc√™ tem <strong style="color: var(--accent-cyan);">${totalBingos} bingo(s)</strong> registrado(s).<br>
                    O que deseja fazer?
                </div>
                
                <div style="display: flex; flex-direction: column; gap: 15px;">
                    <button onclick="salvarESairBingo()" style="padding: 15px 30px; background: linear-gradient(135deg, #16a34a, #15803d); border: none; border-radius: 12px; color: white; font-size: 1.1rem; cursor: pointer; font-weight: bold;">
                        ‚úÖ Salvar Pontos e Sair
                        <div style="font-size: 0.8rem; font-weight: normal; opacity: 0.9;">Os bingos ser√£o mantidos no Placar Geral</div>
                    </button>
                    
                    <button onclick="descartarESairBingo()" style="padding: 15px 30px; background: linear-gradient(135deg, #dc2626, #b91c1c); border: none; border-radius: 12px; color: white; font-size: 1.1rem; cursor: pointer; font-weight: bold;">
                        üóëÔ∏è Descartar e Sair
                        <div style="font-size: 0.8rem; font-weight: normal; opacity: 0.9;">Perder todo o progresso</div>
                    </button>
                    
                    <button onclick="fecharPopupExitBingo()" style="padding: 12px 30px; background: #6b7280; border: none; border-radius: 12px; color: white; font-size: 1rem; cursor: pointer; margin-top: 10px;">
                        ‚Üê Continuar Jogando
                    </button>
                </div>
            </div>
        `;
        
        document.body.appendChild(popup);
    } else {
        // Sem bingos - confirmar sa√≠da simples
        if (confirm('Tem certeza que deseja sair? O progresso do sorteio ser√° perdido.')) {
            showMenu();
        }
    }
}

function fecharPopupExitBingo() {
    const popup = document.getElementById('exitBingoPopup');
    if (popup) popup.remove();
}

function salvarESairBingo() {
    // Os pontos j√° foram adicionados ao placar geral quando cada bingo foi registrado
    // Apenas fechar e sair
    fecharPopupExitBingo();
    
    // Mostrar resumo
    const totalBingos = Object.values(bingoState.bingosPerTeam).reduce((a, b) => a + b, 0);
    Utils.showFeedback('correct', '‚úÖ', `${totalBingos} bingo(s) salvos no Placar Geral!`, 2000);
    
    setTimeout(() => {
        showMenu();
    }, 500);
}

function descartarESairBingo() {
    if (confirm('‚ö†Ô∏è ATEN√á√ÉO: Isso vai REMOVER os pontos de bingo do Placar Geral. Continuar?')) {
        // Remover os pontos que foram adicionados
        globalTeams.forEach((team, i) => {
            const bingos = bingoState.bingosPerTeam[i] || 0;
            if (bingos > 0 && window.placarGeral[team.name]) {
                window.placarGeral[team.name].pontos -= (bingos * 5); // Cada bingo = 5 pontos
                if (window.placarGeral[team.name].pontos <= 0) {
                    delete window.placarGeral[team.name];
                }
            }
        });
        salvarPlacarGeral();
        
        fecharPopupExitBingo();
        showMenu();
    }
}

function generateBingoCards() {
    // Mostrar popup para escolher quantidade de cartelas
    const popup = document.createElement('div');
    popup.id = 'bingoCardsPopup';
    popup.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.9);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 99999;
    `;
    
    popup.innerHTML = `
        <div style="background: linear-gradient(135deg, #1a1a4e, #2a2a6e); border: 4px solid var(--accent-cyan); border-radius: 30px; padding: 40px; text-align: center; max-width: 450px;">
            <div style="font-size: 4rem; margin-bottom: 15px;">üé¥</div>
            <div style="font-size: 1.8rem; font-weight: bold; color: var(--accent-cyan); margin-bottom: 20px;">Gerar Cartelas</div>
            
            <div style="color: var(--text-secondary); margin-bottom: 25px; font-size: 0.95rem; line-height: 1.5;">
                Com 64 itens b√≠blicos, podemos gerar at√© <strong style="color: var(--accent-gold);">100+ cartelas √∫nicas</strong> sem repeti√ß√£o!
            </div>
            
            <div style="margin-bottom: 25px;">
                <label style="color: var(--text-primary); display: block; margin-bottom: 10px; font-size: 1.1rem;">
                    Quantas cartelas deseja gerar?
                </label>
                <input type="number" id="numCartelas" min="1" max="100" value="10" 
                    style="width: 120px; padding: 12px 15px; font-size: 1.3rem; text-align: center; border-radius: 10px; border: 2px solid var(--accent-cyan); background: rgba(255,255,255,0.1); color: white;">
            </div>
            
            <div style="display: flex; gap: 15px; justify-content: center;">
                <button onclick="closeBingoCardsPopup()" style="padding: 12px 25px; background: #6b7280; border: none; border-radius: 10px; color: white; cursor: pointer; font-size: 1rem;">
                    ‚ùå Cancelar
                </button>
                <button onclick="executeBingoCardsGeneration()" style="padding: 12px 25px; background: linear-gradient(135deg, #16a34a, #15803d); border: none; border-radius: 10px; color: white; cursor: pointer; font-size: 1rem; font-weight: bold;">
                    ‚úÖ Gerar Cartelas
                </button>
            </div>
        </div>
    `;
    
    document.body.appendChild(popup);
}

function closeBingoCardsPopup() {
    const popup = document.getElementById('bingoCardsPopup');
    if (popup) popup.remove();
}

function executeBingoCardsGeneration() {
    const numCartelas = parseInt(document.getElementById('numCartelas').value) || 10;
    
    if (numCartelas < 1 || numCartelas > 100) {
        alert('Por favor, escolha um n√∫mero entre 1 e 100.');
        return;
    }
    
    closeBingoCardsPopup();
    
    // Gerar cartelas √∫nicas usando um Set para garantir que n√£o haja repeti√ß√£o
    const generatedCards = [];
    const usedCombinations = new Set();
    
    while (generatedCards.length < numCartelas) {
        const shuffled = Utils.shuffle([...bingoItems]).slice(0, 24);
        // Criar uma chave √∫nica baseada nos IDs dos itens (ordenados)
        const key = shuffled.map(item => item.id).sort((a,b) => a-b).join(',');
        
        if (!usedCombinations.has(key)) {
            usedCombinations.add(key);
            generatedCards.push(shuffled);
        }
    }
    
    let cardsHTML = `
        <!DOCTYPE html>
        <html>
        <head>
            <title>Cartelas Bingo B√≠blico - IDAC</title>
            <meta charset="UTF-8">
            <style>
                @page { size: A4; margin: 8mm; }
                body { font-family: Arial, sans-serif; margin: 0; padding: 10px; background: #f0f0f0; }
                .cards-container {
                    display: flex;
                    flex-wrap: wrap;
                    gap: 10mm;
                    justify-content: center;
                }
                .card { 
                    width: 90mm; 
                    border: 3px solid #1a1a4a; 
                    border-radius: 10px; 
                    padding: 8px; 
                    page-break-inside: avoid;
                    background: linear-gradient(135deg, #f8f9fa, #e9ecef);
                }
                .card-header {
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    gap: 8px;
                    margin-bottom: 8px;
                    padding-bottom: 5px;
                    border-bottom: 2px solid #1a1a4a;
                }
                .card-logo {
                    width: 35px;
                    height: 35px;
                    object-fit: contain;
                }
                .card-title { 
                    font-size: 14px; 
                    font-weight: bold; 
                    color: #1a1a4a;
                }
                .card-number {
                    font-size: 11px;
                    color: #666;
                }
                .grid { 
                    display: grid; 
                    grid-template-columns: repeat(5, 1fr); 
                    gap: 3px; 
                }
                .cell { 
                    border: 1.5px solid #1a1a4a; 
                    border-radius: 5px;
                    padding: 4px 2px; 
                    text-align: center; 
                    min-height: 45px;
                    display: flex;
                    flex-direction: column;
                    justify-content: center;
                    align-items: center;
                    background: white;
                }
                .cell-emoji { font-size: 20px; line-height: 1; }
                .cell-name { font-size: 7px; margin-top: 2px; color: #333; line-height: 1.1; }
                .center-cell { 
                    background: linear-gradient(135deg, #ffd700, #ffed4e); 
                    border: 2px solid #b8860b;
                }
                .center-cell img {
                    width: 38px;
                    height: 38px;
                    object-fit: contain;
                }
                .header-bar {
                    position: sticky;
                    top: 0;
                    z-index: 100;
                    text-align: center; 
                    margin-bottom: 20px; 
                    padding: 15px; 
                    background: #1a1a4a; 
                    color: white; 
                    border-radius: 10px;
                    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
                }
                .header-bar h2 { margin: 0 0 10px 0; }
                .header-bar p { margin: 0 0 15px 0; }
                .btn {
                    padding: 15px 30px; 
                    font-size: 16px; 
                    cursor: pointer; 
                    border: none; 
                    border-radius: 10px; 
                    font-weight: bold;
                    margin: 5px;
                }
                .btn-print { background: #ffd700; color: #1a1a4a; }
                .btn-close { background: #dc2626; color: white; }
                .btn:hover { opacity: 0.9; transform: scale(1.02); }
                @media print {
                    .no-print { display: none !important; }
                    body { margin: 0; padding: 5mm; background: white; }
                    .header-bar { position: static; }
                }
            </style>
        </head>
        <body>
            <div class="header-bar no-print">
                <h2>üìñ Bingo B√≠blico - IDAC</h2>
                <p>${numCartelas} cartela(s) gerada(s) com sucesso!</p>
                <button class="btn btn-print" onclick="window.print()">üñ®Ô∏è Imprimir Cartelas</button>
                <button class="btn btn-close" onclick="window.close()">‚úñÔ∏è Fechar Janela</button>
            </div>
            <div class="cards-container">
    `;
    
    const bingoImageUrl = 'https://raw.githubusercontent.com/vanjivaldos-cmyk/games-idac/main/images/BingoBiblico.png';
    
    for (let c = 0; c < numCartelas; c++) {
        const cardItems = [...generatedCards[c]];
        // Inserir c√©lula central (posi√ß√£o 12 em grid 5x5)
        cardItems.splice(12, 0, { type: 'center' });
        
        cardsHTML += `
            <div class="card">
                <div class="card-header">
                    <span class="card-title">üìñ Bingo B√≠blico</span>
                    <span class="card-number">Cartela ${c + 1}</span>
                </div>
                <div class="grid">
                    ${cardItems.map((item, i) => {
                        if (item.type === 'center') {
                            return `
                                <div class="cell center-cell">
                                    <img src="${bingoImageUrl}" alt="Bingo B√≠blico">
                                </div>
                            `;
                        }
                        return `
                            <div class="cell">
                                <span class="cell-emoji">${item.emoji}</span>
                                <span class="cell-name">${item.name}</span>
                            </div>
                        `;
                    }).join('')}
                </div>
            </div>
        `;
    }
    
    cardsHTML += '</div></body></html>';
    
    // Abrir em uma janela popup independente
    const win = window.open('', 'CartalasBingo', 'width=900,height=700,scrollbars=yes,resizable=yes');
    if (win) {
        win.document.write(cardsHTML);
        win.document.close();
        win.focus();
    } else {
        // Se popup foi bloqueado, abrir em nova aba
        const win2 = window.open('', '_blank');
        if (win2) {
            win2.document.write(cardsHTML);
            win2.document.close();
        } else {
            alert('Por favor, permita pop-ups para este site e tente novamente.');
        }
    }
}
// ========== PASSA OU REPASSA ==========

const passaQuestions = [
    { q: "Quantos dias Deus levou para criar o mundo?", a: "6 dias (descansou no 7¬∫)", difficulty: 1 },
    { q: "Qual foi o primeiro milagre de Jesus?", a: "Transformar √°gua em vinho", difficulty: 1 },
    { q: "Quem foi jogado na cova dos le√µes?", a: "Daniel", difficulty: 1 },
    { q: "Quantos disc√≠pulos Jesus tinha?", a: "12", difficulty: 1 },
    { q: "Quem construiu a arca?", a: "No√©", difficulty: 1 },
    { q: "Qual o menor livro da B√≠blia?", a: "2 Jo√£o ou 3 Jo√£o", difficulty: 2 },
    { q: "Quantos livros tem a B√≠blia?", a: "66", difficulty: 2 },
    { q: "Quem escreveu a maior parte das cartas do Novo Testamento?", a: "Paulo", difficulty: 2 },
    { q: "Qual a montanha onde Mois√©s recebeu os 10 mandamentos?", a: "Monte Sinai", difficulty: 2 },
    { q: "Quem foi o homem mais velho da B√≠blia?", a: "Matusal√©m (969 anos)", difficulty: 2 },
    { q: "Qual era a profiss√£o de Paulo antes de ser ap√≥stolo?", a: "Fabricante de tendas", difficulty: 3 },
    { q: "Quantas pragas Deus enviou ao Egito?", a: "10", difficulty: 2 },
    { q: "Quem foi o primeiro rei de Israel?", a: "Saul", difficulty: 2 },
    { q: "Qual profeta foi arrebatado ao c√©u em um carro de fogo?", a: "Elias", difficulty: 2 },
    { q: "Quantos anos o povo de Israel ficou no deserto?", a: "40 anos", difficulty: 2 },
    { q: "Quem negou Jesus tr√™s vezes?", a: "Pedro", difficulty: 1 },
    { q: "Qual o maior livro da B√≠blia?", a: "Salmos", difficulty: 2 },
    { q: "Quantos filhos teve Jac√≥?", a: "12 filhos", difficulty: 2 },
    { q: "Quem interpretou os sonhos do Fara√≥?", a: "Jos√©", difficulty: 2 },
    { q: "Qual era o nome do gigante que Davi derrotou?", a: "Golias", difficulty: 1 },
    { q: "Em qual cidade Jesus nasceu?", a: "Bel√©m", difficulty: 1 },
    { q: "Qual o nome da m√£e de Jesus?", a: "Maria", difficulty: 1 },
    { q: "Quem batizou Jesus?", a: "Jo√£o Batista", difficulty: 1 },
    { q: "Quantos dias Jesus jejuou no deserto?", a: "40 dias", difficulty: 2 },
    { q: "Qual disc√≠pulo traiu Jesus?", a: "Judas Iscariotes", difficulty: 1 },
    { q: "Em qual cidade Paulo se converteu?", a: "Damasco", difficulty: 3 },
    { q: "Quantos p√£es e peixes Jesus multiplicou?", a: "5 p√£es e 2 peixes", difficulty: 2 },
    { q: "Qual o significado do nome Emanuel?", a: "Deus conosco", difficulty: 2 },
    { q: "Quem era o pai de Salom√£o?", a: "Davi", difficulty: 2 },
    { q: "Qual era o problema de Bartimeu que Jesus curou?", a: "Cegueira", difficulty: 2 },
    { q: "Quantos anos Jesus tinha quando foi ao templo discutir com os doutores?", a: "12 anos", difficulty: 3 },
    { q: "Qual profeta foi engolido por um grande peixe?", a: "Jonas", difficulty: 1 },
    { q: "Quem foi o sucessor de Mois√©s?", a: "Josu√©", difficulty: 2 },
    { q: "Quem era Barnab√©?", a: "Companheiro de viagem de Paulo", difficulty: 3 },
    { q: "Qual era a doen√ßa de Naam√£?", a: "Lepra", difficulty: 3 },
    { q: "Quem foi o profeta que ungiu Davi como rei?", a: "Samuel", difficulty: 2 },
    { q: "Qual era a arma que Davi usou para derrotar Golias?", a: "Funda (estilingue) e pedra", difficulty: 1 },
    { q: "Como se chamava a esposa de Abra√£o?", a: "Sara", difficulty: 1 },
    { q: "Quem era L√°zaro?", a: "Amigo de Jesus que foi ressuscitado", difficulty: 2 },
    { q: "Qual livro da B√≠blia vem depois de G√™nesis?", a: "√äxodo", difficulty: 1 },
    { q: "Qual era o nome do irm√£o mais velho de Mois√©s?", a: "Ar√£o", difficulty: 2 },
    { q: "Quantos livros tem o Antigo Testamento?", a: "39", difficulty: 2 },
    { q: "Qual o nome da montanha onde Jesus foi crucificado?", a: "Calv√°rio (G√≥lgota)", difficulty: 2 },
    { q: "Quem foi o profeta que desafiou os 450 profetas de Baal?", a: "Elias", difficulty: 2 },
    { q: "Qual era o nome do pai de Jo√£o Batista?", a: "Zacarias", difficulty: 3 },
    { q: "Quantos anos Abra√£o tinha quando Isaque nasceu?", a: "100 anos", difficulty: 3 },
    { q: "Qual era o nome do sogro de Mois√©s?", a: "Jetro", difficulty: 3 },
    { q: "Em qual ilha Jo√£o escreveu o Apocalipse?", a: "Patmos", difficulty: 3 },
    { q: "Quem era o pai de No√©?", a: "Lameque", difficulty: 3 },
    { q: "Qual o √∫ltimo livro do Antigo Testamento?", a: "Malaquias", difficulty: 2 },
    { q: "Qual disc√≠pulo andou sobre as √°guas com Jesus?", a: "Pedro", difficulty: 1 },
    { q: "Qual era a profiss√£o de Zaqueu?", a: "Publicano (cobrador de impostos)", difficulty: 2 },
    { q: "Quantos corvos alimentaram Elias?", a: "A B√≠blia n√£o especifica o n√∫mero", difficulty: 3 },
    { q: "Qual era o nome da m√£e de Mois√©s?", a: "Joquebede", difficulty: 3 }
];

let passaState = {
    config: { totalQuestions: 10 },
    current: { question: 1, scores: [], usedQuestions: [], currentQuestion: null, turn: 0, passed: false, repassed: false }
};

function loadPassaGame() {
    renderPassaSetup();
}

function renderPassaSetup() {
    document.getElementById('gameContainer').innerHTML = `
        <div class="game-screen active">
            <div class="game-content">
                <div class="setup-container">
                    <h2 class="setup-title">‚ùì Passa ou Repassa</h2>
                    
                    <div class="form-group">
                        <label class="form-label">Equipes (configuradas no menu)</label>
                        <div style="background: rgba(0,212,255,0.1); border: 1px solid var(--accent-cyan); border-radius: 10px; padding: 15px;">
                            ${globalTeams.map((t, i) => '<div style="padding: 5px 0;">‚Ä¢ ' + t.name + (t.leader ? ' (' + t.leader + ')' : '') + '</div>').join('')}
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">N√∫mero de Perguntas</label>
                        <div class="option-group">
                            <div class="option-item ${passaState.config.totalQuestions === 5 ? 'selected' : ''}" onclick="selectPassaQuestions(this, 5)">
                                <span class="option-radio"></span>
                                <span>5 perguntas</span>
                            </div>
                            <div class="option-item ${passaState.config.totalQuestions === 10 ? 'selected' : ''}" onclick="selectPassaQuestions(this, 10)">
                                <span class="option-radio"></span>
                                <span>10 perguntas</span>
                            </div>
                            <div class="option-item ${passaState.config.totalQuestions === 15 ? 'selected' : ''}" onclick="selectPassaQuestions(this, 15)">
                                <span class="option-radio"></span>
                                <span>15 perguntas</span>
                            </div>
                        </div>
                    </div>
                    
                    <div style="background: rgba(255, 20, 147, 0.1); border: 2px solid var(--accent-pink); border-radius: 15px; padding: 20px; margin-bottom: 20px;">
                        <h3 style="color: var(--accent-pink); margin-bottom: 10px;">üìã Regras</h3>
                        <p style="color: var(--text-secondary); line-height: 1.6; font-size: 0.9rem;">
                            ‚Ä¢ Equipe 1 recebe a pergunta primeiro<br>
                            ‚Ä¢ Se n√£o souber, pode "PASSAR" para a Equipe 2<br>
                            ‚Ä¢ Se a Equipe 2 n√£o souber, pode "REPASSAR" de volta<br>
                            ‚Ä¢ Quem errar por √∫ltimo paga o "castigo"!
                        </p>
                    </div>
                    
                    <div style="display: flex; gap: 15px;">
                        <button class="btn btn-secondary" onclick="showMenu()" style="flex: 1;">‚Üê Voltar</button>
                        <button class="btn btn-primary" onclick="startPassaGame()" style="flex: 2;">üéÆ Come√ßar!</button>
                    </div>
                </div>
            </div>
        </div>
    `;
}

function selectPassaQuestions(el, value) {
    el.parentElement.querySelectorAll('.option-item').forEach(o => o.classList.remove('selected'));
    el.classList.add('selected');
    passaState.config.totalQuestions = value;
}

function startPassaGame() {
    passaState.current = {
        question: 1,
        scores: globalTeams.map(() => 0),
        usedQuestions: [],
        currentQuestion: null,
        turn: 0,
        passed: false,
        repassed: false
    };
    
    loadPassaQuestion();
}

function loadPassaQuestion() {
    const available = passaQuestions.filter((_, i) => !passaState.current.usedQuestions.includes(i));
    const randomIdx = Math.floor(Math.random() * available.length);
    const qIdx = passaQuestions.indexOf(available[randomIdx]);
    
    passaState.current.usedQuestions.push(qIdx);
    passaState.current.currentQuestion = passaQuestions[qIdx];
    passaState.current.turn = 1;
    passaState.current.passed = false;
    passaState.current.repassed = false;
    
    renderPassaQuestion();
}

function renderPassaQuestion() {
    const q = passaState.current.currentQuestion;
    const currentTeam = globalTeams[passaState.current.turn];
    const currentTeamName = currentTeam ? currentTeam.name : 'Equipe';
    
    document.getElementById('gameContainer').innerHTML = `
        <div class="game-screen active">
            <div class="game-header">
                <button class="btn-back" onclick="confirmPassaExit()">‚Üê Sair</button>
                <div class="game-title-header">‚ùì Passa ou Repassa</div>
                <div class="scoreboard" style="display: flex; gap: 8px; flex-wrap: wrap;">
                    ${globalTeams.map((team, i) => `
                        <div class="team-score" style="background: ${teamColors[team.colorIndex].color.includes('gradient') ? teamColors[team.colorIndex].color : teamColors[team.colorIndex].color}; min-width: 70px; padding: 6px 10px; border-radius: 8px; text-align: center; ${passaState.current.turn === i ? 'box-shadow: 0 0 15px white;' : ''}">
                            <div style="font-size: 0.65rem;">${getShortName(team)}</div>
                            <div style="font-size: 0.5rem; opacity: 0.7;">${team.leader || ''}</div>
                            <div style="font-size: 1.1rem; font-weight: bold;">${passaState.current.scores[i] || 0}</div>
                        </div>
                    `).join('')}
                </div>
            </div>
            
            <div class="game-content">
                <!-- PAINEL ADMIN -->
                <div class="admin-controls admin-only" style="margin-bottom: 20px;">
                    <h4>üë®‚Äçüíº PAINEL DO ADMINISTRADOR</h4>
                    <div class="admin-answer">
                        ‚úÖ Resposta: <strong>${q.a}</strong>
                    </div>
                </div>
                
                <div style="color: var(--text-secondary); margin-bottom: 15px;">
                    Pergunta ${passaState.current.question} de ${passaState.config.totalQuestions}
                </div>
                
                <div style="background: var(--accent-cyan); color: var(--bg-primary); padding: 12px 35px; border-radius: 30px; font-weight: 700; margin-bottom: 20px;">
                    üéØ Vez de: ${currentTeamName}
                </div>
                
                <div style="background: var(--card-bg); border: 3px solid var(--card-border); border-radius: 25px; padding: 40px 50px; max-width: 800px; text-align: center; margin-bottom: 20px;">
                    <div style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 15px;">
                        ${'‚≠ê'.repeat(q.difficulty)} Dificuldade ${q.difficulty}/3
                    </div>
                    <div style="font-size: 1.8rem; line-height: 1.5;">
                        ${q.q}
                    </div>
                </div>
                
                <div style="display: none; background: rgba(0, 255, 136, 0.1); border: 2px solid var(--accent-green); border-radius: 20px; padding: 20px 40px; margin-bottom: 20px;" id="passaAnswer">
                    <div style="color: var(--accent-green); font-size: 0.9rem; margin-bottom: 8px;">Resposta:</div>
                    <div style="font-size: 1.5rem; font-weight: 700;">${q.a}</div>
                </div>
                
                <div style="display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; margin-bottom: 15px;" id="passaButtons">
                    ${globalTeams.map((team, i) => `
                        <button class="btn" onclick="passaTeamCorrect(${i})" style="background: ${teamColors[team.colorIndex].color.includes('gradient') ? teamColors[team.colorIndex].color : teamColors[team.colorIndex].color}; padding: 10px 15px;">
                            ‚úÖ ${getShortName(team)}
                        </button>
                    `).join('')}
                </div>
                <div style="display: flex; gap: 15px; justify-content: center;">
                    <button class="btn btn-secondary" onclick="passaNextTeam()">‚û°Ô∏è Pr√≥xima Equipe</button>
                    <button class="btn btn-danger" onclick="passaShowAnswer()">üëÅÔ∏è Revelar Resposta</button>
                </div>
                
                <div style="display: none; gap: 20px; justify-content: center; margin-top: 20px;" id="passaNext">
                    <button class="btn btn-info" onclick="passaNextQuestion()">‚û°Ô∏è Pr√≥xima Pergunta</button>
                </div>
            </div>
        </div>
    `;
    window.syncToProjection && window.syncToProjection(200);
}

function passaNextTeam() {
    passaState.current.turn = (passaState.current.turn + 1) % globalTeams.length;
    Utils.showFeedback('wrong', '‚û°Ô∏è', 'Pr√≥xima equipe!', 800);
    setTimeout(renderPassaQuestion, 800);
}

function passaTeamCorrect(teamIndex) {
    passaState.current.scores[teamIndex]++;
    
    // Atualizar placar visualmente imediatamente
    updatePassaScoreboard();
    
    Utils.showFeedback('correct', 'üéâ', globalTeams[teamIndex].name + ' Acertou!');
    Utils.createConfetti(30);
    
    document.getElementById('passaAnswer').style.display = 'block';
    document.getElementById('passaButtons').style.display = 'none';
    document.getElementById('passaNext').style.display = 'flex';
    
    // Sincronizar com proje√ß√£o
    if (window.currentMode === 'admin') {
        window.adminSendCommand('showFeedback', { type: 'correct', emoji: 'üéâ', text: globalTeams[teamIndex].name + ' Acertou!' });
        window.adminSendCommand('confetti', { amount: 30 });
        setTimeout(() => {
            window.adminSendCommand('syncHTML', { html: document.getElementById('gameContainer').innerHTML });
        }, 500);
    }
}

function updatePassaScoreboard() {
    const scoreElements = document.querySelectorAll('.scoreboard .team-score');
    scoreElements.forEach((el, i) => {
        const pointsEl = el.querySelector('div:nth-child(2)');
        if (pointsEl && passaState.current.scores[i] !== undefined) {
            pointsEl.textContent = passaState.current.scores[i];
        }
    });
}

function passaShowAnswer() {
    document.getElementById('passaAnswer').style.display = 'block';
    document.getElementById('passaButtons').style.display = 'none';
    document.getElementById('passaNext').style.display = 'flex';
}

function passaWrong() {
    const losingTeam = globalTeams[passaState.current.turn] ? globalTeams[passaState.current.turn].name : 'Equipe';
    
    if (passaState.current.repassed) {
        Utils.showFeedback('wrong', 'ü•ß', `${losingTeam} paga castigo!`, 2000);
    } else {
        Utils.showFeedback('wrong', '‚ùå', 'Errou!');
    }
    
    document.getElementById('passaAnswer').style.display = 'block';
    document.getElementById('passaButtons').style.display = 'none';
    document.getElementById('passaNext').style.display = 'flex';
}

function passaNextQuestion() {
    if (passaState.current.question >= passaState.config.totalQuestions) {
        passaEndGame();
    } else {
        passaState.current.question++;
        loadPassaQuestion();
    }
}

function passaEndGame() {
    const maxScore = Math.max(...passaState.current.scores);
    const winners = globalTeams.filter((t, i) => passaState.current.scores[i] === maxScore);
    const winnerText = winners.length > 1 ? 'Empate!' : winners[0].name;
    
    const ranking = globalTeams.map((t, i) => ({ team: t, score: passaState.current.scores[i] }))
        .sort((a, b) => b.score - a.score);
    
    Utils.createConfetti(100);
    
    document.getElementById('gameContainer').innerHTML = `
        <div class="game-screen active">
            <div class="game-content">
                <div class="end-container">
                    <span class="trophy-icon">üèÜ</span>
                    <h2 class="winner-title">Fim de Jogo!</h2>
                    <p class="winner-name">${winnerText}</p>
                    
                    <div class="final-scores" style="display: flex; flex-wrap: wrap; gap: 15px; justify-content: center;">
                        ${ranking.map((r, i) => `
                            <div class="final-score-item" style="background: ${teamColors[r.team.colorIndex].color}; padding: 15px 20px; border-radius: 15px; min-width: 100px; text-align: center;">
                                <div style="font-size: 1.5rem;">${i === 0 ? 'ü•á' : i === 1 ? 'ü•à' : i === 2 ? 'ü•â' : 'üèÖ'}</div>
                                <div style="font-size: 0.85rem;">${r.team.name}</div>
                                <div style="font-size: 0.7rem; opacity: 0.8;">${r.team.leader || ''}</div>
                                <div style="font-size: 1.5rem; font-weight: bold;">${r.score}</div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div style="display: flex; gap: 20px; justify-content: center;">
                        <button class="btn btn-secondary" onclick="showMenu()">üè† Menu</button>
                        <button class="btn btn-primary" onclick="renderPassaSetup()">üîÑ Jogar Novamente</button>
                    </div>
                </div>
            </div>
        </div>
    `;
}

function confirmPassaExit() {
    if (confirm('Tem certeza que deseja sair?')) {
        showMenu();
    }
}
// ========== RODA B√çBLICA ==========

const rodaPhrases = [
    { phrase: "AMAI_VOS UNS AOS OUTROS", hint: "Mandamento de Jesus", category: "Vers√≠culo" },
    { phrase: "NO PRINCIPIO CRIOU DEUS", hint: "Come√ßo de G√™nesis", category: "Vers√≠culo" },
    { phrase: "O SENHOR E MEU PASTOR", hint: "Salmo 23", category: "Vers√≠culo" },
    { phrase: "EU SOU O CAMINHO", hint: "Jesus disse em Jo√£o 14", category: "Vers√≠culo" },
    { phrase: "PORQUE DEUS AMOU O MUNDO", hint: "Jo√£o 3:16", category: "Vers√≠culo" },
    { phrase: "JARDIM DO EDEN", hint: "Onde Ad√£o e Eva viviam", category: "Lugar" },
    { phrase: "MONTE SINAI", hint: "Onde Mois√©s recebeu a lei", category: "Lugar" },
    { phrase: "BELEM DE JUDA", hint: "Cidade natal de Jesus", category: "Lugar" },
    { phrase: "MAR VERMELHO", hint: "Foi dividido por Mois√©s", category: "Lugar" },
    { phrase: "TORRE DE BABEL", hint: "Onde as l√≠nguas se confundiram", category: "Lugar" },
    { phrase: "NABUCODONOSOR", hint: "Rei da Babil√¥nia", category: "Personagem" },
    { phrase: "MARIA MADALENA", hint: "Primeira a ver Jesus ressuscitado", category: "Personagem" },
    { phrase: "JOAO BATISTA", hint: "Primo de Jesus", category: "Personagem" },
    { phrase: "MATUSALEM", hint: "Homem mais velho da B√≠blia", category: "Personagem" },
    { phrase: "MELQUISEDEQUE", hint: "Rei e sacerdote de Sal√©m", category: "Personagem" },
    { phrase: "ARCA DA ALIANCA", hint: "Guardava as t√°buas da lei", category: "Objeto" },
    { phrase: "TABUAS DA LEI", hint: "Continham os 10 mandamentos", category: "Objeto" },
    { phrase: "SARSA ARDENTE", hint: "Onde Deus falou com Mois√©s", category: "Evento" },
    { phrase: "ULTIMA CEIA", hint: "Refei√ß√£o de despedida", category: "Evento" },
    { phrase: "PENTECOSTES", hint: "Descida do Esp√≠rito Santo", category: "Evento" },
    { phrase: "TUDO POSSO NAQUELE", hint: "Filipenses 4:13", category: "Vers√≠culo" },
    { phrase: "CORDEIRO DE DEUS", hint: "T√≠tulo de Jesus", category: "Nome" },
    { phrase: "REI DOS REIS", hint: "Jesus √© chamado assim", category: "Nome" },
    { phrase: "BOAS NOVAS", hint: "Significado de Evangelho", category: "Conceito" },
    { phrase: "GALATAS EFESIOS", hint: "Duas cartas de Paulo", category: "Livros" },
    { phrase: "JERUSALAM CELESTIAL", hint: "Cidade prometida no c√©u", category: "Lugar" },
    { phrase: "ARMADURA DE DEUS", hint: "Ef√©sios 6 - Prote√ß√£o espiritual", category: "Conceito" },
    { phrase: "FRUTO DO ESPIRITO", hint: "Amor, alegria, paz...", category: "Conceito" },
    { phrase: "CEIA DO SENHOR", hint: "Sacramento institu√≠do por Jesus", category: "Evento" }
];

const rodaVowels = ['A', 'E', 'I', 'O', 'U'];
const rodaConsonants = ['B','C','D','F','G','H','J','K','L','M','N','P','Q','R','S','T','V','W','X','Y','Z'];

let rodaState = {
    config: {},
    current: {
        phrase: null,
        revealed: [],
        scores: [],
        turn: 0,
        roundScore: 0,
        usedLetters: [],
        round: 1,
        totalRounds: 5,
        usedPhrases: [],
        spinValue: 0
    }
};

function loadRodaGame() {
    renderRodaSetup();
}

function renderRodaSetup() {
    document.getElementById('gameContainer').innerHTML = `
        <div class="game-screen active">
            <div class="game-content">
                <div class="setup-container">
                    <h2 class="setup-title">üé° Roda B√≠blica</h2>
                    
                    <div class="form-group">
                        <label class="form-label">Equipes (configuradas no menu)</label>
                        <div style="background: rgba(0,212,255,0.1); border: 1px solid var(--accent-cyan); border-radius: 10px; padding: 15px;">
                            ${globalTeams.map((t, i) => '<div style="padding: 5px 0;">‚Ä¢ ' + t.name + (t.leader ? ' (' + t.leader + ')' : '') + '</div>').join('')}
                        </div>
                    </div>
                    
                    <div style="background: rgba(0, 255, 136, 0.1); border: 2px solid var(--accent-green); border-radius: 15px; padding: 20px; margin-bottom: 20px;">
                        <h3 style="color: var(--accent-green); margin-bottom: 10px;">üìã Como Jogar</h3>
                        <p style="color: var(--text-secondary); line-height: 1.6; font-size: 0.9rem;">
                            ‚Ä¢ Gire a roda para ganhar pontos<br>
                            ‚Ä¢ Escolha uma consoante - se existir, ganha os pontos<br>
                            ‚Ä¢ Pode comprar vogais por 250 pontos<br>
                            ‚Ä¢ Tente resolver a frase para ganhar a rodada!
                        </p>
                    </div>
                    
                    <div style="display: flex; gap: 15px;">
                        <button class="btn btn-secondary" onclick="showMenu()" style="flex: 1;">‚Üê Voltar</button>
                        <button class="btn btn-primary" onclick="startRodaGame()" style="flex: 2;">üé° Girar!</button>
                    </div>
                </div>
            </div>
        </div>
    `;
}

function startRodaGame() {
    // Sincronizar in√≠cio do jogo
    if (window.currentMode === 'admin') {
        window.adminSendCommand('startGame', { game: 'roda' });
    }
    
    rodaState.current = {
        phrase: null,
        revealed: [],
        scores: globalTeams.map(() => 0),
        turn: 0,
        roundScore: 0,
        usedLetters: [],
        round: 1,
        totalRounds: 5,
        usedPhrases: [],
        spinValue: 0
    };
    
    loadRodaRound();
}

function loadRodaRound() {
    const available = rodaPhrases.filter((_, i) => !rodaState.current.usedPhrases.includes(i));
    const idx = Math.floor(Math.random() * available.length);
    const phraseIdx = rodaPhrases.indexOf(available[idx]);
    
    rodaState.current.usedPhrases.push(phraseIdx);
    rodaState.current.phrase = rodaPhrases[phraseIdx];
    rodaState.current.revealed = rodaState.current.phrase.phrase.split('').map(c => c === ' ' || c === '_' ? c : '');
    rodaState.current.usedLetters = [];
    rodaState.current.roundScore = 0;
    rodaState.current.spinValue = 0;
    
    renderRodaGame();
}

function renderRodaGame() {
    const phrase = rodaState.current.phrase;
    const currentTeam = globalTeams[rodaState.current.turn] ? globalTeams[rodaState.current.turn].name : 'Equipe';
    
    // Renderizar frase
    let phraseDisplay = '';
    const chars = phrase.phrase.split('');
    chars.forEach((char, i) => {
        if (char === ' ') {
            phraseDisplay += '<span style="width: 20px; display: inline-block;"></span>';
        } else if (char === '_') {
            phraseDisplay += '<span style="width: 15px; display: inline-block;"></span>';
        } else {
            const revealed = rodaState.current.revealed[i];
            phraseDisplay += `<span style="
                display: inline-flex;
                width: 50px;
                height: 60px;
                background: ${revealed ? 'var(--accent-green)' : 'rgba(255,255,255,0.1)'};
                border-radius: 8px;
                margin: 3px;
                align-items: center;
                justify-content: center;
                font-size: 1.8rem;
                font-weight: bold;
                color: ${revealed ? 'var(--bg-primary)' : 'transparent'};
            ">${revealed || char}</span>`;
        }
    });
    
    // Teclado
    let keyboard = '<div style="margin-bottom: 15px;">';
    rodaConsonants.forEach(letter => {
        const used = rodaState.current.usedLetters.includes(letter);
        keyboard += `<button onclick="rodaSelectLetter('${letter}')" 
            style="width: 45px; height: 45px; margin: 3px; border-radius: 8px; border: none; 
            font-size: 1.2rem; font-weight: bold; cursor: ${used ? 'not-allowed' : 'pointer'};
            background: ${used ? 'rgba(255,255,255,0.1)' : 'var(--accent-cyan)'};
            color: ${used ? 'rgba(255,255,255,0.3)' : 'var(--bg-primary)'};"
            ${used ? 'disabled' : ''}>${letter}</button>`;
    });
    keyboard += '</div><div>';
    rodaVowels.forEach(letter => {
        const used = rodaState.current.usedLetters.includes(letter);
        keyboard += `<button onclick="rodaBuyVowel('${letter}')" 
            style="width: 55px; height: 45px; margin: 3px; border-radius: 8px; border: none; 
            font-size: 1.2rem; font-weight: bold; cursor: ${used ? 'not-allowed' : 'pointer'};
            background: ${used ? 'rgba(255,255,255,0.1)' : 'var(--accent-gold)'};
            color: ${used ? 'rgba(255,255,255,0.3)' : 'var(--bg-primary)'};"
            ${used ? 'disabled' : ''}>${letter}</button>`;
    });
    keyboard += '</div>';
    
    document.getElementById('gameContainer').innerHTML = `
        <div class="game-screen active">
            <div class="game-header">
                <button class="btn-back" onclick="confirmRodaExit()">‚Üê Sair</button>
                <div class="game-title-header">üé° Roda B√≠blica</div>
                <div class="scoreboard" style="display: flex; gap: 8px; flex-wrap: wrap;">
                    ${globalTeams.map((team, i) => `
                        <div class="team-score" style="background: ${teamColors[team.colorIndex].color}; min-width: 70px; padding: 6px 10px; border-radius: 8px; text-align: center; ${rodaState.current.turn === i ? 'box-shadow: 0 0 15px white;' : ''}">
                            <div style="font-size: 0.65rem;">${getShortName(team)}</div>
                            <div style="font-size: 0.5rem; opacity: 0.7;">${team.leader || ''}</div>
                            <div style="font-size: 1.1rem; font-weight: bold;">${rodaState.current.scores[i] || 0}</div>
                        </div>
                    `).join('')}
                </div>
            </div>
            
            <div class="game-content" style="padding: 20px;">
                <!-- PAINEL ADMIN -->
                <div class="admin-controls admin-only" style="margin-bottom: 15px;">
                    <h4>üë®‚Äçüíº PAINEL DO ADMINISTRADOR</h4>
                    <div class="admin-answer">
                        ‚úÖ Frase: <strong>${phrase.phrase.replace(/_/g, ' ')}</strong>
                    </div>
                </div>
                
                <div style="color: var(--text-secondary); margin-bottom: 10px;">
                    Rodada ${rodaState.current.round} de ${rodaState.current.totalRounds} ‚Ä¢ ${phrase.category}
                </div>
                
                <div style="background: var(--accent-cyan); color: var(--bg-primary); padding: 10px 30px; border-radius: 25px; font-weight: 700; margin-bottom: 20px;">
                    üéØ Vez: ${currentTeam} ‚Ä¢ Pontos da rodada: ${rodaState.current.roundScore}
                </div>
                
                <!-- Frase -->
                <div style="background: var(--card-bg); border: 3px solid var(--card-border); border-radius: 20px; padding: 30px; margin-bottom: 20px; text-align: center;">
                    <div style="margin-bottom: 15px; color: var(--text-secondary);">üí° ${phrase.hint}</div>
                    <div style="display: flex; flex-wrap: wrap; justify-content: center; align-items: center;">
                        ${phraseDisplay}
                    </div>
                </div>
                
                <!-- Valor da Roda -->
                <div style="text-align: center; margin-bottom: 20px;">
                    <div style="font-size: 3rem; font-weight: bold; color: var(--accent-gold);" id="rodaSpinValue">
                        ${rodaState.current.spinValue > 0 ? `$${rodaState.current.spinValue}` : 'üé° Gire a Roda!'}
                    </div>
                    <button class="btn btn-primary" onclick="rodaSpin()" style="margin-top: 15px;" id="rodaSpinBtn">
                        üé° Girar Roda
                    </button>
                </div>
                
                <!-- Teclado -->
                <div style="text-align: center; opacity: ${rodaState.current.spinValue > 0 ? '1' : '0.3'}; pointer-events: ${rodaState.current.spinValue > 0 ? 'auto' : 'none'};" id="rodaKeyboard">
                    <div style="color: var(--text-secondary); margin-bottom: 10px;">Consoantes (gr√°tis) | Vogais ($250)</div>
                    ${keyboard}
                </div>
                
                <button class="btn btn-success" onclick="rodaTrySolve()" style="margin-top: 20px;">
                    üéØ Tentar Resolver
                </button>
            </div>
        </div>
    `;
}

function rodaSpin() {
    const values = [100, 150, 200, 250, 300, 350, 400, 450, 500, 550, 600, 700, 800, 900, 1000, 'PERDEU', 'PERDEU'];
    
    // Anima√ß√£o
    let count = 0;
    const interval = setInterval(() => {
        const randomVal = values[Math.floor(Math.random() * values.length)];
        document.getElementById('rodaSpinValue').textContent = randomVal === 'PERDEU' ? 'üíÄ PERDEU A VEZ!' : `$${randomVal}`;
        count++;
        
        if (count >= 20) {
            clearInterval(interval);
            const finalVal = values[Math.floor(Math.random() * values.length)];
            
            if (finalVal === 'PERDEU') {
                document.getElementById('rodaSpinValue').textContent = 'üíÄ PERDEU A VEZ!';
                Utils.showFeedback('wrong', 'üíÄ', 'Perdeu a vez!', 1500);
                rodaState.current.roundScore = 0;
                rodaState.current.turn = (rodaState.current.turn + 1) % globalTeams.length;
                setTimeout(renderRodaGame, 1500);
            } else {
                rodaState.current.spinValue = finalVal;
                document.getElementById('rodaSpinValue').textContent = `$${finalVal}`;
                document.getElementById('rodaSpinBtn').style.display = 'none';
                document.getElementById('rodaKeyboard').style.opacity = '1';
                document.getElementById('rodaKeyboard').style.pointerEvents = 'auto';
            }
        }
    }, 80);
}

function rodaSelectLetter(letter) {
    rodaState.current.usedLetters.push(letter);
    
    const phrase = rodaState.current.phrase.phrase;
    let count = 0;
    
    phrase.split('').forEach((char, i) => {
        if (char.toUpperCase() === letter) {
            rodaState.current.revealed[i] = char;
            count++;
        }
    });
    
    if (count > 0) {
        rodaState.current.roundScore += rodaState.current.spinValue * count;
        Utils.showFeedback('correct', '‚úÖ', `${count}x $${rodaState.current.spinValue}!`, 1000);
    } else {
        Utils.showFeedback('wrong', '‚ùå', 'N√£o tem!', 1000);
        rodaState.current.turn = (rodaState.current.turn + 1) % globalTeams.length;
    }
    
    rodaState.current.spinValue = 0;
    
    // Verificar se completou
    if (!rodaState.current.revealed.includes('')) {
        setTimeout(() => rodaWinRound(), 1000);
    } else {
        setTimeout(renderRodaGame, 1000);
    }
}

function rodaBuyVowel(letter) {
    if (rodaState.current.roundScore < 250) {
        alert('Voc√™ precisa de pelo menos $250 para comprar uma vogal!');
        return;
    }
    
    rodaState.current.roundScore -= 250;
    rodaState.current.usedLetters.push(letter);
    
    const phrase = rodaState.current.phrase.phrase;
    let count = 0;
    
    phrase.split('').forEach((char, i) => {
        if (char.toUpperCase() === letter) {
            rodaState.current.revealed[i] = char;
            count++;
        }
    });
    
    if (count > 0) {
        Utils.showFeedback('correct', '‚úÖ', `${count} vogal(is)!`, 1000);
    } else {
        Utils.showFeedback('wrong', '‚ùå', 'N√£o tem!', 1000);
    }
    
    rodaState.current.spinValue = 0;
    
    if (!rodaState.current.revealed.includes('')) {
        setTimeout(() => rodaWinRound(), 1000);
    } else {
        setTimeout(renderRodaGame, 1000);
    }
}

function rodaTrySolve() {
    const answer = prompt('Digite a frase completa:');
    if (!answer) return;
    
    const correct = answer.toUpperCase().replace(/[^A-Z]/g, '') === 
                   rodaState.current.phrase.phrase.replace(/[^A-Z]/g, '');
    
    if (correct) {
        rodaWinRound();
    } else {
        Utils.showFeedback('wrong', '‚ùå', 'Errado!', 1500);
        rodaState.current.turn = (rodaState.current.turn + 1) % globalTeams.length;
        rodaState.current.spinValue = 0;
        setTimeout(renderRodaGame, 1500);
    }
}

function rodaWinRound() {
    rodaState.current.scores[rodaState.current.turn] += rodaState.current.roundScore;
    
    const teamName = globalTeams[rodaState.current.turn].name;
    Utils.showFeedback('correct', 'üéâ', `${teamName} +$${rodaState.current.roundScore}!`, 2000);
    Utils.createConfetti(40);
    
    setTimeout(() => {
        if (rodaState.current.round >= rodaState.current.totalRounds) {
            rodaEndGame();
        } else {
            rodaState.current.round++;
            loadRodaRound();
        }
    }, 2000);
    
    window.syncToProjection && window.syncToProjection(500);
}

function rodaEndGame() {
    const maxScore = Math.max(...rodaState.current.scores);
    const winners = globalTeams.filter((t, i) => rodaState.current.scores[i] === maxScore);
    const winnerText = winners.length > 1 ? 'Empate!' : winners[0].name;
    
    const ranking = globalTeams.map((t, i) => ({ team: t, score: rodaState.current.scores[i] }))
        .sort((a, b) => b.score - a.score);
    
    Utils.createConfetti(100);
    
    document.getElementById('gameContainer').innerHTML = `
        <div class="game-screen active">
            <div class="game-content">
                <div class="end-container">
                    <span class="trophy-icon">üèÜ</span>
                    <h2 class="winner-title">Fim de Jogo!</h2>
                    <p class="winner-name">${winnerText}</p>
                    
                    <div class="final-scores" style="display: flex; flex-wrap: wrap; gap: 15px; justify-content: center;">
                        ${ranking.map((r, i) => `
                            <div class="final-score-item" style="background: ${teamColors[r.team.colorIndex].color}; padding: 15px 20px; border-radius: 15px; min-width: 100px; text-align: center;">
                                <div style="font-size: 1.5rem;">${i === 0 ? 'ü•á' : i === 1 ? 'ü•à' : i === 2 ? 'ü•â' : 'üèÖ'}</div>
                                <div style="font-size: 0.85rem;">${r.team.name}</div>
                                <div style="font-size: 0.7rem; opacity: 0.8;">${r.team.leader || ''}</div>
                                <div style="font-size: 1.5rem; font-weight: bold;">$${r.score}</div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div style="display: flex; gap: 20px; justify-content: center; margin-top: 30px;">
                        <button class="btn btn-secondary" onclick="showMenu()">üè† Menu</button>
                        <button class="btn btn-primary" onclick="renderRodaSetup()">üîÑ Jogar Novamente</button>
                    </div>
                </div>
            </div>
        </div>
    `;
    
    window.syncToProjection && window.syncToProjection(200);
}

function confirmRodaExit() {
    if (confirm('Sair do jogo?')) showMenu();
}
// ========== SHOW DO MILH√ÉO B√çBLICO ==========

const milhaoQuestions = [
    // N√≠vel 1 - R$ 1.000
    { q: "Qual √© o primeiro livro da B√≠blia?", options: ["√äxodo", "G√™nesis", "Lev√≠tico", "N√∫meros"], correct: 1, level: 1 },
    { q: "Quantos dias Deus descansou ap√≥s a cria√ß√£o?", options: ["1 dia", "2 dias", "3 dias", "7 dias"], correct: 0, level: 1 },
    { q: "Quem construiu a arca?", options: ["Mois√©s", "Abra√£o", "No√©", "Davi"], correct: 2, level: 1 },
    { q: "Qual animal tentou Eva?", options: ["Le√£o", "Serpente", "√Åguia", "Cordeiro"], correct: 1, level: 1 },
    
    // N√≠vel 2 - R$ 5.000
    { q: "Quantos livros tem o Novo Testamento?", options: ["27", "39", "66", "22"], correct: 0, level: 2 },
    { q: "Quem foi o primeiro rei de Israel?", options: ["Davi", "Salom√£o", "Saul", "Samuel"], correct: 2, level: 2 },
    { q: "Qual profeta foi levado ao c√©u num redemoinho?", options: ["Eliseu", "Elias", "Isa√≠as", "Jeremias"], correct: 1, level: 2 },
    { q: "Quantas pragas Deus enviou ao Egito?", options: ["7", "10", "12", "5"], correct: 1, level: 2 },
    
    // N√≠vel 3 - R$ 50.000
    { q: "Qual era a profiss√£o de Paulo antes de ser ap√≥stolo?", options: ["Pescador", "Carpinteiro", "Fabricante de tendas", "Cobrador de impostos"], correct: 2, level: 3 },
    { q: "Quantos anos o povo de Israel peregrinou no deserto?", options: ["20 anos", "40 anos", "70 anos", "100 anos"], correct: 1, level: 3 },
    { q: "Quem interpretou os sonhos do Fara√≥?", options: ["Mois√©s", "Jos√©", "Daniel", "Jac√≥"], correct: 1, level: 3 },
    { q: "Qual √© o maior livro da B√≠blia em n√∫mero de cap√≠tulos?", options: ["Isa√≠as", "G√™nesis", "Salmos", "Jeremias"], correct: 2, level: 3 },
    
    // N√≠vel 4 - R$ 100.000
    { q: "Quantos filhos teve Jac√≥?", options: ["10", "12", "7", "14"], correct: 1, level: 4 },
    { q: "Quem foi o profeta que ungiu Davi como rei?", options: ["Elias", "Eliseu", "Samuel", "Nat√£"], correct: 2, level: 4 },
    { q: "Qual disc√≠pulo era cobrador de impostos?", options: ["Pedro", "Jo√£o", "Mateus", "Tiago"], correct: 2, level: 4 },
    { q: "Em qual monte Mois√©s recebeu os 10 mandamentos?", options: ["Monte Carmelo", "Monte Sinai", "Monte das Oliveiras", "Monte Tabor"], correct: 1, level: 4 },
    
    // N√≠vel 5 - R$ 500.000
    { q: "Quantos anos tinha Matusal√©m quando morreu?", options: ["900", "969", "850", "777"], correct: 1, level: 5 },
    { q: "Qual era o nome da esposa de Mois√©s?", options: ["Rute", "Miri√£", "Z√≠pora", "Raabe"], correct: 2, level: 5 },
    { q: "Quem era o pai de Salom√£o?", options: ["Saul", "Samuel", "Davi", "Absal√£o"], correct: 2, level: 5 },
    { q: "Qual era a doen√ßa de Naam√£ que Eliseu curou?", options: ["Cegueira", "Lepra", "Paralisia", "Mudez"], correct: 1, level: 5 },
    
    // N√≠vel 6 - R$ 1.000.000
    { q: "Qual o significado do nome 'Emanuel'?", options: ["Deus √© grande", "Deus conosco", "Pr√≠ncipe da paz", "Deus salva"], correct: 1, level: 6 },
    { q: "Em qual cidade Paulo teve a vis√£o de Jesus?", options: ["Jerusal√©m", "Damasco", "Tarso", "Antioquia"], correct: 1, level: 6 },
    { q: "Quem era Barnab√© para Paulo?", options: ["Irm√£o", "Companheiro de viagem", "Disc√≠pulo", "Mestre"], correct: 1, level: 6 },
    { q: "Quantos dias Jonas ficou no ventre do peixe?", options: ["1 dia", "3 dias", "7 dias", "40 dias"], correct: 1, level: 6 },
    
    // Perguntas extras por n√≠vel
    { q: "Quem foi vendido pelos irm√£os por 20 moedas de prata?", options: ["Mois√©s", "Jos√©", "Benjamim", "Jac√≥"], correct: 1, level: 1 },
    { q: "Qual era o nome do jardim onde Ad√£o e Eva viviam?", options: ["Gets√™mani", "√âden", "Getsom", "Para√≠so"], correct: 1, level: 1 },
    { q: "Quantos mandamentos Deus deu a Mois√©s?", options: ["5", "10", "12", "7"], correct: 1, level: 1 },
    { q: "Qual instrumento Davi tocava?", options: ["Flauta", "Harpa", "Trombeta", "Tambor"], correct: 1, level: 2 },
    { q: "Qual era o nome do anjo que anunciou o nascimento de Jesus?", options: ["Miguel", "Rafael", "Gabriel", "Uriel"], correct: 2, level: 2 },
    { q: "Quantos anos Jos√© ficou na pris√£o no Egito?", options: ["2 anos", "7 anos", "10 anos", "Mais de 10 anos"], correct: 0, level: 3 },
    { q: "Qual era o nome do monte onde Abra√£o quase sacrificou Isaque?", options: ["Sinai", "Mori√°", "Carmelo", "Tabor"], correct: 1, level: 4 },
    { q: "Quantas vezes Naam√£ mergulhou no rio Jord√£o para ser curado?", options: ["3", "5", "7", "10"], correct: 2, level: 3 },
    { q: "Qual o nome do filho de Abra√£o com a serva Agar?", options: ["Isaque", "Ismael", "Esa√∫", "Jac√≥"], correct: 1, level: 3 }
];

const milhaoLevels = [
    { value: 1000, label: "R$ 1.000", safe: false },
    { value: 5000, label: "R$ 5.000", safe: true },
    { value: 50000, label: "R$ 50.000", safe: false },
    { value: 100000, label: "R$ 100.000", safe: true },
    { value: 500000, label: "R$ 500.000", safe: false },
    { value: 1000000, label: "R$ 1.000.000", safe: true }
];

let milhaoState = {
    currentLevel: 0,
    helps: { cards: true, skip: true, audience: true },
    currentQuestion: null,
    answered: false,
    prize: 0,
    usedQuestions: [],
    // Sistema de equipes
    teamsOrder: [],        // Ordem sorteada das equipes
    currentTeamIndex: 0,   // √çndice da equipe atual
    teamsResults: [],      // Resultado de cada equipe: { teamIndex, prize, won }
    gameStarted: false     // Se j√° come√ßou (ap√≥s sorteio)
};

function loadMilhaoGame() {
    renderMilhaoSetup();
}

function renderMilhaoSetup() {
    // Resetar estado
    milhaoState = {
        currentLevel: 0,
        helps: { cards: true, skip: true, audience: true },
        currentQuestion: null,
        answered: false,
        prize: 0,
        usedQuestions: [],
        teamsOrder: [],
        currentTeamIndex: 0,
        teamsResults: [],
        gameStarted: false
    };
    
    document.getElementById('gameContainer').innerHTML = `
        <div class="game-screen active">
            <div class="game-content">
                <div class="setup-container" style="max-width: 700px;">
                    <h2 class="setup-title">üí∞ Show do Milh√£o B√≠blico</h2>
                    
                    <!-- Equipes Participantes -->
                    <div style="background: rgba(0, 212, 255, 0.1); border: 2px solid var(--accent-cyan); border-radius: 15px; padding: 20px; margin-bottom: 20px;">
                        <h3 style="color: var(--accent-cyan); margin-bottom: 15px;">üë• Equipes Participantes</h3>
                        <div id="milhaoTeamsList" style="display: grid; gap: 10px;">
                            ${globalTeams.map((team, i) => {
                                const color = teamColors[team.colorIndex];
                                return `
                                    <div style="display: flex; align-items: center; gap: 12px; padding: 12px 15px; background: rgba(255,255,255,0.05); border-radius: 10px; border-left: 4px solid ${color.color};">
                                        <div style="width: 35px; height: 35px; border-radius: 50%; background: ${color.color}; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 1.1rem; ${color.textColor ? 'color:' + color.textColor : ''}">${i + 1}</div>
                                        <div>
                                            <div style="font-weight: 600; color: var(--text-primary);">${team.name}</div>
                                            ${team.leader ? `<div style="font-size: 0.85rem; color: var(--text-secondary);">L√≠der: ${team.leader}</div>` : ''}
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                    
                    <!-- √Årea de Sorteio -->
                    <div id="milhaoSorteioArea" style="background: rgba(255, 215, 0, 0.1); border: 2px solid var(--accent-gold); border-radius: 15px; padding: 25px; margin-bottom: 20px; text-align: center;">
                        <h3 style="color: var(--accent-gold); margin-bottom: 15px;">üé≤ Sorteio da Ordem</h3>
                        <p style="color: var(--text-secondary); margin-bottom: 20px;">Clique para sortear qual equipe come√ßa!</p>
                        <button class="btn btn-primary" onclick="milhaoSortearOrdem()" style="font-size: 1.2rem; padding: 15px 40px;">
                            üé≤ Sortear Ordem
                        </button>
                    </div>
                    
                    <!-- Regras Resumidas -->
                    <div style="background: rgba(255, 255, 255, 0.05); border-radius: 15px; padding: 20px; margin-bottom: 20px;">
                        <h3 style="color: var(--text-primary); margin-bottom: 12px;">üìã Como Funciona</h3>
                        <ul style="color: var(--text-secondary); font-size: 0.9rem; line-height: 1.8; padding-left: 20px;">
                            <li>Cada equipe responde at√© <strong style="color: var(--accent-gold);">acertar tudo (1 MILH√ÉO)</strong> ou <strong style="color: #ef4444;">errar</strong></li>
                            <li>Se errar, <strong style="color: #ef4444;">perde tudo</strong> e passa para a pr√≥xima equipe</li>
                            <li>Pontos de parada: <strong style="color: var(--accent-green);">R$ 1.000</strong> e <strong style="color: var(--accent-green);">R$ 50.000</strong></li>
                            <li>3 ajudas por equipe: üÉè Cartas, ‚è≠Ô∏è Pular, üë• Plateia</li>
                        </ul>
                    </div>
                    
                    <div style="display: flex; gap: 15px;">
                        <button class="btn btn-secondary" onclick="showMenu()" style="flex: 1;">‚Üê Voltar</button>
                        <button id="btnIniciarMilhao" class="btn btn-primary" onclick="startMilhaoGame()" style="flex: 2; opacity: 0.5;" disabled>
                            üí∞ Iniciar Jogo
                        </button>
                    </div>
                </div>
            </div>
        </div>
    `;
}

// Fun√ß√£o para sortear a ordem das equipes
function milhaoSortearOrdem() {
    const sorteioArea = document.getElementById('milhaoSorteioArea');
    
    // Criar array com √≠ndices das equipes e embaralhar
    const indices = globalTeams.map((_, i) => i);
    for (let i = indices.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [indices[i], indices[j]] = [indices[j], indices[i]];
    }
    
    milhaoState.teamsOrder = indices;
    milhaoState.teamsResults = indices.map(i => ({ teamIndex: i, prize: 0, won: false, played: false }));
    
    // Anima√ß√£o de sorteio
    let count = 0;
    const maxCount = 15;
    const interval = setInterval(() => {
        count++;
        const randomIdx = indices[Math.floor(Math.random() * indices.length)];
        const team = globalTeams[randomIdx];
        const color = teamColors[team.colorIndex];
        
        sorteioArea.innerHTML = `
            <h3 style="color: var(--accent-gold); margin-bottom: 15px;">üé≤ Sorteando...</h3>
            <div style="font-size: 2rem; padding: 20px; background: ${color.color}; border-radius: 15px; display: inline-block; min-width: 200px; ${color.textColor ? 'color:' + color.textColor : 'color: white'}">
                ${team.name}
            </div>
        `;
        
        if (count >= maxCount) {
            clearInterval(interval);
            
            // Mostrar resultado final
            const primeiraEquipe = globalTeams[indices[0]];
            const primeiraColor = teamColors[primeiraEquipe.colorIndex];
            
            sorteioArea.innerHTML = `
                <h3 style="color: var(--accent-gold); margin-bottom: 15px;">üéâ Ordem Sorteada!</h3>
                <div style="display: flex; flex-direction: column; gap: 8px; margin-bottom: 20px;">
                    ${indices.map((idx, pos) => {
                        const team = globalTeams[idx];
                        const color = teamColors[team.colorIndex];
                        return `
                            <div style="display: flex; align-items: center; gap: 10px; padding: 10px 15px; background: ${pos === 0 ? 'rgba(255, 215, 0, 0.2)' : 'rgba(255,255,255,0.05)'}; border-radius: 8px; ${pos === 0 ? 'border: 2px solid var(--accent-gold);' : ''}">
                                <span style="font-size: 1.2rem; font-weight: bold; color: ${pos === 0 ? 'var(--accent-gold)' : 'var(--text-secondary)'};">${pos + 1}¬∫</span>
                                <div style="width: 25px; height: 25px; border-radius: 50%; background: ${color.color};"></div>
                                <span style="color: var(--text-primary); ${pos === 0 ? 'font-weight: bold;' : ''}">${team.name}</span>
                            </div>
                        `;
                    }).join('')}
                </div>
                <p style="color: var(--accent-gold); font-size: 1.1rem;">
                    üöÄ <strong>${primeiraEquipe.name}</strong> come√ßa!
                </p>
            `;
            
            // Habilitar bot√£o de iniciar
            const btnIniciar = document.getElementById('btnIniciarMilhao');
            btnIniciar.disabled = false;
            btnIniciar.style.opacity = '1';
            
            Utils.createConfetti(30);
        }
    }, 100);
}

function startMilhaoGame() {
    // Verificar se j√° sorteou a ordem
    if (milhaoState.teamsOrder.length === 0) {
        alert('Primeiro sorteie a ordem das equipes!');
        return;
    }
    
    // Resetar para a equipe atual
    milhaoState.currentLevel = 0;
    milhaoState.helps = { cards: true, skip: true, audience: true };
    milhaoState.currentQuestion = null;
    milhaoState.answered = false;
    milhaoState.prize = 0;
    milhaoState.gameStarted = true;
    
    loadMilhaoQuestion();
    
    // Sincronizar com proje√ß√£o
    if (window.currentMode === 'admin') {
        window.adminSendCommand('startGame', { game: 'milhao' });
    }
}

// Fun√ß√£o para iniciar a vez de uma nova equipe
function milhaoStartNextTeam() {
    milhaoState.currentTeamIndex++;
    
    // Verificar se todas as equipes j√° jogaram
    if (milhaoState.currentTeamIndex >= milhaoState.teamsOrder.length) {
        milhaoShowFinalResults();
        return;
    }
    
    // Resetar estado para nova equipe
    milhaoState.currentLevel = 0;
    milhaoState.helps = { cards: true, skip: true, audience: true };
    milhaoState.currentQuestion = null;
    milhaoState.answered = false;
    milhaoState.prize = 0;
    // N√£o resetar usedQuestions para evitar repeti√ß√£o
    
    // Mostrar tela de transi√ß√£o
    milhaoShowTeamTransition();
}

// Tela de transi√ß√£o entre equipes
function milhaoShowTeamTransition() {
    const teamIdx = milhaoState.teamsOrder[milhaoState.currentTeamIndex];
    const team = globalTeams[teamIdx];
    const color = teamColors[team.colorIndex];
    
    document.getElementById('gameContainer').innerHTML = `
        <div class="game-screen active">
            <div class="game-content">
                <div class="end-container" style="text-align: center;">
                    <h2 style="color: var(--accent-gold); font-size: 1.5rem; margin-bottom: 20px;">üéÆ Pr√≥xima Equipe</h2>
                    
                    <div style="background: ${color.color}; padding: 30px 50px; border-radius: 20px; display: inline-block; margin-bottom: 20px; ${color.textColor ? 'color:' + color.textColor : 'color: white'}">
                        <div style="font-size: 2.5rem; font-weight: bold;">${team.name}</div>
                        ${team.leader ? `<div style="font-size: 1.2rem; opacity: 0.9; margin-top: 10px;">L√≠der: ${team.leader}</div>` : ''}
                    </div>
                    
                    <p style="color: var(--text-secondary); margin-bottom: 30px;">Equipe ${milhaoState.currentTeamIndex + 1} de ${milhaoState.teamsOrder.length}</p>
                    
                    <button class="btn btn-primary" onclick="loadMilhaoQuestion()" style="font-size: 1.2rem; padding: 15px 40px;">
                        üí∞ Come√ßar!
                    </button>
                </div>
            </div>
        </div>
    `;
    
    window.syncToProjection && window.syncToProjection(200);
}

// Fun√ß√£o para obter a equipe atual
function milhaoGetCurrentTeam() {
    if (milhaoState.teamsOrder.length === 0) return null;
    const teamIdx = milhaoState.teamsOrder[milhaoState.currentTeamIndex];
    return {
        index: teamIdx,
        team: globalTeams[teamIdx],
        color: teamColors[globalTeams[teamIdx].colorIndex]
    };
}

function loadMilhaoQuestion() {
    const level = milhaoState.currentLevel + 1;
    const available = milhaoQuestions.filter((q, i) => q.level === level && !milhaoState.usedQuestions.includes(i));
    
    if (available.length === 0) {
        alert('Perguntas esgotadas para este n√≠vel!');
        return;
    }
    
    const idx = Math.floor(Math.random() * available.length);
    const qIdx = milhaoQuestions.indexOf(available[idx]);
    
    milhaoState.usedQuestions.push(qIdx);
    milhaoState.currentQuestion = milhaoQuestions[qIdx];
    milhaoState.answered = false;
    
    renderMilhaoQuestion();
}

function renderMilhaoQuestion() {
    const q = milhaoState.currentQuestion;
    const level = milhaoLevels[milhaoState.currentLevel];
    const letters = ['A', 'B', 'C', 'D'];
    const correctLetter = letters[q.correct];
    const correctAnswer = q.options[q.correct];
    
    // Obter equipe atual
    const currentTeam = milhaoGetCurrentTeam();
    const teamColor = currentTeam ? currentTeam.color : { color: 'var(--accent-gold)', textColor: '' };
    const teamName = currentTeam ? currentTeam.team.name : 'Participante';
    const teamLeader = currentTeam ? currentTeam.team.leader : '';
    
    document.getElementById('gameContainer').innerHTML = `
        <div class="game-screen active">
            <div class="game-header">
                <button class="btn-back" onclick="confirmMilhaoExit()">‚Üê Desistir</button>
                <div class="game-title-header">üí∞ Show do Milh√£o</div>
                <div style="text-align: right;">
                    <div style="color: var(--accent-gold); font-size: 1.5rem; font-weight: 700;">${level.label}</div>
                    <div style="color: var(--text-secondary); font-size: 0.85rem;">Pergunta ${milhaoState.currentLevel + 1} de 6</div>
                </div>
            </div>
            
            <!-- Banner da Equipe Atual -->
            <div style="background: ${teamColor.color}; padding: 15px 25px; margin: 0 0 20px 0; border-radius: 15px; display: flex; align-items: center; justify-content: space-between; ${teamColor.textColor ? 'color:' + teamColor.textColor : 'color: white'}">
                <div style="display: flex; align-items: center; gap: 15px;">
                    <span style="font-size: 2rem;">üéØ</span>
                    <div>
                        <div style="font-size: 1.4rem; font-weight: bold;">${teamName}</div>
                        ${teamLeader ? `<div style="font-size: 0.9rem; opacity: 0.9;">L√≠der: ${teamLeader}</div>` : ''}
                    </div>
                </div>
                <div style="text-align: right;">
                    <div style="font-size: 0.85rem; opacity: 0.8;">Valendo</div>
                    <div style="font-size: 1.3rem; font-weight: bold;">${level.label}</div>
                </div>
            </div>
            
            <div class="game-content">
                <!-- PAINEL ADMIN - S√≥ vis√≠vel para Admin -->
                <div class="admin-controls admin-only" style="margin-bottom: 20px;">
                    <h4>üë®‚Äçüíº PAINEL DO ADMINISTRADOR</h4>
                    <div class="admin-answer">
                        ‚úÖ Resposta Correta: <strong>${correctLetter}) ${correctAnswer}</strong>
                    </div>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-top: 10px;">
                        <button class="admin-btn-action" onclick="adminRevealAnswer()">üëÅÔ∏è Revelar Resposta</button>
                        <button class="admin-btn-action" onclick="adminNextQuestion()">‚û°Ô∏è Pr√≥xima Pergunta</button>
                    </div>
                </div>
                
                <!-- Ajudas -->
                <div style="display: flex; gap: 15px; margin-bottom: 30px; flex-wrap: wrap; justify-content: center;">
                    <button class="btn btn-secondary" onclick="milhaoUseCards()" ${!milhaoState.helps.cards ? 'disabled style="opacity: 0.3;"' : ''}>
                        üÉè Cartas ${!milhaoState.helps.cards ? '(usado)' : ''}
                    </button>
                    <button class="btn btn-secondary" onclick="milhaoUseSkip()" ${!milhaoState.helps.skip ? 'disabled style="opacity: 0.3;"' : ''}>
                        ‚è≠Ô∏è Pular ${!milhaoState.helps.skip ? '(usado)' : ''}
                    </button>
                    <button class="btn btn-secondary" onclick="milhaoUseAudience()" ${!milhaoState.helps.audience ? 'disabled style="opacity: 0.3;"' : ''}>
                        üë• Plateia ${!milhaoState.helps.audience ? '(usado)' : ''}
                    </button>
                </div>
                
                <!-- Pergunta -->
                <div style="background: linear-gradient(135deg, #1a1a4e, #2a2a6e); border: 3px solid var(--accent-gold); border-radius: 20px; padding: 40px; max-width: 800px; width: 100%; text-align: center; margin-bottom: 30px;">
                    <div style="font-size: 1.6rem; line-height: 1.5;">${q.q}</div>
                </div>
                
                <!-- Op√ß√µes -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; max-width: 800px; width: 100;">
                    ${q.options.map((opt, i) => `
                        <button onclick="milhaoAnswer(${i})" class="milhao-option" id="milhaoOpt${i}" style="
                            background: linear-gradient(135deg, #2a2a5e, #3a3a7e);
                            border: 2px solid rgba(255, 215, 0, 0.3);
                            border-radius: 15px;
                            padding: 20px 25px;
                            text-align: left;
                            cursor: pointer;
                            transition: all 0.3s;
                            display: flex;
                            align-items: center;
                            gap: 15px;
                        ">
                            <span style="background: var(--accent-gold); color: var(--bg-primary); width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700;">${letters[i]}</span>
                            <span style="font-size: 1.1rem; color: white;">${opt}</span>
                        </button>
                    `).join('')}
                </div>
                
                <!-- Pir√¢mide de pr√™mios + Progresso Equipes -->
                <div style="position: fixed; right: 30px; top: 50%; transform: translateY(-50%); display: flex; flex-direction: column; gap: 15px;">
                    <!-- Pr√™mios -->
                    <div style="background: rgba(0,0,0,0.7); padding: 15px; border-radius: 15px; border: 1px solid var(--accent-gold);">
                        <div style="text-align: center; color: var(--accent-gold); font-weight: bold; margin-bottom: 10px; font-size: 0.85rem;">üí∞ PR√äMIOS</div>
                        ${milhaoLevels.map((l, i) => `
                            <div style="padding: 8px 15px; border-radius: 8px; margin-bottom: 5px; font-size: 0.85rem;
                                background: ${i === milhaoState.currentLevel ? 'var(--accent-gold)' : i < milhaoState.currentLevel ? 'var(--accent-green)' : 'rgba(255,255,255,0.1)'};
                                color: ${i === milhaoState.currentLevel ? 'var(--bg-primary)' : i < milhaoState.currentLevel ? 'var(--bg-primary)' : 'var(--text-secondary)'};
                                font-weight: ${i === milhaoState.currentLevel ? '700' : '400'};
                                ${l.safe ? 'border: 2px solid var(--accent-green);' : ''}">
                                ${l.label} ${l.safe ? '‚úì' : ''}
                            </div>
                        `).reverse().join('')}
                    </div>
                    
                    <!-- Progresso das Equipes -->
                    <div style="background: rgba(0,0,0,0.7); padding: 15px; border-radius: 15px; border: 1px solid var(--accent-cyan);">
                        <div style="text-align: center; color: var(--accent-cyan); font-weight: bold; margin-bottom: 10px; font-size: 0.85rem;">üìä EQUIPES</div>
                        ${milhaoState.teamsOrder.map((tIdx, pos) => {
                            const t = globalTeams[tIdx];
                            const c = teamColors[t.colorIndex];
                            const result = milhaoState.teamsResults[pos];
                            const isCurrentTeam = pos === milhaoState.currentTeamIndex;
                            const played = result.played;
                            return `
                                <div style="display: flex; align-items: center; gap: 8px; padding: 8px 10px; border-radius: 8px; margin-bottom: 4px; 
                                    background: ${isCurrentTeam ? 'rgba(255, 215, 0, 0.3)' : 'rgba(255,255,255,0.05)'}; 
                                    ${isCurrentTeam ? 'border: 2px solid var(--accent-gold);' : ''}">
                                    <div style="width: 20px; height: 20px; border-radius: 50%; background: ${c.color}; flex-shrink: 0;"></div>
                                    <span style="flex: 1; font-size: 0.8rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; color: ${isCurrentTeam ? 'var(--accent-gold)' : 'var(--text-secondary)'};">
                                        ${t.name.replace('Tribo de ', '')}
                                    </span>
                                    <span style="font-size: 0.75rem; color: ${played ? (result.won ? 'var(--accent-green)' : '#ef4444') : 'var(--text-secondary)'};">
                                        ${played ? (result.won ? 'üèÜ1M' : 'R$' + (result.prize/1000) + 'k') : (isCurrentTeam ? 'üéØ' : '‚è≥')}
                                    </span>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>
            </div>
        </div>
    `;
    
    window.syncToProjection && window.syncToProjection(200);
}

// Fun√ß√µes Admin para Show do Milh√£o
function adminRevealAnswer() {
    if (!milhaoState.currentQuestion) return;
    const correct = milhaoState.currentQuestion.correct;
    const btn = document.getElementById(`milhaoOpt${correct}`);
    if (btn) {
        btn.style.background = 'linear-gradient(135deg, #22c55e, #16a34a)';
        btn.style.border = '3px solid #86efac';
        btn.style.transform = 'scale(1.05)';
    }
    // Enviar para proje√ß√£o
    adminSendCommand('revealAnswer', { correct: correct, game: 'milhao' });
}

function adminNextQuestion() {
    if (milhaoState.currentLevel < 5) {
        milhaoState.currentLevel++;
        loadMilhaoQuestion();
    } else {
        milhaoWin();
    }
}

function milhaoAnswer(idx) {
    if (milhaoState.answered) return;
    milhaoState.answered = true;
    
    const correct = milhaoState.currentQuestion.correct;
    const btn = document.getElementById(`milhaoOpt${idx}`);
    const correctBtn = document.getElementById(`milhaoOpt${correct}`);
    
    // Anima√ß√£o de suspense
    btn.style.background = 'linear-gradient(135deg, #f39c12, #e67e22)';
    
    setTimeout(() => {
        if (idx === correct) {
            btn.style.background = 'linear-gradient(135deg, #27ae60, #2ecc71)';
            Utils.showFeedback('correct', 'üéâ', 'Correto!', 2000);
            Utils.createConfetti(30);
            
            milhaoState.prize = milhaoLevels[milhaoState.currentLevel].value;
            
            setTimeout(() => {
                if (milhaoState.currentLevel >= 5) {
                    milhaoWin();
                } else {
                    milhaoState.currentLevel++;
                    loadMilhaoQuestion();
                }
            }, 2500);
        } else {
            btn.style.background = 'linear-gradient(135deg, #c0392b, #e74c3c)';
            correctBtn.style.background = 'linear-gradient(135deg, #27ae60, #2ecc71)';
            Utils.showFeedback('wrong', 'üò¢', 'Errou!', 2000);
            
            // ERROU - perde tudo! (n√£o volta ao ponto seguro)
            milhaoState.prize = 0;
            
            // Registrar resultado da equipe atual
            if (milhaoState.teamsResults[milhaoState.currentTeamIndex]) {
                milhaoState.teamsResults[milhaoState.currentTeamIndex].prize = 0;
                milhaoState.teamsResults[milhaoState.currentTeamIndex].won = false;
                milhaoState.teamsResults[milhaoState.currentTeamIndex].played = true;
            }
            
            setTimeout(() => milhaoTeamLost(), 2500);
        }
    }, 2000);
}

// Quando a equipe erra e perde
function milhaoTeamLost() {
    const currentTeam = milhaoGetCurrentTeam();
    const teamName = currentTeam ? currentTeam.team.name : 'Equipe';
    const teamColor = currentTeam ? currentTeam.color : { color: '#ef4444' };
    const hasMoreTeams = milhaoState.currentTeamIndex < milhaoState.teamsOrder.length - 1;
    
    document.getElementById('gameContainer').innerHTML = `
        <div class="game-screen active">
            <div class="game-content">
                <div class="end-container" style="text-align: center;">
                    <span class="trophy-icon">üò¢</span>
                    <h2 class="winner-title" style="color: #ef4444;">Errou!</h2>
                    
                    <div style="background: ${teamColor.color}; padding: 20px 40px; border-radius: 15px; display: inline-block; margin: 20px 0; ${teamColor.textColor ? 'color:' + teamColor.textColor : 'color: white'}">
                        <div style="font-size: 1.5rem; font-weight: bold;">${teamName}</div>
                    </div>
                    
                    <p style="color: #ef4444; font-size: 1.5rem; font-weight: bold; margin-bottom: 10px;">Perdeu tudo!</p>
                    <p style="color: var(--text-secondary); margin-bottom: 30px;">Pr√™mio final: R$ 0</p>
                    
                    ${hasMoreTeams ? `
                        <button class="btn btn-primary" onclick="milhaoStartNextTeam()" style="font-size: 1.2rem; padding: 15px 40px;">
                            ‚û°Ô∏è Pr√≥xima Equipe
                        </button>
                    ` : `
                        <button class="btn btn-primary" onclick="milhaoShowFinalResults()" style="font-size: 1.2rem; padding: 15px 40px;">
                            üèÜ Ver Resultado Final
                        </button>
                    `}
                </div>
            </div>
        </div>
    `;
    
    window.syncToProjection && window.syncToProjection(200);
}

function milhaoUseCards() {
    if (!milhaoState.helps.cards) return;
    milhaoState.helps.cards = false;
    window.syncToProjection && window.syncToProjection(500);
    
    // Eliminar 2 op√ß√µes erradas
    const correct = milhaoState.currentQuestion.correct;
    const wrongs = [0, 1, 2, 3].filter(i => i !== correct);
    const toHide = wrongs.sort(() => Math.random() - 0.5).slice(0, 2);
    
    toHide.forEach(i => {
        const btn = document.getElementById(`milhaoOpt${i}`);
        btn.style.opacity = '0.2';
        btn.style.pointerEvents = 'none';
    });
    
    Utils.showFeedback('correct', 'üÉè', 'Cartas usadas!', 1000);
}

function milhaoUseSkip() {
    if (!milhaoState.helps.skip) return;
    milhaoState.helps.skip = false;
    window.syncToProjection && window.syncToProjection(500);
    
    Utils.showFeedback('correct', '‚è≠Ô∏è', 'Pulando...', 1000);
    setTimeout(loadMilhaoQuestion, 1000);
}

function milhaoUseAudience() {
    if (!milhaoState.helps.audience) return;
    milhaoState.helps.audience = false;
    window.syncToProjection && window.syncToProjection(500);
    
    const correct = milhaoState.currentQuestion.correct;
    const votes = [0, 0, 0, 0];
    
    // Simular vota√ß√£o (maioria correta)
    votes[correct] = 50 + Math.floor(Math.random() * 30);
    const remaining = 100 - votes[correct];
    const others = [0, 1, 2, 3].filter(i => i !== correct);
    
    others.forEach((i, idx) => {
        if (idx < 2) {
            votes[i] = Math.floor(remaining * (0.1 + Math.random() * 0.2));
        } else {
            votes[i] = remaining - votes[others[0]] - votes[others[1]];
        }
    });
    
    const letters = ['A', 'B', 'C', 'D'];
    alert(`üë• Vota√ß√£o da Plateia:\n\n${letters.map((l, i) => `${l}: ${votes[i]}%`).join('\n')}`);
}

function milhaoWin() {
    Utils.createConfetti(150);
    
    // Registrar vit√≥ria da equipe atual
    if (milhaoState.teamsResults[milhaoState.currentTeamIndex]) {
        milhaoState.teamsResults[milhaoState.currentTeamIndex].prize = 1000000;
        milhaoState.teamsResults[milhaoState.currentTeamIndex].won = true;
        milhaoState.teamsResults[milhaoState.currentTeamIndex].played = true;
    }
    
    const currentTeam = milhaoGetCurrentTeam();
    const teamName = currentTeam ? currentTeam.team.name : 'Equipe';
    const teamColor = currentTeam ? currentTeam.color : { color: 'var(--accent-gold)' };
    const hasMoreTeams = milhaoState.currentTeamIndex < milhaoState.teamsOrder.length - 1;
    
    document.getElementById('gameContainer').innerHTML = `
        <div class="game-screen active">
            <div class="game-content">
                <div class="end-container" style="text-align: center;">
                    <span class="trophy-icon">üèÜ</span>
                    <h2 class="winner-title" style="color: var(--accent-gold);">MILION√ÅRIO!</h2>
                    
                    <div style="background: ${teamColor.color}; padding: 25px 50px; border-radius: 15px; display: inline-block; margin: 20px 0; ${teamColor.textColor ? 'color:' + teamColor.textColor : 'color: white'}">
                        <div style="font-size: 1.8rem; font-weight: bold;">${teamName}</div>
                    </div>
                    
                    <p style="color: var(--accent-gold); font-size: 3rem; font-weight: bold; margin-bottom: 10px;">R$ 1.000.000</p>
                    <p style="color: var(--text-secondary); margin-bottom: 30px;">Acertou todas as perguntas!</p>
                    
                    ${hasMoreTeams ? `
                        <button class="btn btn-primary" onclick="milhaoStartNextTeam()" style="font-size: 1.2rem; padding: 15px 40px;">
                            ‚û°Ô∏è Pr√≥xima Equipe
                        </button>
                    ` : `
                        <button class="btn btn-primary" onclick="milhaoShowFinalResults()" style="font-size: 1.2rem; padding: 15px 40px;">
                            üèÜ Ver Resultado Final
                        </button>
                    `}
                </div>
            </div>
        </div>
    `;
    
    window.syncToProjection && window.syncToProjection(200);
}

function milhaoEnd(won) {
    // Registrar resultado se ainda n√£o foi registrado
    if (milhaoState.teamsResults[milhaoState.currentTeamIndex] && !milhaoState.teamsResults[milhaoState.currentTeamIndex].played) {
        milhaoState.teamsResults[milhaoState.currentTeamIndex].prize = milhaoState.prize;
        milhaoState.teamsResults[milhaoState.currentTeamIndex].won = won;
        milhaoState.teamsResults[milhaoState.currentTeamIndex].played = true;
    }
    
    const currentTeam = milhaoGetCurrentTeam();
    const teamName = currentTeam ? currentTeam.team.name : 'Equipe';
    const hasMoreTeams = milhaoState.currentTeamIndex < milhaoState.teamsOrder.length - 1;
    
    document.getElementById('gameContainer').innerHTML = `
        <div class="game-screen active">
            <div class="game-content">
                <div class="end-container">
                    <span class="trophy-icon">${milhaoState.prize > 0 ? 'üí∞' : 'üò¢'}</span>
                    <h2 class="winner-title">${milhaoState.prize > 0 ? 'Fim de Jogo' : 'Fim de Jogo'}</h2>
                    <p style="color: var(--text-secondary);">${teamName}</p>
                    <p class="winner-name" style="color: var(--accent-gold);">R$ ${milhaoState.prize.toLocaleString()}</p>
                    
                    <div style="display: flex; gap: 20px; justify-content: center; margin-top: 30px;">
                        ${hasMoreTeams ? `
                            <button class="btn btn-primary" onclick="milhaoStartNextTeam()">‚û°Ô∏è Pr√≥xima Equipe</button>
                        ` : `
                            <button class="btn btn-primary" onclick="milhaoShowFinalResults()">üèÜ Ver Resultado Final</button>
                        `}
                    </div>
                </div>
            </div>
        </div>
    `;
    
    window.syncToProjection && window.syncToProjection(200);
}

// Mostrar resultado final de todas as equipes
function milhaoShowFinalResults() {
    Utils.createConfetti(100);
    
    // Ordenar equipes por pr√™mio (maior primeiro)
    const sortedResults = [...milhaoState.teamsResults].sort((a, b) => b.prize - a.prize);
    
    document.getElementById('gameContainer').innerHTML = `
        <div class="game-screen active">
            <div class="game-content">
                <div class="end-container" style="max-width: 700px; text-align: center;">
                    <span class="trophy-icon">üèÜ</span>
                    <h2 class="winner-title" style="color: var(--accent-gold); margin-bottom: 30px;">Resultado Final</h2>
                    
                    <div style="display: flex; flex-direction: column; gap: 12px; margin-bottom: 30px;">
                        ${sortedResults.map((result, pos) => {
                            const team = globalTeams[result.teamIndex];
                            const color = teamColors[team.colorIndex];
                            const isWinner = pos === 0 && result.prize > 0;
                            const medal = pos === 0 ? 'ü•á' : pos === 1 ? 'ü•à' : pos === 2 ? 'ü•â' : `${pos + 1}¬∫`;
                            
                            return `
                                <div style="display: flex; align-items: center; gap: 15px; padding: 15px 20px; 
                                    background: ${isWinner ? 'rgba(255, 215, 0, 0.2)' : 'rgba(255,255,255,0.05)'}; 
                                    border-radius: 15px; 
                                    ${isWinner ? 'border: 3px solid var(--accent-gold);' : 'border: 1px solid rgba(255,255,255,0.1);'}">
                                    <span style="font-size: 1.5rem; min-width: 40px;">${medal}</span>
                                    <div style="width: 40px; height: 40px; border-radius: 50%; background: ${color.color}; flex-shrink: 0;"></div>
                                    <div style="flex: 1; text-align: left;">
                                        <div style="font-weight: bold; font-size: 1.1rem; color: var(--text-primary);">${team.name}</div>
                                        ${team.leader ? `<div style="font-size: 0.85rem; color: var(--text-secondary);">L√≠der: ${team.leader}</div>` : ''}
                                    </div>
                                    <div style="text-align: right;">
                                        <div style="font-weight: bold; font-size: 1.2rem; color: ${result.won ? 'var(--accent-green)' : result.prize > 0 ? 'var(--accent-gold)' : '#ef4444'};">
                                            ${result.won ? 'üèÜ R$ 1.000.000' : 'R$ ' + result.prize.toLocaleString()}
                                        </div>
                                        <div style="font-size: 0.8rem; color: var(--text-secondary);">
                                            ${result.won ? 'MILION√ÅRIO!' : result.prize === 0 ? 'Eliminado' : 'Desistiu'}
                                        </div>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                    
                    <div style="display: flex; gap: 20px; justify-content: center;">
                        <button class="btn btn-secondary" onclick="showMenu()">üè† Menu</button>
                        <button class="btn btn-primary" onclick="loadMilhaoGame()">üîÑ Jogar Novamente</button>
                    </div>
                </div>
            </div>
        </div>
    `;
    
    window.syncToProjection && window.syncToProjection(200);
}

function confirmMilhaoExit() {
    const currentTeam = milhaoGetCurrentTeam();
    const teamName = currentTeam ? currentTeam.team.name : 'Equipe';
    
    if (confirm(`${teamName} deseja desistir e levar R$ ${milhaoState.prize.toLocaleString()}?`)) {
        // Registrar resultado da equipe
        if (milhaoState.teamsResults[milhaoState.currentTeamIndex]) {
            milhaoState.teamsResults[milhaoState.currentTeamIndex].prize = milhaoState.prize;
            milhaoState.teamsResults[milhaoState.currentTeamIndex].won = false;
            milhaoState.teamsResults[milhaoState.currentTeamIndex].played = true;
        }
        
        milhaoTeamGaveUp();
    }
}

// Quando a equipe desiste
function milhaoTeamGaveUp() {
    const currentTeam = milhaoGetCurrentTeam();
    const teamName = currentTeam ? currentTeam.team.name : 'Equipe';
    const teamColor = currentTeam ? currentTeam.color : { color: 'var(--accent-gold)' };
    const hasMoreTeams = milhaoState.currentTeamIndex < milhaoState.teamsOrder.length - 1;
    
    document.getElementById('gameContainer').innerHTML = `
        <div class="game-screen active">
            <div class="game-content">
                <div class="end-container" style="text-align: center;">
                    <span class="trophy-icon">üí∞</span>
                    <h2 class="winner-title" style="color: var(--accent-gold);">Desistiu!</h2>
                    
                    <div style="background: ${teamColor.color}; padding: 20px 40px; border-radius: 15px; display: inline-block; margin: 20px 0; ${teamColor.textColor ? 'color:' + teamColor.textColor : 'color: white'}">
                        <div style="font-size: 1.5rem; font-weight: bold;">${teamName}</div>
                    </div>
                    
                    <p style="color: var(--accent-gold); font-size: 2rem; font-weight: bold; margin-bottom: 10px;">R$ ${milhaoState.prize.toLocaleString()}</p>
                    <p style="color: var(--text-secondary); margin-bottom: 30px;">Preferiu garantir o pr√™mio!</p>
                    
                    ${hasMoreTeams ? `
                        <button class="btn btn-primary" onclick="milhaoStartNextTeam()" style="font-size: 1.2rem; padding: 15px 40px;">
                            ‚û°Ô∏è Pr√≥xima Equipe
                        </button>
                    ` : `
                        <button class="btn btn-primary" onclick="milhaoShowFinalResults()" style="font-size: 1.2rem; padding: 15px 40px;">
                            üèÜ Ver Resultado Final
                        </button>
                    `}
                </div>
            </div>
        </div>
    `;
    
    window.syncToProjection && window.syncToProjection(200);
}
// ========== QUEM SOU EU? B√çBLICO ==========

const quemCharacters = [
    {
        name: "Mois√©s",
        hints: [
            "Fui encontrado em um cesto no rio",
            "Cresci no pal√°cio do Fara√≥",
            "Fugi para o deserto ap√≥s matar um eg√≠pcio",
            "Vi uma sar√ßa que ardia mas n√£o se consumia",
            "Libertei meu povo da escravid√£o no Egito",
            "Dividi as √°guas do Mar Vermelho",
            "Recebi os 10 mandamentos no Monte Sinai"
        ]
    },
    {
        name: "Davi",
        hints: [
            "Era o ca√ßula entre meus irm√£os",
            "Trabalhei como pastor de ovelhas",
            "Fui ungido ainda jovem para ser rei",
            "Derrotei um gigante com uma funda",
            "Fui m√∫sico e compositor de salmos",
            "Meu melhor amigo era filho do rei Saul",
            "Fui o segundo rei de Israel"
        ]
    },
    {
        name: "Jos√© do Egito",
        hints: [
            "Era o filho preferido do meu pai",
            "Ganhei uma t√∫nica colorida de presente",
            "Meus irm√£os me venderam como escravo",
            "Fui para a pris√£o injustamente acusado",
            "Interpretei sonhos de dois servos do rei",
            "Avisei sobre 7 anos de fartura e 7 de fome",
            "Me tornei governador do Egito"
        ]
    },
    {
        name: "Daniel",
        hints: [
            "Fui levado cativo para a Babil√¥nia",
            "Me recusei a comer a comida do rei",
            "Interpretei os sonhos de Nabucodonosor",
            "Vi uma m√£o escrever na parede do pal√°cio",
            "Continuei orando mesmo sendo proibido",
            "Fui jogado numa cova com le√µes",
            "Os le√µes n√£o me fizeram mal"
        ]
    },
    {
        name: "No√©",
        hints: [
            "Vivi numa √©poca de muita maldade",
            "Fui considerado justo diante de Deus",
            "Recebi instru√ß√µes para construir algo grande",
            "Trabalhei por muitos anos em um projeto",
            "Reuni casais de todos os animais",
            "Minha fam√≠lia foi a √∫nica salva do dil√∫vio",
            "Vi o primeiro arco-√≠ris ap√≥s a tempestade"
        ]
    },
    {
        name: "Abra√£o",
        hints: [
            "Meu nome original era Abr√£o",
            "Deus me mandou sair da minha terra natal",
            "Recebi uma promessa de ter muitos descendentes",
            "Minha esposa se chamava Sara",
            "Tive um filho muito esperado na velhice",
            "Deus testou minha f√© pedindo meu filho",
            "Sou conhecido como pai da f√©"
        ]
    },
    {
        name: "Pedro",
        hints: [
            "Meu nome original era Sim√£o",
            "Era pescador antes de conhecer Jesus",
            "Jesus me disse que eu seria pescador de homens",
            "Andei sobre as √°guas por alguns momentos",
            "Cortei a orelha de um soldado no Gets√™mani",
            "Neguei Jesus tr√™s vezes",
            "Recebi as chaves do Reino dos C√©us"
        ]
    },
    {
        name: "Paulo",
        hints: [
            "Meu nome original era Saulo",
            "Nasci em Tarso da Cil√≠cia",
            "Era fariseu e perseguia crist√£os",
            "Fiquei cego no caminho de Damasco",
            "Me converti ap√≥s uma vis√£o de Jesus",
            "Fiz v√°rias viagens mission√°rias",
            "Escrevi muitas cartas do Novo Testamento"
        ]
    },
    {
        name: "Jonas",
        hints: [
            "Deus me mandou pregar em N√≠nive",
            "Tentei fugir da miss√£o em um navio",
            "Uma grande tempestade amea√ßou o navio",
            "Fui lan√ßado ao mar pelos marinheiros",
            "Fui engolido por um grande peixe",
            "Fiquei tr√™s dias no ventre do animal",
            "Finalmente obedeci e preguei em N√≠nive"
        ]
    },
    {
        name: "Sans√£o",
        hints: [
            "Fui consagrado a Deus desde o nascimento",
            "Nunca cortei meu cabelo por voto",
            "Tinha for√ßa extraordin√°ria",
            "Matei um le√£o com as m√£os",
            "Derrotei mil filisteus com uma queixada de jumento",
            "Fui tra√≠do por uma mulher chamada Dalila",
            "Morri derrubando o templo de Dagom"
        ]
    },
    {
        name: "Elias",
        hints: [
            "Fui profeta durante o reinado de Acabe",
            "Anunciei uma seca de tr√™s anos",
            "Fui alimentado por corvos no deserto",
            "Desafiei os profetas de Baal no Monte Carmelo",
            "Fogo do c√©u consumiu meu sacrif√≠cio",
            "Corri mais r√°pido que a carruagem do rei",
            "Fui levado ao c√©u em um carro de fogo"
        ]
    },
    {
        name: "Maria (m√£e de Jesus)",
        hints: [
            "Era uma jovem virgem de Nazar√©",
            "Estava noiva de um carpinteiro",
            "Um anjo me visitou com uma mensagem",
            "Visitei minha prima Elisabete quando gr√°vida",
            "Dei √† luz em Bel√©m de Jud√°",
            "Coloquei meu beb√™ em uma manjedoura",
            "Sou a m√£e do Salvador do mundo"
        ]
    },
    {
        name: "Salom√£o",
        hints: [
            "Meu pai foi um grande rei de Israel",
            "Pedi a Deus sabedoria em vez de riquezas",
            "Me tornei o homem mais s√°bio que j√° existiu",
            "Constru√≠ o primeiro templo de Jerusal√©m",
            "Escrevi prov√©rbios e c√¢nticos",
            "Recebi a visita da rainha de Sab√°",
            "Tive 700 esposas e 300 concubinas"
        ]
    },
    {
        name: "Rute",
        hints: [
            "Nasci em Moabe, terra estrangeira",
            "Me casei com um israelita que morreu",
            "Decidi seguir minha sogra Noemi",
            "Disse: Onde fores, irei eu",
            "Trabalhei colhendo espigas nos campos",
            "Fui remida por um parente de meu marido",
            "Sou bisav√≥ do rei Davi"
        ]
    },
    {
        name: "Ester",
        hints: [
            "Era √≥rf√£ e fui criada por meu primo",
            "Vivia na P√©rsia durante o ex√≠lio",
            "Participei de um concurso de beleza",
            "Me tornei rainha sem revelar minha origem",
            "Um homem queria destruir meu povo",
            "Arrisquei minha vida ao ir ao rei sem ser chamada",
            "Salvei o povo judeu do exterm√≠nio"
        ]
    },
    {
        name: "Gide√£o",
        hints: [
            "Um anjo me encontrou malhando trigo escondido",
            "Pedi sinais a Deus com um velo de l√£",
            "Comecei com 32 mil soldados",
            "Deus reduziu meu ex√©rcito para apenas 300",
            "Usei tochas, c√¢ntaros e trombetas como armas",
            "Derrotei os midianitas com um pequeno grupo",
            "Tamb√©m sou conhecido como Jerubaal"
        ]
    },
    {
        name: "Samuel",
        hints: [
            "Minha m√£e orou muito para me ter",
            "Fui dedicado a Deus desde o nascimento",
            "Cresci no templo com o sacerdote Eli",
            "Deus me chamou quando era crian√ßa",
            "Fui o √∫ltimo dos ju√≠zes de Israel",
            "Ungi o primeiro rei de Israel",
            "Tamb√©m ungi Davi como rei"
        ]
    }
];

let quemState = {
    config: { rounds: 6 },
    teamsOrder: [],      // Ordem sorteada das equipes
    orderDrawn: false,   // Se j√° foi sorteada a ordem
    current: {
        round: 1,
        scores: [],
        character: null,
        hintIndex: 0,
        turnIndex: 0,    // √çndice na ordem sorteada (n√£o o √≠ndice da equipe)
        usedCharacters: []
    }
};

function loadQuemGame() {
    renderQuemSetup();
}

function renderQuemSetup() {
    // Resetar ordem sorteada
    quemState.teamsOrder = [];
    quemState.orderDrawn = false;
    
    document.getElementById('gameContainer').innerHTML = `
        <div class="game-screen active">
            <div class="game-content">
                <div class="setup-container">
                    <h2 class="setup-title">ü§î Quem Sou Eu? B√≠blico</h2>
                    
                    <div class="form-group">
                        <label class="form-label">Equipes (configuradas no menu)</label>
                        <div style="background: rgba(0,212,255,0.1); border: 1px solid var(--accent-cyan); border-radius: 10px; padding: 15px;">
                            ${globalTeams.map((t, i) => '<div style="padding: 5px 0;">‚Ä¢ ' + t.name + (t.leader ? ' (' + t.leader + ')' : '') + '</div>').join('')}
                        </div>
                    </div>
                    
                    <!-- Sorteio de Ordem -->
                    <div style="background: rgba(255, 215, 0, 0.1); border: 2px solid var(--accent-gold); border-radius: 15px; padding: 20px; margin-bottom: 20px;">
                        <h3 style="color: var(--accent-gold); margin-bottom: 15px;">üé≤ Ordem das Equipes</h3>
                        <p style="color: var(--text-secondary); font-size: 0.85rem; margin-bottom: 15px;">
                            Sorteie a ordem para definir quem ter√° direito √†s ${Math.min(7, globalTeams.length)} dicas de cada rodada.
                        </p>
                        <div id="quemOrderContainer" style="min-height: 60px; display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin-bottom: 15px;">
                            <span style="color: var(--text-secondary); font-style: italic;">Clique em "Sortear Ordem" para definir...</span>
                        </div>
                        <button class="btn btn-primary" onclick="quemDrawOrder()" style="width: 100%;">
                            üé≤ Sortear Ordem
                        </button>
                    </div>
                    
                    <div style="background: rgba(157, 78, 221, 0.1); border: 2px solid var(--accent-purple); border-radius: 15px; padding: 20px; margin-bottom: 20px;">
                        <h3 style="color: var(--accent-purple); margin-bottom: 10px;">üìã Como Jogar</h3>
                        <p style="color: var(--text-secondary); line-height: 1.6; font-size: 0.9rem;">
                            ‚Ä¢ Cada rodada tem ${Math.min(7, globalTeams.length)} dicas (uma por equipe na ordem sorteada)<br>
                            ‚Ä¢ Quanto menos dicas usar, mais pontos ganha<br>
                            ‚Ä¢ ${Math.min(7, globalTeams.length)} pontos na 1¬™ dica, ${Math.min(7, globalTeams.length) - 1} na 2¬™... at√© 1 ponto na √∫ltima<br>
                            ‚Ä¢ Se errar, a vez passa para a pr√≥xima equipe da ordem
                        </p>
                    </div>
                    
                    <div style="display: flex; gap: 15px;">
                        <button class="btn btn-secondary" onclick="showMenu()" style="flex: 1;">‚Üê Voltar</button>
                        <button class="btn btn-primary" id="btnStartQuem" onclick="startQuemGame()" style="flex: 2;" disabled>
                            üé≠ Come√ßar!
                        </button>
                    </div>
                </div>
            </div>
        </div>
    `;
}

function quemDrawOrder() {
    // Sortear ordem das equipes
    const indices = globalTeams.map((_, i) => i);
    quemState.teamsOrder = Utils.shuffle(indices);
    quemState.orderDrawn = true;
    
    // Mostrar ordem sorteada com anima√ß√£o
    const container = document.getElementById('quemOrderContainer');
    container.innerHTML = '';
    
    quemState.teamsOrder.forEach((teamIdx, pos) => {
        const team = globalTeams[teamIdx];
        const color = teamColors[team.colorIndex];
        const hasHint = pos < Math.min(7, globalTeams.length);
        
        setTimeout(() => {
            const badge = document.createElement('div');
            badge.style.cssText = `
                background: ${color.color};
                color: ${color.textColor || '#fff'};
                padding: 8px 15px;
                border-radius: 20px;
                font-weight: bold;
                font-size: 0.85rem;
                display: flex;
                align-items: center;
                gap: 8px;
                animation: popIn 0.3s ease;
                ${!hasHint ? 'opacity: 0.5; text-decoration: line-through;' : ''}
            `;
            badge.innerHTML = `
                <span style="background: rgba(0,0,0,0.3); width: 22px; height: 22px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.75rem;">${pos + 1}¬∫</span>
                ${getShortName(team)}
                ${hasHint ? '‚úì' : ''}
            `;
            container.appendChild(badge);
            
            // Se for a √∫ltima equipe, habilitar bot√£o
            if (pos === quemState.teamsOrder.length - 1) {
                document.getElementById('btnStartQuem').disabled = false;
                
                // Mostrar aviso se houver equipes sem dica
                if (globalTeams.length > 7) {
                    const aviso = document.createElement('div');
                    aviso.style.cssText = 'width: 100%; text-align: center; margin-top: 10px; color: var(--accent-gold); font-size: 0.8rem;';
                    aviso.textContent = `‚ö†Ô∏è Apenas as 7 primeiras equipes ter√£o dicas por rodada`;
                    container.appendChild(aviso);
                }
            }
        }, pos * 200);
    });
    
    // Sincronizar com proje√ß√£o
    if (window.currentMode === 'admin') {
        window.syncToProjection && window.syncToProjection(500);
    }
}

function startQuemGame() {
    // Verificar se j√° sorteou a ordem
    if (!quemState.orderDrawn || quemState.teamsOrder.length === 0) {
        alert('Primeiro sorteie a ordem das equipes!');
        return;
    }
    
    // Inicializar scores para todas as equipes
    const initialScores = globalTeams.map(() => 0);
    
    quemState.current = {
        round: 1,
        scores: initialScores,
        character: null,
        hintIndex: 0,
        turnIndex: 0, // √çndice na ordem sorteada
        usedCharacters: []
    };
    
    // Sincronizar in√≠cio com proje√ß√£o
    if (window.currentMode === 'admin') {
        window.adminSendCommand('startGame', { game: 'quem' });
    }
    
    loadQuemRound();
}

function loadQuemRound() {
    const available = quemCharacters.filter((_, i) => !quemState.current.usedCharacters.includes(i));
    const idx = Math.floor(Math.random() * available.length);
    const charIdx = quemCharacters.indexOf(available[idx]);
    
    quemState.current.usedCharacters.push(charIdx);
    quemState.current.character = quemCharacters[charIdx];
    quemState.current.hintIndex = 0;
    quemState.current.turnIndex = 0; // Come√ßa com a primeira equipe da ordem sorteada
    
    renderQuemRound();
    
    // Sincronizar com proje√ß√£o
    window.syncToProjection && window.syncToProjection(200);
}

function renderQuemRound() {
    const char = quemState.current.character;
    
    // Pegar a equipe atual da ordem sorteada
    const currentTeamIdx = quemState.teamsOrder[quemState.current.turnIndex];
    const currentTeam = globalTeams[currentTeamIdx] ? globalTeams[currentTeamIdx].name : 'Equipe';
    
    // N√∫mero de dicas = m√≠nimo entre 7 e n√∫mero de equipes
    const numDicas = Math.min(7, globalTeams.length, char.hints.length);
    const dicasDisponiveis = char.hints.slice(0, numDicas);
    
    // Pontos: come√ßa com numDicas pontos e vai diminuindo
    const points = numDicas - quemState.current.hintIndex;
    
    document.getElementById('gameContainer').innerHTML = `
        <div class="game-screen active">
            <div class="game-header">
                <button class="btn-back" onclick="confirmQuemExit()">‚Üê Sair</button>
                <div class="game-title-header">ü§î Quem Sou Eu?</div>
                <div class="scoreboard" style="display: flex; gap: 8px; flex-wrap: wrap;">
                    ${quemState.teamsOrder.map((teamIdx, orderPos) => {
                        const team = globalTeams[teamIdx];
                        const isCurrentTurn = orderPos === quemState.current.turnIndex;
                        const hasHint = orderPos < numDicas;
                        return `
                            <div class="team-score" style="
                                background: ${teamColors[team.colorIndex].color}; 
                                min-width: 70px; 
                                padding: 6px 10px; 
                                border-radius: 8px; 
                                text-align: center; 
                                ${isCurrentTurn ? 'box-shadow: 0 0 15px white;' : ''}
                                ${!hasHint ? 'opacity: 0.4;' : ''}
                            ">
                                <div style="font-size: 0.55rem; opacity: 0.7;">${orderPos + 1}¬∫</div>
                                <div style="font-size: 0.65rem;">${getShortName(team)}</div>
                                <div style="font-size: 0.5rem; opacity: 0.7;">${team.leader || ''}</div>
                                <div style="font-size: 1.1rem; font-weight: bold;">${quemState.current.scores[teamIdx] || 0}</div>
                            </div>
                        `;
                    }).join('')}
                </div>
            </div>
            
            <div class="game-content">
                <!-- PAINEL ADMIN -->
                <div class="admin-controls admin-only" style="margin-bottom: 15px;">
                    <h4>üë®‚Äçüíº PAINEL DO ADMINISTRADOR</h4>
                    <div class="admin-answer">
                        üé≠ Personagem: <strong>${char.name}</strong>
                    </div>
                </div>
                
                <div style="color: var(--text-secondary); margin-bottom: 15px;">
                    Rodada ${quemState.current.round} de ${quemState.config.rounds}
                </div>
                
                <div style="background: var(--accent-purple); color: white; padding: 12px 30px; border-radius: 25px; font-weight: 700; margin-bottom: 25px;">
                    üéØ Vez: ${currentTeam} (${quemState.current.turnIndex + 1}¬∫) ‚Ä¢ Vale ${points} ponto${points !== 1 ? 's' : ''}!
                </div>
                
                <!-- Dicas -->
                <div style="background: var(--card-bg); border: 3px solid var(--accent-purple); border-radius: 25px; padding: 30px 40px; max-width: 700px; width: 100%; margin-bottom: 25px;">
                    <div style="color: var(--text-secondary); margin-bottom: 20px; font-size: 0.9rem;">
                        Dicas reveladas: ${quemState.current.hintIndex + 1} de ${numDicas}
                    </div>
                    
                    <div style="display: flex; flex-direction: column; gap: 12px;">
                        ${dicasDisponiveis.map((hint, i) => {
                            // Mostrar qual equipe tem direito a essa dica
                            const teamForHint = globalTeams[quemState.teamsOrder[i]];
                            const teamColor = teamColors[teamForHint.colorIndex];
                            return `
                                <div style="
                                    display: flex;
                                    align-items: center;
                                    gap: 15px;
                                    padding: 15px 20px;
                                    background: ${i <= quemState.current.hintIndex ? 'rgba(157, 78, 221, 0.2)' : 'rgba(255,255,255,0.03)'};
                                    border-radius: 12px;
                                    border: 2px solid ${i <= quemState.current.hintIndex ? 'var(--accent-purple)' : 'transparent'};
                                    ${i === quemState.current.turnIndex ? 'box-shadow: 0 0 10px var(--accent-purple);' : ''}
                                ">
                                    <span style="
                                        min-width: 30px;
                                        height: 30px;
                                        background: ${i <= quemState.current.hintIndex ? teamColor.color : 'rgba(255,255,255,0.1)'};
                                        border-radius: 50%;
                                        display: flex;
                                        align-items: center;
                                        justify-content: center;
                                        font-weight: 700;
                                        font-size: 0.9rem;
                                        color: ${teamColor.textColor || '#fff'};
                                    ">${i + 1}</span>
                                    <span style="
                                        font-size: 1.1rem;
                                        color: ${i <= quemState.current.hintIndex ? 'var(--text-primary)' : 'transparent'};
                                        text-shadow: ${i <= quemState.current.hintIndex ? 'none' : '0 0 8px rgba(255,255,255,0.5)'};
                                        flex: 1;
                                    ">${hint}</span>
                                    <span style="font-size: 0.7rem; color: var(--text-secondary); opacity: 0.7;">
                                        ${getShortName(teamForHint)}
                                    </span>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>
                
                <div style="display: flex; gap: 15px; flex-wrap: wrap; justify-content: center;">
                    <button class="btn btn-success" onclick="quemGuess()">üéØ Adivinhar!</button>
                    ${quemState.current.hintIndex < numDicas - 1 ? `
                        <button class="btn btn-secondary" onclick="quemNextHint()">üí° Mais uma dica</button>
                    ` : ''}
                    <button class="btn btn-danger" onclick="quemPass()">‚û°Ô∏è Passar vez</button>
                </div>
            </div>
        </div>
    `;
}

function quemNextHint() {
    const numDicas = Math.min(7, globalTeams.length, quemState.current.character.hints.length);
    
    if (quemState.current.hintIndex < numDicas - 1) {
        quemState.current.hintIndex++;
        // Avan√ßa para a pr√≥xima equipe na ordem sorteada
        quemState.current.turnIndex = quemState.current.hintIndex;
        renderQuemRound();
        
        // Sincronizar com proje√ß√£o
        window.syncToProjection && window.syncToProjection(100);
    }
}

function quemGuess() {
    const answer = prompt('Quem √© o personagem b√≠blico?');
    if (!answer) return;
    
    const correct = answer.toLowerCase().trim() === quemState.current.character.name.toLowerCase();
    
    // Pegar o √≠ndice real da equipe atual
    const currentTeamIdx = quemState.teamsOrder[quemState.current.turnIndex];
    
    if (correct) {
        // Pontos baseados no n√∫mero de dicas dispon√≠veis
        const numDicas = Math.min(7, globalTeams.length, quemState.current.character.hints.length);
        const points = numDicas - quemState.current.hintIndex;
        
        quemState.current.scores[currentTeamIdx] += points;
        
        Utils.showFeedback('correct', 'üéâ', `+${points} pontos!`, 2000);
        Utils.createConfetti(40);
        
        // Enviar feedback para proje√ß√£o
        if (window.currentMode === 'admin') {
            window.adminSendCommand('celebration', {
                type: 'correct',
                emoji: 'üéâ',
                text: `+${points} pontos!`,
                duration: 2000,
                confettiAmount: 40
            });
        }
        
        setTimeout(() => {
            if (quemState.current.round >= quemState.config.rounds) {
                quemEndGame();
            } else {
                quemState.current.round++;
                loadQuemRound();
            }
            // Sincronizar com proje√ß√£o
            window.syncToProjection && window.syncToProjection(100);
        }, 2000);
    } else {
        Utils.showFeedback('wrong', '‚ùå', 'Errou!', 1500);
        
        // Enviar feedback de erro para proje√ß√£o
        if (window.currentMode === 'admin') {
            window.adminSendCommand('showFeedback', { type: 'wrong', emoji: '‚ùå', text: 'Errou!' });
        }
        
        // Avan√ßa para a pr√≥xima equipe na ordem sorteada (revelando a pr√≥xima dica)
        const numDicas = Math.min(7, globalTeams.length, quemState.current.character.hints.length);
        if (quemState.current.turnIndex < numDicas - 1) {
            quemState.current.turnIndex++;
            quemState.current.hintIndex = quemState.current.turnIndex;
        }
        
        setTimeout(() => {
            renderQuemRound();
            // Sincronizar tela com proje√ß√£o
            window.syncToProjection && window.syncToProjection(100);
        }, 1500);
    }
}

function quemPass() {
    // Avan√ßa para a pr√≥xima equipe na ordem sorteada (revelando a pr√≥xima dica)
    const numDicas = Math.min(7, globalTeams.length, quemState.current.character.hints.length);
    if (quemState.current.turnIndex < numDicas - 1) {
        quemState.current.turnIndex++;
        quemState.current.hintIndex = quemState.current.turnIndex;
    }
    
    renderQuemRound();
    
    // Sincronizar com proje√ß√£o
    window.syncToProjection && window.syncToProjection(100);
}

function quemEndGame() {
    const maxScore = Math.max(...quemState.current.scores);
    const winners = globalTeams.filter((t, i) => quemState.current.scores[i] === maxScore);
    const winnerText = winners.length > 1 ? 'Empate!' : winners[0].name;
    
    const ranking = globalTeams.map((t, i) => ({ team: t, score: quemState.current.scores[i] }))
        .sort((a, b) => b.score - a.score);
    
    Utils.createConfetti(100);
    
    document.getElementById('gameContainer').innerHTML = `
        <div class="game-screen active">
            <div class="game-content">
                <div class="end-container">
                    <span class="trophy-icon">üèÜ</span>
                    <h2 class="winner-title">Fim de Jogo!</h2>
                    <p class="winner-name">${winnerText}</p>
                    
                    <div class="final-scores" style="display: flex; flex-wrap: wrap; gap: 15px; justify-content: center;">
                        ${ranking.map((r, i) => `
                            <div class="final-score-item" style="background: ${teamColors[r.team.colorIndex].color}; padding: 15px 20px; border-radius: 15px; min-width: 100px; text-align: center;">
                                <div style="font-size: 1.5rem;">${i === 0 ? 'ü•á' : i === 1 ? 'ü•à' : i === 2 ? 'ü•â' : 'üèÖ'}</div>
                                <div style="font-size: 0.85rem;">${r.team.name}</div>
                                <div style="font-size: 0.7rem; opacity: 0.8;">${r.team.leader || ''}</div>
                                <div style="font-size: 1.5rem; font-weight: bold;">${r.score}</div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div style="display: flex; gap: 20px; justify-content: center;">
                        <button class="btn btn-secondary" onclick="showMenu()">üè† Menu</button>
                        <button class="btn btn-primary" onclick="renderQuemSetup()">üîÑ Jogar Novamente</button>
                    </div>
                </div>
            </div>
        </div>
    `;
}

function confirmQuemExit() {
    if (confirm('Sair do jogo?')) showMenu();
}
// ========== CABINE DO SIM OU N√ÉO ==========

const cabinePrizes = [
    // Pr√™mios bons
    { name: "Caixa de Chocolate", emoji: "üç´", value: 3, type: "good" },
    { name: "B√≠blia de Estudo", emoji: "üìñ", value: 5, type: "great" },
    { name: "Vale-Presente R$50", emoji: "üéÅ", value: 5, type: "great" },
    { name: "Fone Bluetooth", emoji: "üéß", value: 4, type: "good" },
    { name: "Livro Crist√£o", emoji: "üìö", value: 3, type: "good" },
    { name: "Caneca Personalizada", emoji: "‚òï", value: 2, type: "good" },
    { name: "Camiseta IDAC", emoji: "üëï", value: 3, type: "good" },
    { name: "Mochila", emoji: "üéí", value: 4, type: "good" },
    { name: "Caderno Premium", emoji: "üìì", value: 2, type: "good" },
    { name: "Kit Papelaria", emoji: "‚úèÔ∏è", value: 2, type: "good" },
    { name: "Garrafa T√©rmica", emoji: "üß¥", value: 3, type: "good" },
    { name: "Pen Drive 32GB", emoji: "üíæ", value: 3, type: "good" },
    
    // Pr√™mios ruins (armadilhas)
    { name: "Copo Descart√°vel", emoji: "ü•§", value: 0, type: "bad" },
    { name: "Clip de Papel", emoji: "üìé", value: 0, type: "bad" },
    { name: "Borracha Velha", emoji: "üßΩ", value: 0, type: "bad" },
    { name: "Caneta sem Tinta", emoji: "üñäÔ∏è", value: 0, type: "bad" },
    { name: "Folha em Branco", emoji: "üìÑ", value: 0, type: "bad" },
    { name: "Bal√£o Murcho", emoji: "üéà", value: 0, type: "bad" },
    { name: "El√°stico Velho", emoji: "‚≠ï", value: 0, type: "bad" },
    { name: "Palito de Picol√©", emoji: "ü™µ", value: 0, type: "bad" },
    { name: "Sach√™ de Ketchup", emoji: "üçÖ", value: 0, type: "bad" },
    { name: "Guardanapo Usado", emoji: "üßª", value: 0, type: "bad" },
    
    // Mais pr√™mios bons
    { name: "Cesta de Caf√© da Manh√£", emoji: "üß∫", value: 5, type: "great" },
    { name: "Porta-Retrato", emoji: "üñºÔ∏è", value: 2, type: "good" },
    { name: "Almofada Decorativa", emoji: "üõãÔ∏è", value: 2, type: "good" },
    { name: "Kit Churrasco", emoji: "üçñ", value: 4, type: "good" },
    { name: "Jogo de Toalhas", emoji: "üõÅ", value: 3, type: "good" },
    { name: "Caixa de Bombom Fino", emoji: "üéÅ", value: 4, type: "good" },
    { name: "Rel√≥gio de Parede", emoji: "üïê", value: 3, type: "good" },
    { name: "Vale Pizza", emoji: "üçï", value: 3, type: "good" },
    { name: "Lumin√°ria LED", emoji: "üí°", value: 3, type: "good" },
    { name: "Guarda-Chuva Premium", emoji: "‚òÇÔ∏è", value: 2, type: "good" },
    
    // Mais pr√™mios ruins
    { name: "Bot√£o de Camisa", emoji: "üîò", value: 0, type: "bad" },
    { name: "Rolha de Garrafa", emoji: "üçæ", value: 0, type: "bad" },
    { name: "Chiclete Mascado", emoji: "ü´ß", value: 0, type: "bad" },
    { name: "Tampinha de Refrigerante", emoji: "‚≠ï", value: 0, type: "bad" },
    { name: "Fio Dental Usado", emoji: "üßµ", value: 0, type: "bad" }
];

let cabineState = {
    playerName: "Participante",
    currentPrize: null,
    nextPrize: null,
    round: 1,
    totalRounds: 7,
    history: [],
    usedPrizes: []
};

function loadCabineGame() {
    renderCabineSetup();
}

function renderCabineSetup() {
    document.getElementById('gameContainer').innerHTML = `
        <div class="game-screen active">
            <div class="game-content">
                <div class="setup-container" style="max-width: 600px;">
                    <h2 class="setup-title">üöÄ Cabine do Sim ou N√£o</h2>
                    
                    <div style="text-align: center; margin-bottom: 30px;">
                        <div style="font-size: 5rem; margin-bottom: 15px;">üöÄ</div>
                        <p style="color: var(--text-secondary); line-height: 1.7;">
                            O cl√°ssico do Silvio Santos!<br>
                            O participante fica <strong>de costas</strong> para a tela.<br>
                            S√≥ a plateia v√™ o que est√° sendo oferecido!
                        </p>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Nome do Participante</label>
                        <input type="text" class="form-input" id="cabinePlayerName" value="Participante" placeholder="Digite o nome">
                    </div>
                    
                    <div style="background: rgba(255, 107, 53, 0.1); border: 2px solid var(--accent-orange); border-radius: 15px; padding: 20px; margin-bottom: 20px;">
                        <h3 style="color: var(--accent-orange); margin-bottom: 12px;">üìã Como Funciona</h3>
                        <div style="color: var(--text-secondary); line-height: 1.7; font-size: 0.9rem;">
                            <p>1Ô∏è‚É£ Participante come√ßa com um pr√™mio</p>
                            <p>2Ô∏è‚É£ √â oferecida uma TROCA (que ele N√ÉO v√™)</p>
                            <p>3Ô∏è‚É£ Ele diz <strong style="color: var(--accent-green);">SIM</strong> (troca) ou <strong style="color: #ff4757;">N√ÉO</strong> (fica)</p>
                            <p>4Ô∏è‚É£ A plateia reage mas N√ÉO pode falar!</p>
                            <p>5Ô∏è‚É£ S√£o 7 rodadas de emo√ß√£o!</p>
                        </div>
                    </div>
                    
                    <div style="background: rgba(255, 215, 0, 0.15); border: 2px solid var(--accent-gold); border-radius: 15px; padding: 15px; margin-bottom: 25px; text-align: center;">
                        <p style="color: var(--accent-gold); font-weight: 600; font-size: 1rem;">
                            ‚ö†Ô∏è O PARTICIPANTE DEVE FICAR DE COSTAS PARA A TELA!
                        </p>
                    </div>
                    
                    <div style="display: flex; gap: 15px;">
                        <button class="btn btn-secondary" onclick="showMenu()" style="flex: 1;">‚Üê Voltar</button>
                        <button class="btn btn-primary" onclick="startCabineGame()" style="flex: 2;">üöÄ Come√ßar!</button>
                    </div>
                </div>
            </div>
        </div>
    `;
}

function startCabineGame() {
    cabineState = {
        playerName: document.getElementById('cabinePlayerName').value || 'Participante',
        currentPrize: null,
        nextPrize: null,
        round: 1,
        totalRounds: 7,
        history: [],
        usedPrizes: []
    };
    
    // Selecionar pr√™mio inicial (sempre bom)
    const goodPrizes = cabinePrizes.filter(p => p.type === 'good' || p.type === 'great');
    const initialPrize = goodPrizes[Math.floor(Math.random() * goodPrizes.length)];
    cabineState.currentPrize = initialPrize;
    cabineState.usedPrizes.push(initialPrize.name);
    
    renderCabineIntro(); window.syncToProjection && window.syncToProjection(200);
}

function renderCabineIntro() {
    document.getElementById('gameContainer').innerHTML = `
        <div class="game-screen active">
            <div class="game-content">
                <div style="text-align: center; max-width: 700px;">
                    <div style="font-size: 4rem; margin-bottom: 20px;">üéâ</div>
                    <h2 style="font-family: 'Bangers', cursive; font-size: 2.5rem; color: var(--accent-gold); margin-bottom: 20px;">
                        ${cabineState.playerName}, voc√™ come√ßa com:
                    </h2>
                    
                    <div style="background: linear-gradient(135deg, rgba(255,215,0,0.2), rgba(255,107,53,0.2)); border: 4px solid var(--accent-gold); border-radius: 30px; padding: 50px; margin-bottom: 40px;">
                        <div style="font-size: 8rem; margin-bottom: 20px;">${cabineState.currentPrize.emoji}</div>
                        <div style="font-family: 'Righteous', cursive; font-size: 2.5rem; color: var(--accent-gold);">
                            ${cabineState.currentPrize.name}
                        </div>
                    </div>
                    
                    <p style="color: var(--text-secondary); font-size: 1.2rem; margin-bottom: 30px;">
                        Agora vire de costas para a tela!<br>
                        Voc√™ ter√° 7 chances de trocar... ou n√£o!
                    </p>
                    
                    <button class="btn btn-primary" onclick="cabineNextRound()" style="font-size: 1.3rem; padding: 20px 50px;">
                        üöÄ Primeira Troca!
                    </button>
                </div>
            </div>
        </div>
    `;
}

function cabineNextRound() {
    // Selecionar pr√≥ximo pr√™mio aleat√≥rio
    const available = cabinePrizes.filter(p => !cabineState.usedPrizes.includes(p.name));
    const nextPrize = available[Math.floor(Math.random() * available.length)];
    cabineState.nextPrize = nextPrize;
    cabineState.usedPrizes.push(nextPrize.name);
    
    renderCabineRound(); window.syncToProjection && window.syncToProjection(200);
}

function renderCabineRound() {
    const current = cabineState.currentPrize;
    const next = cabineState.nextPrize;
    
    // Determinar se a troca √© boa ou ruim
    const isGoodTrade = next.value > current.value;
    const isBadTrade = next.value < current.value;
    
    let tradeAdvice = '';
    let adviceColor = '';
    
    if (next.value >= 4) {
        tradeAdvice = 'ü§© TROCA EXCELENTE!';
        adviceColor = 'var(--accent-green)';
    } else if (next.value >= 2) {
        tradeAdvice = 'üòä Troca boa';
        adviceColor = 'var(--accent-cyan)';
    } else if (next.value === 0) {
        tradeAdvice = 'üò± ARMADILHA!!!';
        adviceColor = '#ff4757';
    } else {
        tradeAdvice = 'ü§î Troca razo√°vel';
        adviceColor = 'var(--accent-gold)';
    }
    
    document.getElementById('gameContainer').innerHTML = `
        <div class="game-screen active">
            <div class="game-header">
                <button class="btn-back" onclick="confirmCabineExit()">‚Üê Sair</button>
                <div class="game-title-header">üöÄ Cabine do Sim ou N√£o</div>
                <div style="text-align: right;">
                    <div style="color: var(--accent-gold); font-size: 1.2rem; font-weight: 700;">Rodada ${cabineState.round} de ${cabineState.totalRounds}</div>
                    <div style="color: var(--text-secondary); font-size: 0.85rem;">${cabineState.playerName}</div>
                </div>
            </div>
            
            <div class="game-content" style="padding: 20px;">
                <!-- PAINEL ADMIN -->
                <div class="admin-controls admin-only" style="margin-bottom: 15px;">
                    <h4>üë®‚Äçüíº PAINEL DO ADMINISTRADOR</h4>
                    <div class="admin-answer">
                        üì¶ Atual: <strong>${current.name}</strong> (valor ${current.value})<br>
                        üéÅ Oferta: <strong>${next.name}</strong> (valor ${next.value})<br>
                        ${next.value === 0 ? '‚ö†Ô∏è ARMADILHA! N√ÉO DEVE TROCAR!' : next.value > current.value ? '‚úÖ DEVE TROCAR!' : '‚ùå N√ÉO DEVE TROCAR!'}
                    </div>
                </div>
                
                <!-- Aviso para plateia -->
                <div style="background: ${adviceColor}; color: ${next.value === 0 ? 'white' : 'var(--bg-primary)'}; padding: 15px 40px; border-radius: 30px; font-weight: 700; font-size: 1.3rem; margin-bottom: 30px; animation: pulse 1s infinite;">
                    üëÄ PLATEIA: ${tradeAdvice}
                </div>
                
                <style>
                    @keyframes pulse {
                        0%, 100% { transform: scale(1); }
                        50% { transform: scale(1.05); }
                    }
                </style>
                
                <!-- Cards de compara√ß√£o -->
                <div style="display: flex; gap: 40px; align-items: center; justify-content: center; flex-wrap: wrap; margin-bottom: 30px;">
                    
                    <!-- Pr√™mio Atual -->
                    <div style="background: var(--card-bg); border: 3px solid var(--accent-orange); border-radius: 25px; padding: 30px 40px; text-align: center; min-width: 250px;">
                        <div style="color: var(--accent-orange); font-size: 0.9rem; margin-bottom: 10px; font-weight: 600;">
                            üì¶ PR√äMIO ATUAL
                        </div>
                        <div style="font-size: 5rem; margin-bottom: 15px;">${current.emoji}</div>
                        <div style="font-size: 1.3rem; font-weight: 700;">${current.name}</div>
                    </div>
                    
                    <!-- Seta -->
                    <div style="font-size: 3rem; color: var(--text-secondary);">‚áÑ</div>
                    
                    <!-- Pr√™mio Oferecido -->
                    <div style="background: linear-gradient(135deg, rgba(255,215,0,0.1), rgba(255,107,53,0.1)); border: 3px solid var(--accent-gold); border-radius: 25px; padding: 30px 40px; text-align: center; min-width: 250px; animation: glow 2s infinite;">
                        <div style="color: var(--accent-gold); font-size: 0.9rem; margin-bottom: 10px; font-weight: 600;">
                            üéÅ OFERTA DE TROCA
                        </div>
                        <div style="font-size: 5rem; margin-bottom: 15px;">${next.emoji}</div>
                        <div style="font-size: 1.3rem; font-weight: 700;">${next.name}</div>
                        <div style="margin-top: 10px; padding: 5px 15px; background: ${next.type === 'bad' ? '#ff4757' : next.type === 'great' ? 'var(--accent-green)' : 'var(--accent-cyan)'}; border-radius: 20px; font-size: 0.8rem; color: white; display: inline-block;">
                            ${next.type === 'bad' ? 'üíÄ CILADA' : next.type === 'great' ? '‚≠ê √ìTIMO' : 'üëç BOM'}
                        </div>
                    </div>
                </div>
                
                <style>
                    @keyframes glow {
                        0%, 100% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.3); }
                        50% { box-shadow: 0 0 40px rgba(255, 215, 0, 0.6); }
                    }
                </style>
                
                <!-- Pergunta para o participante -->
                <div style="background: var(--card-bg); border: 2px solid var(--card-border); border-radius: 20px; padding: 25px 40px; text-align: center; margin-bottom: 30px;">
                    <div style="font-size: 1.5rem; color: var(--text-secondary); margin-bottom: 10px;">
                        ${cabineState.playerName}, voc√™ quer...
                    </div>
                    <div style="font-family: 'Bangers', cursive; font-size: 2.5rem; letter-spacing: 3px;">
                        TROCAR O SEU PR√äMIO?
                    </div>
                </div>
                
                <!-- Bot√µes de decis√£o -->
                <div style="display: flex; gap: 30px; justify-content: center;">
                    <button class="btn btn-success" onclick="cabineDecision(true)" style="font-size: 1.5rem; padding: 25px 60px; min-width: 200px;">
                        ‚úÖ SIM!
                    </button>
                    <button class="btn btn-danger" onclick="cabineDecision(false)" style="font-size: 1.5rem; padding: 25px 60px; min-width: 200px;">
                        ‚ùå N√ÉO!
                    </button>
                </div>
            </div>
        </div>
    `;
}

function cabineDecision(accepted) {
    const current = cabineState.currentPrize;
    const next = cabineState.nextPrize;
    
    // Registrar no hist√≥rico
    cabineState.history.push({
        round: cabineState.round,
        had: current,
        offered: next,
        accepted: accepted
    });
    
    if (accepted) {
        // Trocou!
        const wasGoodTrade = next.value >= current.value;
        
        if (next.type === 'bad') {
            Utils.showFeedback('wrong', 'üò±', 'CILADA!', 2500);
        } else if (next.value > current.value) {
            Utils.showFeedback('correct', 'üéâ', 'BOA TROCA!', 2000);
            Utils.createConfetti(30);
        } else {
            Utils.showFeedback('wrong', 'üòÖ', 'Trocou...', 1500);
        }
        
        cabineState.currentPrize = next;
    } else {
        // Ficou com o atual
        if (next.type === 'bad') {
            Utils.showFeedback('correct', 'üòÆ‚Äçüí®', 'ESCAPOU!', 2000);
            Utils.createConfetti(20);
        } else if (next.value > current.value) {
            Utils.showFeedback('wrong', 'üò¢', 'Perdeu chance...', 2000);
        } else {
            Utils.showFeedback('correct', 'üëç', 'Boa escolha!', 1500);
        }
    }
    
    // Sincronizar feedback com proje√ß√£o
    window.syncToProjection && window.syncToProjection(500);
    
    setTimeout(() => {
        if (cabineState.round >= cabineState.totalRounds) {
            cabineEndGame();
        } else {
            cabineState.round++;
            cabineNextRound();
        }
    }, 2500);
}

function cabineEndGame() {
    const finalPrize = cabineState.currentPrize;
    
    Utils.createConfetti(100);
    
    document.getElementById('gameContainer').innerHTML = `
        <div class="game-screen active">
            <div class="game-content">
                <div style="text-align: center; max-width: 800px;">
                    <div style="font-size: 4rem; margin-bottom: 15px;">üéä</div>
                    <h2 style="font-family: 'Bangers', cursive; font-size: 3rem; color: var(--accent-gold); margin-bottom: 30px;">
                        FIM DE JOGO!
                    </h2>
                    
                    <p style="font-size: 1.3rem; color: var(--text-secondary); margin-bottom: 20px;">
                        ${cabineState.playerName}, voc√™ terminou com:
                    </p>
                    
                    <div style="background: linear-gradient(135deg, rgba(255,215,0,0.2), rgba(255,107,53,0.2)); border: 4px solid ${finalPrize.type === 'bad' ? '#ff4757' : 'var(--accent-gold)'}; border-radius: 30px; padding: 40px; margin-bottom: 30px;">
                        <div style="font-size: 7rem; margin-bottom: 15px;">${finalPrize.emoji}</div>
                        <div style="font-family: 'Righteous', cursive; font-size: 2.5rem; color: ${finalPrize.type === 'bad' ? '#ff4757' : 'var(--accent-gold)'};">
                            ${finalPrize.name}
                        </div>
                        ${finalPrize.type === 'bad' ? '<div style="color: #ff4757; margin-top: 10px; font-size: 1.2rem;">üòÖ Ops... pelo menos foi divertido!</div>' : ''}
                    </div>
                    
                    <!-- Hist√≥rico -->
                    <div style="background: var(--card-bg); border-radius: 20px; padding: 25px; margin-bottom: 30px; text-align: left;">
                        <h3 style="color: var(--text-secondary); margin-bottom: 15px; text-align: center;">üìú Hist√≥rico de Trocas</h3>
                        <div style="display: grid; gap: 10px;">
                            ${cabineState.history.map((h, i) => `
                                <div style="display: flex; align-items: center; gap: 15px; padding: 10px 15px; background: rgba(255,255,255,0.03); border-radius: 10px;">
                                    <span style="color: var(--text-secondary);">${i + 1}.</span>
                                    <span>${h.had.emoji} ${h.had.name}</span>
                                    <span style="color: var(--text-secondary);">‚Üí</span>
                                    <span>${h.offered.emoji} ${h.offered.name}</span>
                                    <span style="margin-left: auto; padding: 3px 12px; border-radius: 15px; font-size: 0.85rem; background: ${h.accepted ? 'var(--accent-green)' : 'rgba(255,255,255,0.1)'}; color: ${h.accepted ? 'var(--bg-primary)' : 'var(--text-secondary)'};">
                                        ${h.accepted ? 'TROCOU' : 'FICOU'}
                                    </span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 20px; justify-content: center;">
                        <button class="btn btn-secondary" onclick="showMenu()">üè† Menu</button>
                        <button class="btn btn-primary" onclick="renderCabineSetup()">üîÑ Jogar Novamente</button>
                    </div>
                </div>
            </div>
        </div>
    `;
    
    window.syncToProjection && window.syncToProjection(200);
}

function confirmCabineExit() {
    if (confirm('Sair do jogo? O progresso ser√° perdido.')) {
        showMenu();
    }
}
</script>

</body>
</html>
